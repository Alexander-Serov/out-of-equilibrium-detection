(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    169125,       4569]
NotebookOptionsPosition[    157296,       4279]
NotebookOutlinePosition[    157639,       4294]
CellTagsIndexPosition[    157596,       4291]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7628601971068325`*^9, 
  3.76286021312483*^9}},ExpressionUUID->"9d4c7671-fbf8-45f2-a81d-\
a207f9da4bd0"],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculating displacements correlation for 2 connected particles in 2D (1D \
x-link). \[Omega]0=k/\[Gamma]; d=D2/D1; \[Kappa] = k * ",
 Cell[BoxData[
  FormBox[
   SqrtBox["D1"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "56a84ded-eb04-4f6d-994a-31f948b90a58"],
 ", for all indices"
}], "Subsection",
 CellChangeTimes->{{3.7628567090968914`*^9, 3.7628567295601835`*^9}, {
   3.766724461419839*^9, 3.766724472787854*^9}, {3.7667469300109615`*^9, 
   3.766746938675033*^9}, 3.7668116316801615`*^9, {3.766811695096054*^9, 
   3.766811717231459*^9}, {3.7668119964972715`*^9, 3.766812003857062*^9}, {
   3.780139611576239*^9, 3.780139678648878*^9}, {3.780139730304256*^9, 
   3.780139744456195*^9}, {3.780140490988518*^9, 
   3.7801404910784445`*^9}},ExpressionUUID->"c403f3ef-7faf-44f6-a097-\
94106449419a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"\[Gamma]", " ", 
      SqrtBox["D1"]}]], 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         RowBox[{"-", "\[Kappa]1"}], "-", "\[Kappa]12"}], "0", "\[Kappa]12", 
        "0"},
       {"0", 
        RowBox[{"-", "\[Kappa]1"}], "0", "0"},
       {"\[Kappa]12", "0", 
        RowBox[{
         RowBox[{"-", "\[Kappa]2"}], "-", "\[Kappa]12"}], "0"},
       {"0", "0", "0", 
        RowBox[{"-", "\[Kappa]2"}]}
      }], "\[NoBreak]", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigsys", "=", 
   RowBox[{"Eigensystem", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Um1", "=", " ", 
   RowBox[{"eigsys", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]s", "=", 
   RowBox[{"eigsys", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gRule", "=", 
   RowBox[{"g", "\[Rule]", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["\[Kappa]1", "2"], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["\[Kappa]12", "2"]}], "-", 
      RowBox[{"2", " ", "\[Kappa]1", " ", "\[Kappa]2"}], "+", 
      SuperscriptBox["\[Kappa]2", "2"]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Um1", "=", 
   RowBox[{"Um1", "/.", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"g", "/.", "gRule"}], ")"}], "\[Rule]", "g"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Lambda]s", "=", 
    RowBox[{"\[Lambda]s", "/.", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"g", "/.", "gRule"}], ")"}], "\[Rule]", "g"}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<U: \>\"", ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"U", "=", 
       RowBox[{"Inverse", "[", "Um1", "]"}]}], ")"}], "//", "MatrixForm"}]}], 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Lambda]", "=", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"k12", "/", "\[Gamma]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "1", "]"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       SqrtBox[
        RowBox[{"2", " ", "D1"}]], ",", "0", ",", "0", ",", "0"}], "}"}], 
     "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "2", "]"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       SqrtBox[
        RowBox[{"2", "D1"}]], ",", "0", ",", "0"}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "3", "]"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", 
       SqrtBox[
        RowBox[{"2", "D1", " ", "d"}]], ",", "0"}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "4", "]"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", "0", ",", 
       SqrtBox[
        RowBox[{"2", "D1", " ", "d"}]]}], "}"}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"R0", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{"R01", ",", "R02", ",", "R03", ",", "R04"}], "}"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", 
   RowBox[{
    FractionBox["L", 
     RowBox[{"\[Gamma]", " ", 
      SqrtBox["D1"]}]], " ", 
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{"-", "\[Kappa]12"}]},
       {"0"},
       {
        RowBox[{"\[Kappa]2", "+", "\[Kappa]12"}]},
       {"0"}
      }], "\[NoBreak]", ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Um1: \>\"", ",", " ", 
   RowBox[{"Um1", "//", "MatrixForm"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<\[Lambda]s: \>\"", ",", " ", "\[Lambda]s"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Check eigenvectors:\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"U", ".", 
        RowBox[{"DiagonalMatrix", "[", "\[Lambda]s", "]"}], ".", "Um1"}], "-",
        "A"}], "]"}], "/.", "gRule"}], "//", "MatrixForm"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]sDummy", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Lambda]", "[", "i", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7628567333180375`*^9, 3.762856753393573*^9}, {
   3.7628573305712233`*^9, 3.762857332480133*^9}, {3.7628574892796087`*^9, 
   3.762857533113578*^9}, {3.76285760216117*^9, 3.7628576260525303`*^9}, {
   3.763109736673839*^9, 3.7631097397211*^9}, {3.763109842625331*^9, 
   3.7631098902740974`*^9}, 3.763110672126331*^9, {3.7631183173715806`*^9, 
   3.763118323594894*^9}, {3.763192458782632*^9, 3.763192459359381*^9}, {
   3.763212962853982*^9, 3.7632129705137324`*^9}, {3.7633797663811674`*^9, 
   3.7633799178543334`*^9}, {3.7633799530796328`*^9, 3.763380028814479*^9}, {
   3.76338014398129*^9, 3.7633801495571985`*^9}, {3.7633802606613197`*^9, 
   3.763380261020094*^9}, {3.7633805848403053`*^9, 3.763380596919236*^9}, {
   3.763380630254444*^9, 3.7633806654848385`*^9}, 3.763738819594329*^9, {
   3.7637388725549*^9, 3.7637388960987673`*^9}, {3.763877655969294*^9, 
   3.7638776587637186`*^9}, {3.7645674986796007`*^9, 3.764567499256271*^9}, {
   3.764567575108885*^9, 3.7645676134979267`*^9}, {3.764581178847369*^9, 
   3.764581235916727*^9}, {3.766812015697321*^9, 3.7668120267920055`*^9}, {
   3.7668981362274256`*^9, 3.766898220955192*^9}, {3.766914021536811*^9, 
   3.7669141107367277`*^9}, {3.766914145674165*^9, 3.7669141583209653`*^9}, {
   3.7669141937939157`*^9, 3.7669142576181774`*^9}, {3.7669170487464285`*^9, 
   3.7669171206126146`*^9}, 3.7675113796286955`*^9, {3.7675114883970537`*^9, 
   3.767511495084793*^9}, {3.7675115728446846`*^9, 3.76751157354033*^9}, {
   3.767511705765217*^9, 3.767511721044311*^9}, {3.767512027005616*^9, 
   3.7675120355653834`*^9}, {3.7675214676880417`*^9, 3.767521470113754*^9}, {
   3.7801398839446774`*^9, 3.780139950400256*^9}, {3.780140479348188*^9, 
   3.7801405058639946`*^9}, {3.7815261881592665`*^9, 3.781526191552354*^9}, {
   3.781595959675477*^9, 
   3.781595963825452*^9}},ExpressionUUID->"692003ab-25d5-464e-ba05-\
1169df22d6e4"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"U: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", 
        RowBox[{"-", 
         FractionBox["\[Kappa]12", "g"]}], 
        FractionBox["\[Kappa]12", "g"]},
       {"1", "0", "0", "0"},
       {"0", "0", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
          RowBox[{"2", " ", "g"}]]}], 
        FractionBox[
         RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
         RowBox[{"2", " ", "g"}]]},
       {"0", "1", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["U: ", 
   MatrixForm[{{
     0, 0, -$CellContext`g^(-1) $CellContext`\[Kappa]12, $CellContext`g^(-1) \
$CellContext`\[Kappa]12}, {1, 0, 0, 0}, {
     0, 0, Rational[-1, 
        2] $CellContext`g^(-1) (-$CellContext`g + $CellContext`\[Kappa]1 - \
$CellContext`\[Kappa]2), 
      Rational[1, 
        2] $CellContext`g^(-1) ($CellContext`g + $CellContext`\[Kappa]1 - \
$CellContext`\[Kappa]2)}, {0, 1, 0, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7669142434961967`*^9, 3.7669142580649033`*^9}, {
   3.766917095772685*^9, 3.76691712140816*^9}, 3.7674333074631824`*^9, 
   3.7675113801897345`*^9, 3.7675114967816973`*^9, 3.767511574239765*^9, {
   3.767511715749448*^9, 3.7675117216033516`*^9}, 3.767512036069226*^9, 
   3.76752147048584*^9, 3.7679425075125246`*^9, 3.767942730598786*^9, 
   3.7679432146407375`*^9, 3.7794535263290167`*^9, {3.7801399542590113`*^9, 
   3.7801399574291945`*^9}, 3.7801405079417806`*^9, 3.7801405408457594`*^9, 
   3.781526193409273*^9, 
   3.7815959647871237`*^9},ExpressionUUID->"11c0e79f-fcdd-4b4e-943d-\
26370c219677"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Um1: \"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "1", "0", "0"},
       {"0", "0", "0", "1"},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
          RowBox[{"2", " ", "\[Kappa]12"}]]}], "0", "1", "0"},
       {
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
          RowBox[{"2", " ", "\[Kappa]12"}]]}], "0", "1", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Um1: ", 
   MatrixForm[{{0, 1, 0, 0}, {0, 0, 0, 1}, {
     Rational[-1, 
        2] $CellContext`\[Kappa]12^(-1) ($CellContext`g + $CellContext`\
\[Kappa]1 - $CellContext`\[Kappa]2), 0, 1, 0}, {
     Rational[-1, 
        2] $CellContext`\[Kappa]12^(-1) (-$CellContext`g + $CellContext`\
\[Kappa]1 - $CellContext`\[Kappa]2), 0, 1, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7669142434961967`*^9, 3.7669142580649033`*^9}, {
   3.766917095772685*^9, 3.76691712140816*^9}, 3.7674333074631824`*^9, 
   3.7675113801897345`*^9, 3.7675114967816973`*^9, 3.767511574239765*^9, {
   3.767511715749448*^9, 3.7675117216033516`*^9}, 3.767512036069226*^9, 
   3.76752147048584*^9, 3.7679425075125246`*^9, 3.767942730598786*^9, 
   3.7679432146407375`*^9, 3.7794535263290167`*^9, {3.7801399542590113`*^9, 
   3.7801399574291945`*^9}, 3.7801405079417806`*^9, 3.7801405408457594`*^9, 
   3.781526193409273*^9, 
   3.7815959647941203`*^9},ExpressionUUID->"58e51300-85fa-410a-b0ac-\
6b41ea24b73d"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[Lambda]s: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[Kappa]1", 
       RowBox[{
        SqrtBox["D1"], " ", "\[Gamma]"}]]}], ",", 
     RowBox[{"-", 
      FractionBox["\[Kappa]2", 
       RowBox[{
        SqrtBox["D1"], " ", "\[Gamma]"}]]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "g"}], "-", "\[Kappa]1", "-", 
       RowBox[{"2", " ", "\[Kappa]12"}], "-", "\[Kappa]2"}], 
      RowBox[{"2", " ", 
       SqrtBox["D1"], " ", "\[Gamma]"}]], ",", 
     FractionBox[
      RowBox[{"g", "-", "\[Kappa]1", "-", 
       RowBox[{"2", " ", "\[Kappa]12"}], "-", "\[Kappa]2"}], 
      RowBox[{"2", " ", 
       SqrtBox["D1"], " ", "\[Gamma]"}]]}], "}"}]}],
  SequenceForm[
  "\[Lambda]s: ", {-$CellContext`D1^
     Rational[-1, 
       2] $CellContext`\[Gamma]^(-1) $CellContext`\[Kappa]1, -$CellContext`D1^
     Rational[-1, 2] $CellContext`\[Gamma]^(-1) $CellContext`\[Kappa]2, 
    Rational[1, 2] $CellContext`D1^
     Rational[-1, 
       2] $CellContext`\[Gamma]^(-1) (-$CellContext`g - \
$CellContext`\[Kappa]1 - 2 $CellContext`\[Kappa]12 - $CellContext`\[Kappa]2), 
    Rational[1, 2] $CellContext`D1^
     Rational[-1, 
       2] $CellContext`\[Gamma]^(-1) ($CellContext`g - $CellContext`\[Kappa]1 - 
     2 $CellContext`\[Kappa]12 - $CellContext`\[Kappa]2)}],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7669142434961967`*^9, 3.7669142580649033`*^9}, {
   3.766917095772685*^9, 3.76691712140816*^9}, 3.7674333074631824`*^9, 
   3.7675113801897345`*^9, 3.7675114967816973`*^9, 3.767511574239765*^9, {
   3.767511715749448*^9, 3.7675117216033516`*^9}, 3.767512036069226*^9, 
   3.76752147048584*^9, 3.7679425075125246`*^9, 3.767942730598786*^9, 
   3.7679432146407375`*^9, 3.7794535263290167`*^9, {3.7801399542590113`*^9, 
   3.7801399574291945`*^9}, 3.7801405079417806`*^9, 3.7801405408457594`*^9, 
   3.781526193409273*^9, 
   3.7815959648001175`*^9},ExpressionUUID->"42881934-683d-4c7b-9b03-\
f9d5c19d4ee3"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Check eigenvectors:\"\>", "\[InvisibleSpace]", 
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"},
       {"0", "0", "0", "0"}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]]}],
  SequenceForm["Check eigenvectors:", 
   MatrixForm[{{0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}, {0, 0, 0, 0}}]],
  Editable->False]], "Print",
 CellChangeTimes->{{3.7669142434961967`*^9, 3.7669142580649033`*^9}, {
   3.766917095772685*^9, 3.76691712140816*^9}, 3.7674333074631824`*^9, 
   3.7675113801897345`*^9, 3.7675114967816973`*^9, 3.767511574239765*^9, {
   3.767511715749448*^9, 3.7675117216033516`*^9}, 3.767512036069226*^9, 
   3.76752147048584*^9, 3.7679425075125246`*^9, 3.767942730598786*^9, 
   3.7679432146407375`*^9, 3.7794535263290167`*^9, {3.7801399542590113`*^9, 
   3.7801399574291945`*^9}, 3.7801405079417806`*^9, 3.7801405408457594`*^9, 
   3.781526193409273*^9, 
   3.781595964806114*^9},ExpressionUUID->"a4c43000-f176-4899-8fcf-\
c1c8333d162e"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Eigensystem", "[", 
    RowBox[{
     FractionBox["1", "\[Gamma]"], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"-", "k1"}], "-", "k12"}], "0", "k12", "0"},
        {"0", 
         RowBox[{"-", "k1"}], "0", "0"},
        {"k12", "0", 
         RowBox[{
          RowBox[{"-", "k2"}], "-", "k12"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "k2"}]}
       }], "\[NoBreak]", ")"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{
     FractionBox["1", "\[Gamma]"], 
     RowBox[{"(", "\[NoBreak]", GridBox[{
        {
         RowBox[{
          RowBox[{"-", "k1"}], "-", "k12"}], "0", "k12", "0"},
        {"0", 
         RowBox[{"-", "k1"}], "0", "0"},
        {"k12", "0", 
         RowBox[{
          RowBox[{"-", "k1"}], "-", "k12"}], "0"},
        {"0", "0", "0", 
         RowBox[{"-", "k1"}]}
       }], "\[NoBreak]", ")"}]}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7680184306290655`*^9, 3.7680184614927683`*^9}, 
   3.7801399840129824`*^9},ExpressionUUID->"71c718ee-96ef-494c-91ac-\
44f102c1bc70"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Stochastic part of the displacement\n", "Section"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"\[Lambda]", ",", " ", "n"}], "]"}], " ", "=", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", 
      SubscriptBox["t", "n"]], 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[Lambda]", "(", 
        RowBox[{
         SubscriptBox["t", "n"], "-", "s"}], ")"}]], 
      RowBox[{"\[DifferentialD]", "W"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"788053bd-9a37-40b4-ab22-984155fd8976"]
}], "Subsection",
 CellChangeTimes->{{3.766724554532338*^9, 3.766724560756578*^9}, {
  3.7667247465806713`*^9, 3.7667248062629504`*^9}, {3.7667250187732353`*^9, 
  3.7667250876556892`*^9}, {3.7667268811806316`*^9, 
  3.766726887028598*^9}},ExpressionUUID->"f4c8ed79-9269-4e49-a95c-\
28878b3d54c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"p", "[", "i", "]"}], " ", 
      RowBox[{"U", ".", 
       RowBox[{"DiagonalMatrix", "[", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"#", ",", "n"}], "]"}], "&"}], ",", "\[Lambda]sDummy"}], 
         "]"}], "]"}], ".", "Um1", ".", 
       RowBox[{"b", "[", "i", "]"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Xi]n", "=", 
   RowBox[{"RnStochastic", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"f1", "/.", 
       RowBox[{"n", "\[Rule]", 
        RowBox[{"n", "+", "1"}]}]}], ")"}], "-", "f1"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.766724617780674*^9, 3.766724622293003*^9}, {
  3.766724660324767*^9, 3.766724665062072*^9}, {3.766724738382683*^9, 
  3.766724738621138*^9}, {3.7667248290466657`*^9, 3.7667248769322443`*^9}, {
  3.766725486728136*^9, 3.7667255056406946`*^9}, {3.766726891669112*^9, 
  3.7667268918600016`*^9}, {3.7668982975236025`*^9, 3.766898298251192*^9}, {
  3.7669171260265317`*^9, 
  3.7669171267861*^9}},ExpressionUUID->"5d46c902-7327-4d1e-b2b3-ed2651c9438f"],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Construct the power spectrum. Decorrelate different \
stochastic noise processes", "Subsection"]], "Subsubsection",
 CellChangeTimes->{{3.7667249079179583`*^9, 3.7667249556295815`*^9}, {
  3.766725012045622*^9, 3.7667250157815523`*^9}, {3.7667251060936165`*^9, 
  3.7667251160940876`*^9}},ExpressionUUID->"084cdd47-c409-4839-bbb5-\
abd2cb1df41b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pRule", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"p", "[", "_", "]"}], "2"], ":>", "1"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"p", "[", "i_", "]"}], " ", 
        RowBox[{"p", "[", "j_", "]"}]}], " ", "/;", 
       RowBox[{"i", "\[NotEqual]", "j"}]}], ":>", " ", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RnStochasticImSquared", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Expand", "[", 
      RowBox[{"RnStochastic", "*", 
       RowBox[{"(", 
        RowBox[{"RnStochastic", "/.", 
         RowBox[{"\[ImaginaryI]", "\[Rule]", 
          RowBox[{"-", "\[ImaginaryI]"}]}]}], ")"}]}], "]"}], "/.", "pRule"}],
     "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7667249802814116`*^9, 3.766724992998207*^9}, {
   3.7667251006398373`*^9, 3.7667251024222937`*^9}, {3.7667251378467035`*^9, 
   3.7667251416451797`*^9}, 
   3.766725179998849*^9},ExpressionUUID->"2c3b6f4c-0123-4b87-bbe1-\
adb5cb1e7039"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Calculate the variances of the individual ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Chi]", "2"], TraditionalForm]],ExpressionUUID->
  "ebef49b6-ff6b-48be-88ce-cc8fc70656a6"],
 " for the Real component"
}], "Subsection",
 CellChangeTimes->{{3.7667294663948145`*^9, 
  3.7667294980669966`*^9}},ExpressionUUID->"3378f1e5-df0d-4487-b1d0-\
556b0fc821c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"U", ".", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"J", "[", "#", "]"}], "&"}], ",", "\[Lambda]sDummy"}], "]"}], 
    "]"}], ".", "Um1"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.766913783185032*^9, 3.7669137857495937`*^9}, {
  3.7669171327217703`*^9, 
  3.7669171337112064`*^9}},ExpressionUUID->"677a5d97-06b8-47b9-b8da-\
594df8343036"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Kappa]12", " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "g"]}], "+", 
       FractionBox[
        RowBox[{"\[Kappa]12", " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "g"]}], "0"},
     {"0", 
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], "0", "0"},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
        RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]]}], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
          " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
         RowBox[{"2", " ", "g"}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]]}], "0"},
     {"0", "0", "0", 
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766913780855379*^9, 3.7669137861363783`*^9}, 
   3.7669142674466314`*^9, 3.766917134121975*^9, 3.767433314446047*^9, 
   3.7679425137496233`*^9, 3.767942731098837*^9, 3.767943215133322*^9, 
   3.7794535267507973`*^9, 3.780140083146158*^9, {3.780140526151636*^9, 
   3.7801405410696325`*^9}},ExpressionUUID->"fdc045b9-8964-4494-8b59-\
f2d23ed40b12"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"iRule", "=", 
   RowBox[{"i", "\[Rule]", "3"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"term", "=", 
  RowBox[{"U", ".", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"J", "[", "#", "]"}], "&"}], ",", "\[Lambda]sDummy"}], "]"}], 
    "]"}], ".", "Um1", ".", 
   RowBox[{"b", "[", "i", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"term", "/.", "iRule"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.766729134186599*^9, 3.76672913834422*^9}, {
   3.7667291712113595`*^9, 3.7667291726828203`*^9}, {3.7667292470451436`*^9, 
   3.766729261826384*^9}, {3.7667295148127785`*^9, 3.7667295334185467`*^9}, {
   3.766734027576661*^9, 3.7667340606659203`*^9}, {3.7667341163463435`*^9, 
   3.7667341328094435`*^9}, {3.766734166202544*^9, 3.766734184153778*^9}, {
   3.766734218578638*^9, 3.766734225235877*^9}, {3.7667358096065693`*^9, 
   3.7667358100380087`*^9}, {3.7667358911999073`*^9, 3.766735909240088*^9}, {
   3.766736332480465*^9, 3.7667363761528425`*^9}, {3.7667461840923*^9, 
   3.7667461993375397`*^9}, {3.7667462495655737`*^9, 3.766746250097025*^9}, {
   3.7668995452079268`*^9, 3.766899553078447*^9}, 3.766913684336325*^9, 
   3.766913721024439*^9, {3.7674385666620493`*^9, 
   3.7674385773651323`*^9}},ExpressionUUID->"2b6e7235-81f0-4618-8c0f-\
cbe6f4a104a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"\[Kappa]12", " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "g"]}], "+", 
       FractionBox[
        RowBox[{"\[Kappa]12", " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "g"]}], ",", "0"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], ",", "0", ",", "0"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
        RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
         " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]]}], ",", "0", ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], 
          " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
         RowBox[{"2", " ", "g"}]]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        RowBox[{"2", " ", "g"}]]}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", 
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}]}], "}"}]}], "}"}], ".", 
  RowBox[{"b", "[", "i", "]"}]}]], "Output",
 CellChangeTimes->{{3.766729131757581*^9, 3.7667291388375406`*^9}, 
   3.76672917329747*^9, {3.766729247608843*^9, 3.7667292621911783`*^9}, {
   3.7667295276456923`*^9, 3.7667295339648266`*^9}, {3.7667340368746004`*^9, 
   3.7667340611966677`*^9}, 3.7667341335520244`*^9, {3.766734166823168*^9, 
   3.7667341845205727`*^9}, 3.766734227474306*^9, 3.7667358117157526`*^9, {
   3.7667359004752913`*^9, 3.7667359102343254`*^9}, {3.766736333356641*^9, 
   3.7667363771232953`*^9}, 3.7667462000621047`*^9, 3.766898304943432*^9, 
   3.7669131442357283`*^9, 3.766913197327551*^9, 3.766913685161834*^9, 
   3.766913721495171*^9, 3.766914275737889*^9, 3.7674333171446767`*^9, {
   3.767438567082918*^9, 3.7674385781387196`*^9}, 3.7679425148507376`*^9, 
   3.7679427311352673`*^9, 3.767943215164264*^9, 3.779453526776804*^9, 
   3.780140099750641*^9, {3.7801405277976723`*^9, 
   3.7801405411165824`*^9}},ExpressionUUID->"105333ff-b11f-46bd-a708-\
38b784dd6dbb"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"d", " ", "D1"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Kappa]12", " ", 
            RowBox[{"J", "[", 
             RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "g"]}], "+", 
         FractionBox[
          RowBox[{"\[Kappa]12", " ", 
           RowBox[{"J", "[", 
            RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "g"]}], ")"}]}]},
     {"0"},
     {
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox[
        RowBox[{"d", " ", "D1"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}],
             " ", 
            RowBox[{"J", "[", 
             RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
           RowBox[{"2", " ", "g"}]]}], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
           RowBox[{"J", "[", 
            RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
          RowBox[{"2", " ", "g"}]]}], ")"}]}]},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.766729131757581*^9, 3.7667291388375406`*^9}, 
   3.76672917329747*^9, {3.766729247608843*^9, 3.7667292621911783`*^9}, {
   3.7667295276456923`*^9, 3.7667295339648266`*^9}, {3.7667340368746004`*^9, 
   3.7667340611966677`*^9}, 3.7667341335520244`*^9, {3.766734166823168*^9, 
   3.7667341845205727`*^9}, 3.766734227474306*^9, 3.7667358117157526`*^9, {
   3.7667359004752913`*^9, 3.7667359102343254`*^9}, {3.766736333356641*^9, 
   3.7667363771232953`*^9}, 3.7667462000621047`*^9, 3.766898304943432*^9, 
   3.7669131442357283`*^9, 3.766913197327551*^9, 3.766913685161834*^9, 
   3.766913721495171*^9, 3.766914275737889*^9, 3.7674333171446767`*^9, {
   3.767438567082918*^9, 3.7674385781387196`*^9}, 3.7679425148507376`*^9, 
   3.7679427311352673`*^9, 3.767943215164264*^9, 3.779453526776804*^9, 
   3.780140099750641*^9, {3.7801405277976723`*^9, 
   3.780140541123579*^9}},ExpressionUUID->"170e65e4-4402-4387-93c1-\
f39e40f576fb"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Substitute the integrals product with Fourier images \[LineSeparator]results. \
Only use the ~M terms. For k!=0. My calculations show that the variance of \
the real part is the same as that of the imaginary part, and they are not \
correlated\
\>", "Subsection",
 CellChangeTimes->{{3.7667341947127156`*^9, 3.7667342467761097`*^9}, {
   3.7667349359626617`*^9, 3.7667349431703773`*^9}, {3.7667351119149604`*^9, 
   3.7667351199233327`*^9}, {3.7667360281262064`*^9, 3.7667360687737474`*^9}, 
   3.766736335439652*^9},ExpressionUUID->"43697787-028c-4222-bb5c-\
50c288ed15f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"JReImage", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"J", "[", "\[Lambda]1_", "]"}], "2"], "/;", 
      RowBox[{"\[Lambda]1", "===", "0"}]}], "\[RuleDelayed]", 
     RowBox[{"M", " ", 
      RowBox[{
       SuperscriptBox["dt", "3"], "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"J", "[", "\[Lambda]1_", "]"}], "2"], "/;", 
      RowBox[{"\[Lambda]1", "=!=", "0"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", " ", 
            SuperscriptBox["dt", "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], " ", "\[Lambda]1"}], ")"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["c1", "2"]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", "\[Pi]", " ", 
                RowBox[{"k", "/", "M"}]}], "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["c1", "2"], "-", 
            RowBox[{"2", "c1", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", "\[Pi]", " ", 
               RowBox[{"k", " ", "/", "M"}]}], "]"}]}]}], ")"}]}], ")"}]}], "/.", 
       RowBox[{"c1", "->", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], ")"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"J", "[", "\[Lambda]1_", "]"}], 
       RowBox[{"J", "[", "\[Lambda]2_", "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "=!=", "\[Lambda]2"}], ")"}]}], "\[RuleDelayed]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"M", " ", 
            SuperscriptBox["dt", "2"]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}], ")"}]}], 
         ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"c1", " ", "c2"}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"c1", " ", "c2"}], " ", "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"c1", "+", "c2"}], ")"}], 
               RowBox[{"Cos", "[", 
                RowBox[{"2", "\[Pi]", " ", 
                 RowBox[{"k", "/", "M"}]}], "]"}]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"Cos", "[", 
               RowBox[{"2", " ", "\[Pi]", " ", 
                RowBox[{"k", "/", "M"}]}], "]"}]}], ")"}]}], ")"}], "/", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["c1", "2"], "-", 
              RowBox[{"2", "c1", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Pi]", " ", 
                 RowBox[{"k", " ", "/", "M"}]}], "]"}]}]}], ")"}], 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["c2", "2"], "-", 
              RowBox[{"2", "c2", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{"2", " ", "\[Pi]", " ", 
                 RowBox[{"k", " ", "/", "M"}]}], "]"}]}]}], ")"}]}], ")"}]}], 
         ")"}]}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c1", "->", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}], ",", 
         RowBox[{"c2", "->", 
          RowBox[{"Exp", "[", 
           RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "}"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termSquared", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"term", "/.", "iRule"}], ")"}], "2"], "//", "MatrixForm"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"termSquared", "/.", "JReImage"}], "//", "FullSimplify"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.766734966020769*^9, 3.7667350114199643`*^9}, {
   3.7667351251648083`*^9, 3.7667351562443895`*^9}, {3.7667352777156577`*^9, 
   3.7667353831718264`*^9}, {3.7667354168447065`*^9, 
   3.7667354667974052`*^9}, {3.766735513669638*^9, 3.7667355415172024`*^9}, {
   3.766735615045232*^9, 3.766735689222189*^9}, {3.7667357228065453`*^9, 
   3.766735827437287*^9}, {3.766735915424021*^9, 3.7667359608700323`*^9}, 
   3.766740544933235*^9, {3.766746252754484*^9, 3.7667462661304827`*^9}, 
   3.7667488564582515`*^9, {3.7667490165701036`*^9, 3.7667490193867617`*^9}, {
   3.7668995563046103`*^9, 3.766899556479511*^9}, 3.7669131846557674`*^9, {
   3.7669142928495984`*^9, 3.7669142942517786`*^9}, 3.7669143312117615`*^9, {
   3.7674348112321215`*^9, 3.7674348153346343`*^9}, {3.767943015724001*^9, 
   3.767943025370519*^9}, {3.767943159651655*^9, 3.7679431639868007`*^9}, {
   3.767943207875156*^9, 
   3.7679432086827946`*^9}},ExpressionUUID->"f4e69a56-a35e-4e84-b1b8-\
7814a6d096db"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"J", "[", "\[Lambda]1_", "]"}], "2"], "/;", 
     RowBox[{"\[Lambda]1", "===", "0"}]}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{"M", " ", 
      SuperscriptBox["dt", "3"]}], "2"]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"J", "[", "\[Lambda]1_", "]"}], "2"], "/;", 
     RowBox[{"\[Lambda]1", "=!=", "0"}]}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", " ", 
           SuperscriptBox["dt", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["c1", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}], ")"}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", " ", "\[Lambda]1"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["c1", "2"], "-", 
           RowBox[{"2", " ", "c1", " ", 
            RowBox[{"Cos", "[", 
             FractionBox[
              RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}]}], 
          ")"}]}]]}], "/.", "\[VeryThinSpace]", 
      RowBox[{"c1", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"J", "[", "\[Lambda]1_", "]"}], " ", 
      RowBox[{"J", "[", "\[Lambda]2_", "]"}]}], "/;", 
     RowBox[{"\[Lambda]1", "=!=", "\[Lambda]2"}]}], "\[RuleDelayed]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"M", " ", 
           SuperscriptBox["dt", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"c1", " ", "c2"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"c1", " ", "c2"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"c1", "+", "c2"}], ")"}], " ", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}]}], ")"}],
            " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"Cos", "[", 
              FractionBox[
               RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}], ")"}]}], 
          ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["c1", "2"], "-", 
             RowBox[{"2", " ", "c1", " ", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}]}], ")"}],
            " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox["c2", "2"], "-", 
             RowBox[{"2", " ", "c2", " ", 
              RowBox[{"Cos", "[", 
               FractionBox[
                RowBox[{"2", " ", "\[Pi]", " ", "k"}], "M"], "]"}]}]}], 
            ")"}]}], ")"}]}]]}], "/.", "\[VeryThinSpace]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c1", "\[Rule]", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}], ",", 
        RowBox[{"c2", "\[Rule]", 
         RowBox[{"Exp", "[", 
          RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "}"}]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.76673506847576*^9, {3.7667357925614123`*^9, 3.7667358328866854`*^9}, {
   3.7667359167939777`*^9, 3.7667359373879786`*^9}, 3.766736079271576*^9, {
   3.7667363387834864`*^9, 3.766736367752745*^9}, 3.766740548171005*^9, 
   3.7667462087654676`*^9, 3.766746266753399*^9, 3.7667488569779553`*^9, 
   3.766749019870507*^9, 3.766898327385584*^9, 3.7669131442727537`*^9, 
   3.766913197376528*^9, {3.766914282320142*^9, 3.76691429484746*^9}, 
   3.7669143370444403`*^9, 3.767433420702386*^9, {3.7674347989071183`*^9, 
   3.7674348158822412`*^9}, 3.767438647487668*^9, 3.7679425168408546`*^9, 
   3.767942731174694*^9, 3.767943026070219*^9, 3.767943215204691*^9, 
   3.7794535268077908`*^9, 3.780140120934502*^9, 
   3.780140541172573*^9},ExpressionUUID->"577e78dc-d37f-40dd-ae8b-\
838ba14833f3"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"2", " ", "d", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"\[Kappa]12", " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "g"]}], "+", 
          FractionBox[
           RowBox[{"\[Kappa]12", " ", 
            RowBox[{"J", "[", 
             RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "g"]}], ")"}], 
        "2"]}]},
     {"0"},
     {
      RowBox[{"2", " ", "d", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
              ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
            RowBox[{"2", " ", "g"}]]}], "+", 
          FractionBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
            RowBox[{"J", "[", 
             RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
           RowBox[{"2", " ", "g"}]]}], ")"}], "2"]}]},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.76673506847576*^9, {3.7667357925614123`*^9, 3.7667358328866854`*^9}, {
   3.7667359167939777`*^9, 3.7667359373879786`*^9}, 3.766736079271576*^9, {
   3.7667363387834864`*^9, 3.766736367752745*^9}, 3.766740548171005*^9, 
   3.7667462087654676`*^9, 3.766746266753399*^9, 3.7667488569779553`*^9, 
   3.766749019870507*^9, 3.766898327385584*^9, 3.7669131442727537`*^9, 
   3.766913197376528*^9, {3.766914282320142*^9, 3.76691429484746*^9}, 
   3.7669143370444403`*^9, 3.767433420702386*^9, {3.7674347989071183`*^9, 
   3.7674348158822412`*^9}, 3.767438647487668*^9, 3.7679425168408546`*^9, 
   3.767942731174694*^9, 3.767943026070219*^9, 3.767943215204691*^9, 
   3.7794535268077908`*^9, 3.780140120934502*^9, 
   3.780140541178549*^9},ExpressionUUID->"e0961a23-74fd-4761-9717-\
d6cc51e2f6a6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Each term in the following corresponds to an independent noise source, I \
believe. Hence an extra chi-squared distribution\
\>", "Subsection",
 CellChangeTimes->{{3.7674428250537276`*^9, 
  3.7674428553725786`*^9}},ExpressionUUID->"e8679d65-53f2-40ec-9c90-\
c9335c1b4c99"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", "term", ")"}], "2"], " ", 
     RowBox[{"W", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"combinedMean", "=", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", "term", ")"}], "2"], 
         RowBox[{"W", "[", "i", "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}], ")"}], "//",
    "MatrixForm"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"combinedMean", "=", 
       RowBox[{"Collect", "[", 
        RowBox[{"combinedMean", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"J", "[", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{"-", "g"}], "+", "k1", "+", 
               RowBox[{"2", " ", "k12"}], "+", "k2"}], 
              RowBox[{"2", " ", "\[Gamma]"}]]}], "]"}], ",", 
           RowBox[{"J", "[", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{"g", "+", "k1", "+", 
               RowBox[{"2", " ", "k12"}], "+", "k2"}], 
              RowBox[{"2", " ", "\[Gamma]"}]]}], "]"}]}], "}"}]}], "]"}]}], 
      ")"}], "//", "MatrixForm"}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7667463488946085`*^9, 3.7667464013443127`*^9}, 
   3.7667464587250757`*^9, {3.7667465611417565`*^9, 3.7667465651804576`*^9}, {
   3.7667467623242273`*^9, 3.766746772915199*^9}, {3.7667468311970005`*^9, 
   3.7667468497474613`*^9}, {3.7667471545497894`*^9, 3.766747156020952*^9}, {
   3.7669131157429247`*^9, 3.7669131161816764`*^9}, {3.766913220582758*^9, 
   3.766913251431224*^9}, {3.7669143437306337`*^9, 3.766914359858535*^9}, {
   3.767433459580985*^9, 3.7674334616794214`*^9}, {3.7674347891422825`*^9, 
   3.7674347898551044`*^9}, {3.767434838023945*^9, 3.767434839670391*^9}, {
   3.767435053767291*^9, 3.767435075091504*^9}, {3.7674352844636993`*^9, 
   3.7674353024171762`*^9}, {3.7674353797718487`*^9, 3.767435442320895*^9}, {
   3.7674385065737925`*^9, 3.7674385081170144`*^9}, {3.7674386966704965`*^9, 
   3.7674386987652674`*^9}, {3.767438816716261*^9, 3.7674388699337864`*^9}, {
   3.767442716110676*^9, 3.7674427231156707`*^9}, {3.767520518029445*^9, 
   3.767520545149355*^9}},ExpressionUUID->"df0bebfe-d2f0-40e0-8a31-\
24d75ef7dab7"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"2", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
            RowBox[{"2", " ", "g"}]], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
              ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
            RowBox[{"2", " ", "g"}]]}], ")"}], "2"], " ", 
        RowBox[{"W", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", "d", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{"\[Kappa]12", " ", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "g"]}], "+", 
           FractionBox[
            RowBox[{"\[Kappa]12", " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "g"]}], ")"}], 
         "2"], " ", 
        RowBox[{"W", "[", "3", "]"}]}]}]},
     {
      RowBox[{"2", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], "2"], " ", 
       RowBox[{"W", "[", "2", "]"}]}]},
     {
      RowBox[{
       RowBox[{"2", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
            RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
            RowBox[{"4", " ", "g", " ", "\[Kappa]12"}]]}], ")"}], "2"], " ", 
        RowBox[{"W", "[", "1", "]"}]}], "+", 
       RowBox[{"2", " ", "d", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "g"}], "+", "\[Kappa]1", "-", "\[Kappa]2"}], 
               ")"}], " ", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], 
             RowBox[{"2", " ", "g"}]]}], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
             RowBox[{"J", "[", 
              RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
            RowBox[{"2", " ", "g"}]]}], ")"}], "2"], " ", 
        RowBox[{"W", "[", "3", "]"}]}]}]},
     {
      RowBox[{"2", " ", "d", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}], "2"], " ", 
       RowBox[{"W", "[", "4", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7667463881008143`*^9, 3.7667464017521763`*^9}, 
   3.7667464629594154`*^9, 3.766746565782093*^9, 3.766746773749724*^9, 
   3.7667468604393525`*^9, 3.7667471567585325`*^9, 3.7667490263338065`*^9, 
   3.7668983434614305`*^9, {3.766913197507451*^9, 3.766913252217806*^9}, {
   3.766914338972328*^9, 3.7669143605571585`*^9}, 3.7674334484949956`*^9, 
   3.7674347847313337`*^9, 3.7674348402790146`*^9, {3.7674350541605296`*^9, 
   3.767435075818666*^9}, 3.76743530369444*^9, {3.7674353897043824`*^9, 
   3.767435443478304*^9}, 3.767438519102307*^9, {3.76743867898757*^9, 
   3.767438699369521*^9}, {3.7674388205439787`*^9, 3.7674388708494844`*^9}, 
   3.7674427236410336`*^9, {3.767520520887492*^9, 3.7675205462948008`*^9}, 
   3.7679425281476355`*^9, 3.767942731218135*^9, 3.767943215251603*^9, 
   3.7794535268427706`*^9, 3.7801401271089635`*^9, 
   3.78014054122565*^9},ExpressionUUID->"8e2f5f5c-d5a5-4ec9-8ab2-\
d490999e24ac"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"D1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "1", "]"}]}], "+", 
          RowBox[{"4", " ", "d", " ", 
           SuperscriptBox["\[Kappa]12", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox["g", "2"]}]]},
     {
      RowBox[{"2", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], "2"], " ", 
       RowBox[{"W", "[", "2", "]"}]}]},
     {
      FractionBox[
       RowBox[{"D1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], "2"], 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], "2"], 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "1", "]"}]}], "+", 
          RowBox[{"4", " ", "d", " ", 
           SuperscriptBox["\[Kappa]12", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
       RowBox[{"8", " ", 
        SuperscriptBox["g", "2"], " ", 
        SuperscriptBox["\[Kappa]12", "2"]}]]},
     {
      RowBox[{"2", " ", "d", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}], "2"], " ", 
       RowBox[{"W", "[", "4", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7667463881008143`*^9, 3.7667464017521763`*^9}, 
   3.7667464629594154`*^9, 3.766746565782093*^9, 3.766746773749724*^9, 
   3.7667468604393525`*^9, 3.7667471567585325`*^9, 3.7667490263338065`*^9, 
   3.7668983434614305`*^9, {3.766913197507451*^9, 3.766913252217806*^9}, {
   3.766914338972328*^9, 3.7669143605571585`*^9}, 3.7674334484949956`*^9, 
   3.7674347847313337`*^9, 3.7674348402790146`*^9, {3.7674350541605296`*^9, 
   3.767435075818666*^9}, 3.76743530369444*^9, {3.7674353897043824`*^9, 
   3.767435443478304*^9}, 3.767438519102307*^9, {3.76743867898757*^9, 
   3.767438699369521*^9}, {3.7674388205439787`*^9, 3.7674388708494844`*^9}, 
   3.7674427236410336`*^9, {3.767520520887492*^9, 3.7675205462948008`*^9}, 
   3.7679425281476355`*^9, 3.767942731218135*^9, 3.767943215251603*^9, 
   3.7794535268427706`*^9, 3.7801401271089635`*^9, 
   3.7801405415624547`*^9},ExpressionUUID->"94d4b76a-343a-4c0c-b952-\
d43a43598282"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"meanPowerSpectrum", "=", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"combinedMean", "/", 
       RowBox[{"(", 
        RowBox[{"M", " ", "dt"}], ")"}]}]}], "//", "Simplify"}]}], ")"}], "//",
   "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7674354564559965`*^9, 3.7674354583718433`*^9}, {
  3.7674388812709*^9, 
  3.767438881814165*^9}},ExpressionUUID->"c6697d6d-08e6-4e2b-8b94-\
bca2755ffa58"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"D1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "1", "]"}]}], "+", 
          RowBox[{"4", " ", "d", " ", 
           SuperscriptBox["\[Kappa]12", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
       RowBox[{"dt", " ", 
        SuperscriptBox["g", "2"], " ", "M"}]]},
     {
      FractionBox[
       RowBox[{"4", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], "2"], " ", 
        RowBox[{"W", "[", "2", "]"}]}], 
       RowBox[{"dt", " ", "M"}]]},
     {
      FractionBox[
       RowBox[{"D1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], "2"], 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], "2"], 
           " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
              RowBox[{"J", "[", 
               RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "1", "]"}]}], "+", 
          RowBox[{"4", " ", "d", " ", 
           SuperscriptBox["\[Kappa]12", "2"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "-", "\[Kappa]1", "+", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"g", "+", "\[Kappa]1", "-", "\[Kappa]2"}], ")"}], " ", 
               RowBox[{"J", "[", 
                RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], 
           " ", 
           RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
       RowBox[{"4", " ", "dt", " ", 
        SuperscriptBox["g", "2"], " ", "M", " ", 
        SuperscriptBox["\[Kappa]12", "2"]}]]},
     {
      FractionBox[
       RowBox[{"4", " ", "d", " ", "D1", " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}], "2"], " ", 
        RowBox[{"W", "[", "4", "]"}]}], 
       RowBox[{"dt", " ", "M"}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.767435449806803*^9, 3.767435479023797*^9}, 
   3.767438882502719*^9, {3.767520533187524*^9, 3.7675205507420197`*^9}, 
   3.7679425344938254`*^9, 3.767942731772107*^9, 3.7679432157686663`*^9, 
   3.7794535273310485`*^9, 3.7801401354961576`*^9, 
   3.780140541608406*^9},ExpressionUUID->"47584cca-78b0-402e-928f-\
3945c5617167"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Construct \[Sigma] matrix to transfer to Python", "Subsection",
 CellChangeTimes->{{3.767522541447568*^9, 
  3.767522552088149*^9}},ExpressionUUID->"0d42651e-86ab-4640-a7ac-\
cbb86d35e96d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"term", "/.", 
     RowBox[{"i", "\[Rule]", "2"}]}], "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m3", "=", 
   RowBox[{"Table", "[", 
    RowBox[{"term", ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m4", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Join", "[", 
       RowBox[{"m3", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], ")"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(", 
   RowBox[{"sigmaMatrix", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Expand", "[", 
       RowBox[{"m4", "^", "2"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"J", "[", "_", "]"}], "}"}]}], "]"}]}], ")"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"sigmaMatrix", "//", "InputForm"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.767522553082718*^9, 3.7675225680363545`*^9}, {
  3.767522605912839*^9, 3.7675226232081623`*^9}, {3.7675226567209535`*^9, 
  3.7675226822570877`*^9}, {3.7675227342415133`*^9, 3.7675227424047003`*^9}, {
  3.7675227903132973`*^9, 3.767522790696517*^9}, {3.7675228228981247`*^9, 
  3.7675228335972223`*^9}, {3.767522916577388*^9, 3.767522952617631*^9}, {
  3.76752303641819*^9, 3.7675230819857635`*^9}, {3.76752318432211*^9, 
  3.7675231885455894`*^9}, {3.7675232234266267`*^9, 3.767523276817052*^9}, {
  3.767587665857302*^9, 3.767587673472084*^9}, {3.767587748698327*^9, 
  3.7675877622086544`*^9}, {3.767587852745851*^9, 3.7675878970381737`*^9}, {
  3.768133658249358*^9, 
  3.7681336839935884`*^9}},ExpressionUUID->"5b6514b2-8315-406d-9c19-\
a076732aeafe"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["D1", "2"], "+", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1"}], "g"], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]2"}], "g"], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"D1", "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{"2", " ", "D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           SuperscriptBox["g", "2"]]}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["D1", "2"], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1"}], "g"], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]2"}], "g"], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"]}]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "d", " ", "D1", " ", 
         SuperscriptBox["\[Kappa]12", "2"], " ", 
         SuperscriptBox[
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"]}], 
        SuperscriptBox["g", "2"]], "-", 
       FractionBox[
        RowBox[{"4", " ", "d", " ", "D1", " ", 
         SuperscriptBox["\[Kappa]12", "2"], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], 
        SuperscriptBox["g", "2"]], "+", 
       FractionBox[
        RowBox[{"2", " ", "d", " ", "D1", " ", 
         SuperscriptBox["\[Kappa]12", "2"], " ", 
         SuperscriptBox[
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"]}], 
        SuperscriptBox["g", "2"]]}], "0"},
     {"0", 
      RowBox[{"2", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}], "2"]}], "0", "0"},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["g", "2"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "4"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "3"], " ", "\[Kappa]2"}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"3", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"], " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", 
            SuperscriptBox["\[Kappa]2", "3"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "4"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{"D1", " ", 
             SuperscriptBox["g", "2"]}], 
            RowBox[{"4", " ", 
             SuperscriptBox["\[Kappa]12", "2"]}]]}], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "4"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["\[Kappa]12", "2"]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "3"], " ", "\[Kappa]2"}], 
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"3", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"], " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", 
            SuperscriptBox["\[Kappa]2", "3"]}], 
           RowBox[{
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "4"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]]}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["g", "2"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "4"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]1", "3"], " ", "\[Kappa]2"}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"3", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"], " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"4", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "-", 
          FractionBox[
           RowBox[{"D1", " ", "\[Kappa]1", " ", 
            SuperscriptBox["\[Kappa]2", "3"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]], "+", 
          FractionBox[
           RowBox[{"D1", " ", 
            SuperscriptBox["\[Kappa]2", "4"]}], 
           RowBox[{"8", " ", 
            SuperscriptBox["g", "2"], " ", 
            SuperscriptBox["\[Kappa]12", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"]}]}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"d", " ", "D1"}], "2"], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]1"}], "g"], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]2"}], "g"], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "D1"}], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{
           "2", " ", "d", " ", "D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           SuperscriptBox["g", "2"]]}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{"d", " ", "D1"}], "2"], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]1"}], "g"], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]1", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]2"}], "g"], "-", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", "\[Kappa]1", " ", "\[Kappa]2"}], 
           SuperscriptBox["g", "2"]], "+", 
          FractionBox[
           RowBox[{"d", " ", "D1", " ", 
            SuperscriptBox["\[Kappa]2", "2"]}], 
           RowBox[{"2", " ", 
            SuperscriptBox["g", "2"]}]]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"J", "[", 
          RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"]}]}], "0"},
     {"0", "0", "0", 
      RowBox[{"2", " ", "d", " ", "D1", " ", 
       SuperscriptBox[
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "2", "]"}], "]"}], "2"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7675232865079713`*^9, 3.7675876741678934`*^9, {3.7675877561113343`*^9, 
   3.7675877627324367`*^9}, {3.767587861710125*^9, 3.7675878975466566`*^9}, 
   3.767942541457013*^9, 3.767942731825486*^9, 3.7679432158225636`*^9, 
   3.7681336844786863`*^9, 3.779453527364068*^9, 3.780140153019117*^9, 
   3.780140541659398*^9},ExpressionUUID->"584104be-1729-44fb-9b87-\
5ce03f03bd6b"],

Cell["\<\
{{(D1/2 + (D1*\[Kappa]1)/g + (D1*\[Kappa]1^2)/(2*g^2) - (D1*\[Kappa]2)/g - 
     (D1*\[Kappa]1*\[Kappa]2)/g^2 + \
(D1*\[Kappa]2^2)/(2*g^2))*J[\[Lambda][3]]^2 + 
   (D1 - (D1*\[Kappa]1^2)/g^2 + (2*D1*\[Kappa]1*\[Kappa]2)/g^2 - \
(D1*\[Kappa]2^2)/g^2)*
    J[\[Lambda][3]]*J[\[Lambda][4]] + (D1/2 - (D1*\[Kappa]1)/g + \
(D1*\[Kappa]1^2)/(2*g^2) + 
     (D1*\[Kappa]2)/g - (D1*\[Kappa]1*\[Kappa]2)/g^2 + \
(D1*\[Kappa]2^2)/(2*g^2))*J[\[Lambda][4]]^2, 
  0, (2*d*D1*\[Kappa]12^2*J[\[Lambda][3]]^2)/g^2 - 
   (4*d*D1*\[Kappa]12^2*J[\[Lambda][3]]*J[\[Lambda][4]])/g^2 + (2*d*D1*\
\[Kappa]12^2*J[\[Lambda][4]]^2)/
    g^2, 0}, {0, 2*D1*J[\[Lambda][1]]^2, 0, 0}, 
 {((D1*g^2)/(8*\[Kappa]12^2) - (D1*\[Kappa]1^2)/(4*\[Kappa]12^2) + 
     (D1*\[Kappa]1^4)/(8*g^2*\[Kappa]12^2) + (D1*\[Kappa]1*\[Kappa]2)/(2*\
\[Kappa]12^2) - 
     (D1*\[Kappa]1^3*\[Kappa]2)/(2*g^2*\[Kappa]12^2) - (D1*\[Kappa]2^2)/(4*\
\[Kappa]12^2) + 
     (3*D1*\[Kappa]1^2*\[Kappa]2^2)/(4*g^2*\[Kappa]12^2) - (D1*\[Kappa]1*\
\[Kappa]2^3)/
      (2*g^2*\[Kappa]12^2) + (D1*\[Kappa]2^4)/(8*g^2*\[Kappa]12^2))*J[\
\[Lambda][3]]^2 + 
   (-(D1*g^2)/(4*\[Kappa]12^2) + (D1*\[Kappa]1^2)/(2*\[Kappa]12^2) - 
     (D1*\[Kappa]1^4)/(4*g^2*\[Kappa]12^2) - \
(D1*\[Kappa]1*\[Kappa]2)/\[Kappa]12^2 + 
     (D1*\[Kappa]1^3*\[Kappa]2)/(g^2*\[Kappa]12^2) + (D1*\[Kappa]2^2)/(2*\
\[Kappa]12^2) - 
     (3*D1*\[Kappa]1^2*\[Kappa]2^2)/(2*g^2*\[Kappa]12^2) + (D1*\[Kappa]1*\
\[Kappa]2^3)/
      (g^2*\[Kappa]12^2) - \
(D1*\[Kappa]2^4)/(4*g^2*\[Kappa]12^2))*J[\[Lambda][3]]*J[\[Lambda][4]] + 
   ((D1*g^2)/(8*\[Kappa]12^2) - (D1*\[Kappa]1^2)/(4*\[Kappa]12^2) + 
     (D1*\[Kappa]1^4)/(8*g^2*\[Kappa]12^2) + (D1*\[Kappa]1*\[Kappa]2)/(2*\
\[Kappa]12^2) - 
     (D1*\[Kappa]1^3*\[Kappa]2)/(2*g^2*\[Kappa]12^2) - (D1*\[Kappa]2^2)/(4*\
\[Kappa]12^2) + 
     (3*D1*\[Kappa]1^2*\[Kappa]2^2)/(4*g^2*\[Kappa]12^2) - (D1*\[Kappa]1*\
\[Kappa]2^3)/
      (2*g^2*\[Kappa]12^2) + (D1*\[Kappa]2^4)/(8*g^2*\[Kappa]12^2))*J[\
\[Lambda][4]]^2, 0, 
  ((d*D1)/2 - (d*D1*\[Kappa]1)/g + (d*D1*\[Kappa]1^2)/(2*g^2) + \
(d*D1*\[Kappa]2)/g - 
     (d*D1*\[Kappa]1*\[Kappa]2)/g^2 + \
(d*D1*\[Kappa]2^2)/(2*g^2))*J[\[Lambda][3]]^2 + 
   (d*D1 - (d*D1*\[Kappa]1^2)/g^2 + (2*d*D1*\[Kappa]1*\[Kappa]2)/g^2 - 
     (d*D1*\[Kappa]2^2)/g^2)*J[\[Lambda][3]]*J[\[Lambda][4]] + 
   ((d*D1)/2 + (d*D1*\[Kappa]1)/g + (d*D1*\[Kappa]1^2)/(2*g^2) - (d*D1*\
\[Kappa]2)/g - 
     (d*D1*\[Kappa]1*\[Kappa]2)/g^2 + \
(d*D1*\[Kappa]2^2)/(2*g^2))*J[\[Lambda][4]]^2, 0}, 
 {0, 0, 0, 2*d*D1*J[\[Lambda][2]]^2}}\
\>", "Output",
 CellChangeTimes->{
  3.7675232865079713`*^9, 3.7675876741678934`*^9, {3.7675877561113343`*^9, 
   3.7675877627324367`*^9}, {3.767587861710125*^9, 3.7675878975466566`*^9}, 
   3.767942541457013*^9, 3.767942731825486*^9, 3.7679432158225636`*^9, 
   3.7681336844786863`*^9, 3.779453527364068*^9, 3.780140153019117*^9, 
   3.780140541673394*^9},ExpressionUUID->"d9e2c25f-651a-40bf-8ba1-\
0b562bd4cbf4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
After all, I am only really interested in the x component of the 1st \
particle, because the system is symmetric, and y components are simple\
\>", "Subsection",
 CellChangeTimes->{
  3.767435448914297*^9, {3.7674355707606244`*^9, 
   3.7674356163754206`*^9}},ExpressionUUID->"85091012-a60f-4501-ba64-\
ca33e213e197"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"m11", "=", 
   RowBox[{"meanPowerSpectrum", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"col1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{"m11", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], ",", 
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"m11", ",", 
   RowBox[{"{", 
    RowBox[{"D1", ",", "D2"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"col1", "/.", "gRule"}], "/.", 
  RowBox[{"k12", "\[Rule]", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"col1", "/.", "gRule"}], "/.", 
    RowBox[{"k12", "\[Rule]", "0"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", ">", "0"}], ",", 
      RowBox[{"k2", ">", "0"}]}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7674362744655128`*^9, 3.767436353101323*^9}, {
  3.767437802372798*^9, 3.7674378049719105`*^9}, {3.7674389401981544`*^9, 
  3.7674389607905984`*^9}, {3.7674392850551977`*^9, 3.767439295838356*^9}, {
  3.7674393368792152`*^9, 3.7674393682146664`*^9}, {3.767439472231397*^9, 
  3.7674394881270394`*^9}, {3.7674397115758824`*^9, 3.7674397188237457`*^9}, {
  3.7674398624403934`*^9, 3.7674398626238527`*^9}, {3.7674426683977966`*^9, 
  3.7674426778378706`*^9}, {3.7679431961556287`*^9, 
  3.767943201538455*^9}},ExpressionUUID->"aa74b585-acbd-4e51-a2ee-\
bf2fb75518e6"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"J", "[", 
     RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "D1", " ", 
       RowBox[{"(", 
        RowBox[{"g", "+", "k1", "-", "k2"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], " ", 
       RowBox[{"W", "[", "1", "]"}]}], "-", 
      RowBox[{"8", " ", "D2", " ", 
       SuperscriptBox["k12", "2"], " ", 
       RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g", "+", "k1", "-", "k2"}], ")"}], "2"], " ", 
       RowBox[{"W", "[", "1", "]"}]}], "+", 
      RowBox[{"4", " ", "D2", " ", 
       SuperscriptBox["k12", "2"], " ", 
       RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"D1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], "2"], " ", 
       RowBox[{"W", "[", "1", "]"}]}], "+", 
      RowBox[{"4", " ", "D2", " ", 
       SuperscriptBox["k12", "2"], " ", 
       RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]]}]], "Output",
 CellChangeTimes->{
  3.7674361602985563`*^9, {3.767436277883144*^9, 3.767436316189406*^9}, {
   3.767436346497275*^9, 3.767436357155627*^9}, 3.7674378077257586`*^9, 
   3.7674389058983035`*^9, 3.7674389615275755`*^9, 3.767439296579045*^9, {
   3.767439339594674*^9, 3.767439368960019*^9}, 3.7674394885938296`*^9, 
   3.767439719277173*^9, 3.767439863269004*^9, 3.7674426688328786`*^9, 
   3.767443397848074*^9, 3.76794250002308*^9, 3.767942545529229*^9, 
   3.767942731915319*^9, 3.767943215924852*^9, 
   3.77945352740405*^9},ExpressionUUID->"0d3f6174-53f5-4ba0-a8be-\
5c8beef48bbd"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"D1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "+", "k1", "-", "k2"}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], " ", 
    RowBox[{"W", "[", "1", "]"}]}], 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]], "+", 
  FractionBox[
   RowBox[{"4", " ", "D2", " ", 
    SuperscriptBox["k12", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
       RowBox[{"J", "[", 
        RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], " ", 
    RowBox[{"W", "[", "3", "]"}]}], 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]]}]], "Output",
 CellChangeTimes->{
  3.7674361602985563`*^9, {3.767436277883144*^9, 3.767436316189406*^9}, {
   3.767436346497275*^9, 3.767436357155627*^9}, 3.7674378077257586`*^9, 
   3.7674389058983035`*^9, 3.7674389615275755`*^9, 3.767439296579045*^9, {
   3.767439339594674*^9, 3.767439368960019*^9}, 3.7674394885938296`*^9, 
   3.767439719277173*^9, 3.767439863269004*^9, 3.7674426688328786`*^9, 
   3.767443397848074*^9, 3.76794250002308*^9, 3.767942545529229*^9, 
   3.767942731915319*^9, 3.767943215924852*^9, 
   3.779453527411045*^9},ExpressionUUID->"fd72c407-91f2-4490-9d0f-\
668203192742"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"D1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"k1", "-", "k2", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["k1", "2"], "-", 
         RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
         SuperscriptBox["k2", "2"]}]]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"], " ", 
    RowBox[{"W", "[", "1", "]"}]}], 
   RowBox[{"dt", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k1", "2"], "-", 
      RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
      SuperscriptBox["k2", "2"]}], ")"}], " ", "M"}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "D1", " ", 
    RowBox[{"(", 
     RowBox[{"k1", "-", "k2", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["k1", "2"], "-", 
        RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
        SuperscriptBox["k2", "2"]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "k1"}], "+", "k2", "+", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["k1", "2"], "-", 
        RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
        SuperscriptBox["k2", "2"]}]]}], ")"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], " ", 
    RowBox[{"W", "[", "1", "]"}]}], 
   RowBox[{"dt", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k1", "2"], "-", 
      RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
      SuperscriptBox["k2", "2"]}], ")"}], " ", "M"}]], "+", 
  FractionBox[
   RowBox[{"D1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "k1"}], "+", "k2", "+", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["k1", "2"], "-", 
         RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
         SuperscriptBox["k2", "2"]}]]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"], " ", 
    RowBox[{"W", "[", "1", "]"}]}], 
   RowBox[{"dt", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["k1", "2"], "-", 
      RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
      SuperscriptBox["k2", "2"]}], ")"}], " ", "M"}]]}]], "Output",
 CellChangeTimes->{
  3.7674361602985563`*^9, {3.767436277883144*^9, 3.767436316189406*^9}, {
   3.767436346497275*^9, 3.767436357155627*^9}, 3.7674378077257586`*^9, 
   3.7674389058983035`*^9, 3.7674389615275755`*^9, 3.767439296579045*^9, {
   3.767439339594674*^9, 3.767439368960019*^9}, 3.7674394885938296`*^9, 
   3.767439719277173*^9, 3.767439863269004*^9, 3.7674426688328786`*^9, 
   3.767443397848074*^9, 3.76794250002308*^9, 3.767942545529229*^9, 
   3.767942731915319*^9, 3.767943215924852*^9, 
   3.7794535274160423`*^9},ExpressionUUID->"dc271ffb-d636-467c-875f-\
906db90dbc35"],

Cell[BoxData[
 TagBox[GridBox[{
    {"\[Piecewise]", GridBox[{
       {
        FractionBox[
         RowBox[{"4", " ", "D1", " ", 
          SuperscriptBox[
           RowBox[{"J", "[", 
            RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"], " ", 
          RowBox[{"W", "[", "1", "]"}]}], 
         RowBox[{"dt", " ", "M"}]], 
        RowBox[{"k1", "\[GreaterEqual]", "k2"}]},
       {
        FractionBox[
         RowBox[{"4", " ", "D1", " ", 
          SuperscriptBox[
           RowBox[{"J", "[", 
            RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"], " ", 
          RowBox[{"W", "[", "1", "]"}]}], 
         RowBox[{"dt", " ", "M"}]], 
        TagBox["True",
         "PiecewiseDefault",
         AutoDelete->True]}
      },
      AllowedDimensions->{2, Automatic},
      Editable->True,
      GridBoxAlignment->{
       "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
        "RowsIndexed" -> {}},
      GridBoxItemSize->{
       "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
        "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.84]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}},
      Selectable->True]}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxItemSize->{
    "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[0.35]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  "Piecewise",
  DeleteWithContents->True,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.7674361602985563`*^9, {3.767436277883144*^9, 3.767436316189406*^9}, {
   3.767436346497275*^9, 3.767436357155627*^9}, 3.7674378077257586`*^9, 
   3.7674389058983035`*^9, 3.7674389615275755`*^9, 3.767439296579045*^9, {
   3.767439339594674*^9, 3.767439368960019*^9}, 3.7674394885938296`*^9, 
   3.767439719277173*^9, 3.767439863269004*^9, 3.7674426688328786`*^9, 
   3.767443397848074*^9, 3.76794250002308*^9, 3.767942545529229*^9, 
   3.767942731915319*^9, 3.767943215924852*^9, 
   3.7794535274340534`*^9},ExpressionUUID->"4c9b1007-58a1-4710-b2cf-\
42b6afb0f375"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "I don\[CloseCurlyQuote]t need to know exactly what ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["J", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "72c3f230-0a51-48a8-95de-b1a175c56ab0"],
 " values really are, because they include the complicated shape due to \
confinement"
}], "Subsection",
 CellChangeTimes->{{3.767440067423999*^9, 3.7674400942239757`*^9}, {
  3.767440134136176*^9, 
  3.7674401498319526`*^9}},ExpressionUUID->"5d49ab4a-a846-42d3-856b-\
622ebfbb65a4"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"], "/.", "JReImage"}], "/.", 
   RowBox[{
    RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
    RowBox[{"\[Lambda]s", "[", 
     RowBox[{"[", "i", "]"}], "]"}]}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"k12", "\[Rule]", "0"}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.767439923023752*^9, 3.76743996934013*^9}, {
  3.7674400988722887`*^9, 
  3.767440131335991*^9}},ExpressionUUID->"687a5a78-ca61-45c9-bef6-\
cc72e1ece1a3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   SuperscriptBox["dt", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "k1", "+", 
          RowBox[{"2", " ", "k12"}], "+", "k2"}], ")"}]}], "\[Gamma]"]]}], 
    ")"}], " ", "M", " ", "\[Gamma]", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"g", "+", "k1", "+", 
     RowBox[{"2", " ", "k12"}], "+", "k2"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"g", "+", "k1", "+", 
          RowBox[{"2", " ", "k12"}], "+", "k2"}], ")"}]}], "\[Gamma]"]], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "k1", "+", 
           RowBox[{"2", " ", "k12"}], "+", "k2"}], ")"}]}], 
        RowBox[{"2", " ", "\[Gamma]"}]]], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{
  3.76743992603716*^9, {3.7674399643391247`*^9, 3.767439969959502*^9}, {
   3.7674401028289137`*^9, 3.7674401317732453`*^9}, 3.767942553711356*^9, 
   3.7679427321374288`*^9, 3.767943216139952*^9, 
   3.7794535276489844`*^9},ExpressionUUID->"e1c30409-5222-483a-96bf-\
8b79e22f5ff5"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    SuperscriptBox["dt", "2"], " ", "M", " ", "\[Gamma]", " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"], " ", 
    RowBox[{"Sinh", "[", 
     FractionBox[
      RowBox[{"dt", " ", 
       RowBox[{"(", 
        RowBox[{"g", "+", "k1", "+", "k2"}], ")"}]}], 
      RowBox[{"2", " ", "\[Gamma]"}]], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"g", "+", "k1", "+", "k2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "-", 
      RowBox[{"Cosh", "[", 
       FractionBox[
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"g", "+", "k1", "+", "k2"}], ")"}]}], 
        RowBox[{"2", " ", "\[Gamma]"}]], "]"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.76743992603716*^9, {3.7674399643391247`*^9, 3.767439969959502*^9}, {
   3.7674401028289137`*^9, 3.7674401317732453`*^9}, 3.767942553711356*^9, 
   3.7679427321374288`*^9, 3.767943216139952*^9, 
   3.7794535282986393`*^9},ExpressionUUID->"8dfa7541-7f36-4e00-a572-\
5342cf0c8c91"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7674399189413548`*^9, 
  3.7674399200158386`*^9}},ExpressionUUID->"8d3d2fad-a588-47ab-9a6d-\
593800c666ab"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g2Rule", " ", "=", " ", 
  RowBox[{
   SuperscriptBox["g", "2"], "\[Rule]", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["g", "2"], "/.", "gRule"}], 
    ")"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"meanPowerSpectrum", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "g", ",", "2"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], "2"], "/.", "gRule"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k1", ">", "0"}], ",", 
      RowBox[{"k2", ">", "0"}], ",", 
      RowBox[{"k12", ">", "0"}]}], "}"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"meanPowerSpectrum", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "g"}], "]"}], "/.", 
   "g2Rule"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.76743567768849*^9, 3.767435746064206*^9}, {
   3.7674357859204245`*^9, 3.7674358325964575`*^9}, {3.7674359259286914`*^9, 
   3.767435993000842*^9}, {3.7674360438740797`*^9, 3.767436122216776*^9}, 
   3.767436335969552*^9},ExpressionUUID->"4fc0d548-7b9b-448c-8569-\
c640af68b959"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["g", "2"], "\[Rule]", 
  RowBox[{
   SuperscriptBox["k1", "2"], "+", 
   RowBox[{"4", " ", 
    SuperscriptBox["k12", "2"]}], "-", 
   RowBox[{"2", " ", "k1", " ", "k2"}], "+", 
   SuperscriptBox["k2", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.767435685146592*^9, {3.7674357189672813`*^9, 3.767435746464515*^9}, {
   3.767435786418269*^9, 3.7674358399043427`*^9}, {3.7674359315460896`*^9, 
   3.76743599336882*^9}, {3.7674360448022957`*^9, 3.767436065104232*^9}, {
   3.767436111506139*^9, 3.767436122682384*^9}, 3.767436336338114*^9, 
   3.7674378405302534`*^9, 3.7679425665141835`*^9, 3.767942733058197*^9, 
   3.767943216995365*^9, 
   3.779453528400581*^9},ExpressionUUID->"b1ef236f-1849-4e44-b5be-\
3fbf910cb11c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.767435685146592*^9, {3.7674357189672813`*^9, 3.767435746464515*^9}, {
   3.767435786418269*^9, 3.7674358399043427`*^9}, {3.7674359315460896`*^9, 
   3.76743599336882*^9}, {3.7674360448022957`*^9, 3.767436065104232*^9}, {
   3.767436111506139*^9, 3.767436122682384*^9}, 3.767436336338114*^9, 
   3.7674378405302534`*^9, 3.7679425665141835`*^9, 3.767942733058197*^9, 
   3.767943216995365*^9, 
   3.7794535284055557`*^9},ExpressionUUID->"61e9c9cf-cb17-4e80-9baa-\
34b2d2d313c9"],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "k1"}], "+", 
    SqrtBox[
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox["k12", "2"]}], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"k1", "-", "k2"}], ")"}], "2"]}]], "+", "k2"}], ")"}], 
  "2"]], "Output",
 CellChangeTimes->{
  3.767435685146592*^9, {3.7674357189672813`*^9, 3.767435746464515*^9}, {
   3.767435786418269*^9, 3.7674358399043427`*^9}, {3.7674359315460896`*^9, 
   3.76743599336882*^9}, {3.7674360448022957`*^9, 3.767436065104232*^9}, {
   3.767436111506139*^9, 3.767436122682384*^9}, 3.767436336338114*^9, 
   3.7674378405302534`*^9, 3.7679425665141835`*^9, 3.767942733058197*^9, 
   3.767943216995365*^9, 
   3.77945352847053*^9},ExpressionUUID->"32e01fcc-f08b-4639-acff-\
cc50c5fa9a20"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"dt", " ", 
    SuperscriptBox["g", "2"], " ", "M"}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], " ", 
     RowBox[{"J", "[", 
      RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D1", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["g", "2"], "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"k1", "-", "k2"}], ")"}], "2"]}], ")"}], " ", 
        RowBox[{"W", "[", "1", "]"}]}], "-", 
       RowBox[{"4", " ", "D2", " ", 
        SuperscriptBox["k12", "2"], " ", 
        RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g", "+", "k1", "-", "k2"}], ")"}], "2"], " ", 
        RowBox[{"W", "[", "1", "]"}]}], "+", 
       RowBox[{"4", " ", "D2", " ", 
        SuperscriptBox["k12", "2"], " ", 
        RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"J", "[", 
       RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"D1", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], "2"], " ", 
        RowBox[{"W", "[", "1", "]"}]}], "+", 
       RowBox[{"4", " ", "D2", " ", 
        SuperscriptBox["k12", "2"], " ", 
        RowBox[{"W", "[", "3", "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.767435685146592*^9, {3.7674357189672813`*^9, 3.767435746464515*^9}, {
   3.767435786418269*^9, 3.7674358399043427`*^9}, {3.7674359315460896`*^9, 
   3.76743599336882*^9}, {3.7674360448022957`*^9, 3.767436065104232*^9}, {
   3.767436111506139*^9, 3.767436122682384*^9}, 3.767436336338114*^9, 
   3.7674378405302534`*^9, 3.7679425665141835`*^9, 3.767942733058197*^9, 
   3.767943216995365*^9, 
   3.7794535285195265`*^9},ExpressionUUID->"be4cc521-cebe-4353-97a6-\
102d09699c00"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"meanPowerSpectrum", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.766748750025844*^9, 3.7667487526163664`*^9}, 
   3.7668085389828444`*^9, {3.766911277045719*^9, 3.766911299728806*^9}, 
   3.766912954926248*^9, {3.766912992743718*^9, 3.766913009135391*^9}, {
   3.766913241542852*^9, 3.766913244004451*^9}, 3.7669132946556473`*^9, 
   3.7669135354806204`*^9, {3.766914439970378*^9, 3.7669144403301516`*^9}, {
   3.7669145607067013`*^9, 3.766914562214842*^9}, {3.767942576098133*^9, 
   3.767942578432829*^9}},ExpressionUUID->"e954ed95-f3d0-4983-b8bf-\
7592501d337a"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"D1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "+", "k1", "-", "k2"}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"g", "-", "k1", "+", "k2"}], ")"}], " ", 
        RowBox[{"J", "[", 
         RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}]}], ")"}], "2"], " ", 
    RowBox[{"W", "[", "1", "]"}]}], "+", 
   RowBox[{"4", " ", "D2", " ", 
    SuperscriptBox["k12", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"J", "[", 
        RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}], "-", 
       RowBox[{"J", "[", 
        RowBox[{"\[Lambda]", "[", "4", "]"}], "]"}]}], ")"}], "2"], " ", 
    RowBox[{"W", "[", "3", "]"}]}]}], 
  RowBox[{"dt", " ", 
   SuperscriptBox["g", "2"], " ", "M"}]]], "Output",
 CellChangeTimes->{{3.766748736259677*^9, 3.766748753131052*^9}, 
   3.7667490420158796`*^9, 3.766808541674371*^9, 3.7669036092880116`*^9, {
   3.766911270918207*^9, 3.766911300365466*^9}, 3.7669129553269987`*^9, {
   3.7669129936322145`*^9, 3.7669130098149796`*^9}, 3.7669131979102235`*^9, 
   3.766913257949543*^9, 3.766913300923102*^9, 3.766913536217373*^9, {
   3.766914437321864*^9, 3.766914441362584*^9}, 3.7669168508839183`*^9, 
   3.7674356631660805`*^9, {3.767942578964264*^9, 3.7679425936815414`*^9}, 
   3.7679427332125235`*^9, 3.7679432171850147`*^9, 
   3.779453528542513*^9},ExpressionUUID->"fef2a3f0-41e9-4282-9e6c-\
340f7c288697"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Calculate the numerical values for the first component", "Subsection",
 CellChangeTimes->{{3.766746806451107*^9, 3.766746813793945*^9}, {
  3.766746871123294*^9, 
  3.7667468742904673`*^9}},ExpressionUUID->"53946bbe-41af-4fd1-ad93-\
c16f205249df"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"values", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"D1", "\[Rule]", "1"}], ",", 
     RowBox[{"D2", "\[Rule]", "3"}], ",", 
     RowBox[{"k12", "\[Rule]", "1"}], ",", 
     RowBox[{"k1", "\[Rule]", "1"}], ",", 
     RowBox[{"k2", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Gamma]", "\[Rule]", "1"}], ",", 
     RowBox[{"dt", "\[Rule]", "0.3"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"num1", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"k", ",", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"meanPowerSpectrum", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "/", 
          RowBox[{"(", 
           RowBox[{"D1", " ", 
            SuperscriptBox["dt", "2"]}], ")"}]}], "/.", "gRule"}], "/.", 
        "values"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", 
       RowBox[{
        RowBox[{"M", "-", "1"}], "/.", "values"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{"num1", ",", 
   RowBox[{"AxesOrigin", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.766746817114037*^9, {3.7667468768270235`*^9, 3.7667469059075785`*^9}, {
   3.766746953995612*^9, 3.766747009299737*^9}, {3.766747042364484*^9, 
   3.766747113516124*^9}, {3.766747181413475*^9, 3.766747193196885*^9}, {
   3.7667472336778965`*^9, 3.766747238614089*^9}, 3.766748700161229*^9, {
   3.7667487631933446`*^9, 3.766748769617667*^9}, {3.7667488048725977`*^9, 
   3.766748806705575*^9}, {3.7667490607862144`*^9, 3.7667490625622063`*^9}, {
   3.766749131116347*^9, 3.766749144642647*^9}, {3.7668083180946093`*^9, 
   3.7668083313660555`*^9}, {3.766808544782564*^9, 3.7668085546299376`*^9}, {
   3.7668088664875402`*^9, 3.766808866987259*^9}, {3.766911317193864*^9, 
   3.766911334576268*^9}, {3.7669116191968317`*^9, 3.7669116327001677`*^9}, 
   3.766912486524738*^9, {3.766914462394613*^9, 3.7669144758429585`*^9}, {
   3.766914521443022*^9, 3.766914528090266*^9}, {3.7674378587754354`*^9, 
   3.7674378897885966`*^9}, {3.7679425893477054`*^9, 
   3.767942590786107*^9}},ExpressionUUID->"97672346-4e58-4574-a26c-\
85729cb729ee"],

Cell[BoxData[
 GraphicsBox[{{}, {}, {}, {}, {{}, {}}, {{}, {}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0.},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, None},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  ImagePadding->All,
  Method->{"CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        (Identity[#]& )[
         Part[#, 1]], 
        (Identity[#]& )[
         Part[#, 2]]}& )}},
  PlotRange->{{0., 1}, {0., 1}},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.02], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{
  3.7667470013762465`*^9, {3.766747044111492*^9, 3.7667471143856306`*^9}, {
   3.7667471742026024`*^9, 3.766747194055398*^9}, 3.7667472394276023`*^9, {
   3.766748701661376*^9, 3.7667487161011534`*^9}, {3.766748764157797*^9, 
   3.766748770119382*^9}, 3.766748808036796*^9, {3.766749044469503*^9, 
   3.766749063618602*^9}, {3.766749132063809*^9, 3.7667491452353125`*^9}, {
   3.766808319361889*^9, 3.7668083319017496`*^9}, {3.7668085453582363`*^9, 
   3.7668085557722855`*^9}, 3.7668088680146503`*^9, 3.766911335762663*^9, {
   3.766911620887869*^9, 3.766911634205288*^9}, 3.766912487107427*^9, 
   3.766913198879669*^9, {3.766914455837345*^9, 3.7669144806322546`*^9}, {
   3.7669145259684453`*^9, 3.7669145327286263`*^9}, {3.767437848938349*^9, 
   3.767437891402853*^9}, 3.767942583678356*^9, 3.7679427335064783`*^9, 
   3.7679430341949525`*^9, 3.7679432174360466`*^9, 
   3.779453528938307*^9},ExpressionUUID->"8ed174c3-b77b-427b-a698-\
1d9645e71ac8"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7667463083837366`*^9, 
  3.7667463095449495`*^9}},ExpressionUUID->"1f5d47f7-ab88-4325-9a7c-\
0525787c233d"]
}, Open  ]],

Cell["Exact results for Python likelihood test", "Subsection",
 CellChangeTimes->{{3.767942034839957*^9, 
  3.767942046767939*^9}},ExpressionUUID->"b7b5277d-9969-40ef-beda-\
45d0976726b8"],

Cell[CellGroupData[{

Cell["test_likelihood_one_point", "Subsection",
 CellChangeTimes->{{3.7681294477532835`*^9, 3.7681294519859257`*^9}, {
  3.768134288748392*^9, 
  3.76813429172237*^9}},ExpressionUUID->"fd00fc9c-a716-4af9-bdc3-\
138de2a025ff"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", 
      RowBox[{"n1", " ", "\[Gamma]"}]}], ",", 
     RowBox[{"k2", "\[Rule]", 
      RowBox[{"n2", " ", "\[Gamma]"}]}], ",", " ", 
     RowBox[{"k12", "\[Rule]", 
      RowBox[{"n12", " ", "\[Gamma]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z", "->", 
      SuperscriptBox["10", 
       RowBox[{"-", "1"}]]}], ",", " ", 
     RowBox[{"k", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"D1", "\[Rule]", "1"}], ",", 
     RowBox[{"D2", "\[Rule]", "3"}], ",", 
     RowBox[{"n1", "\[Rule]", "1"}], ",", 
     RowBox[{"n2", "\[Rule]", "1"}], ",", 
     RowBox[{"n12", "\[Rule]", "1"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}], ",", 
     RowBox[{"dt", "\[Rule]", 
      RowBox[{"3", "/", "10"}]}], ",", 
     RowBox[{"alpha", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalSigmaMatrix", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sigmaMatrix", "/.", "JReImage"}], "/.", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\[Lambda]s", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "/.", "gRule"}], "/.", 
       "kRules"}], "/.", "rules"}], "//", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"evalSigmaMatrixLeadingTerm", "=", 
     RowBox[{
      RowBox[{"evalSigmaMatrix", "/", 
       RowBox[{"(", 
        RowBox[{"M", "*", "dt"}], ")"}]}], "/.", "rules"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2sX", "=", 
   RowBox[{"evalSigmaMatrixLeadingTerm", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lklhPDF", " ", "[", "z_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "z"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"sigma2sX", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", 
            RowBox[{"3", "-", "j"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lklhPDF", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "4"}]]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{
     RowBox[{"lklhPDF", "[", "z", "]"}], "/.", "rules"}], "]"}], ",", "10"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQ/a98eulxoTeOd8ItK0H0IyGmmSDa84AKmG6wLtoL
or13bQfTR+79PwSiX+xbegJEr1i86DaIXid25imITr7bwHkCSGt4NfGA6Ek/
pBRB9M87Csog+tjP9eogurqM1RBEzyycaQqiN5n4W4FogebfbiC6onWjN4hO
f6kQB6K5vlyrAovfYGsG0btiGVpAtFlOt8UpIN1+45QliLa2/mkHoj/9T3MA
0VtSREpA9P6uIDBdcOXV3dNAesYS//sgWvuZzwcQ/a4uGEzHTnP8A6Kj4teB
aR2DGX6qwm8cnQ7OAdPOjFFhIPqXeTSYBgBIz6IA
  "],ExpressionUUID->"fad00946-c47e-4fd2-95bf-7f7c5b1ec8a7"],

Cell[BoxData[
 RowBox[{"-", "2786.6496417474090040127`10."}]], "Output",
 CellChangeTimes->{
  3.7679423455670586`*^9, 3.7679426384471107`*^9, 3.767942687326833*^9, 
   3.767942768241995*^9, {3.7679428848323574`*^9, 3.7679429040951333`*^9}, {
   3.7679429351828947`*^9, 3.76794295903133*^9}, 3.767943036913238*^9, 
   3.7679430740633564`*^9, 3.7679432175653296`*^9, 3.7679432688728952`*^9, 
   3.767943449832156*^9, {3.767943556183926*^9, 3.7679435607362037`*^9}, {
   3.767943612282155*^9, 3.767943635201332*^9}, 3.7679437537056932`*^9, 
   3.7679439477459216`*^9, {3.7679440986216927`*^9, 3.7679441514781137`*^9}, 
   3.767944224363631*^9, {3.7679477190280013`*^9, 3.767947726692251*^9}, {
   3.7679477691758833`*^9, 3.7679477798036547`*^9}, 3.767948195998334*^9, 
   3.767951088112543*^9, 3.767951170624151*^9, 3.767951236023823*^9, 
   3.7679513343625836`*^9, {3.7681342338732615`*^9, 3.768134262256073*^9}, 
   3.768134324138193*^9, 
   3.779453529240135*^9},ExpressionUUID->"eeb087ad-5897-4e7c-8d6e-\
6361df1e866d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two points - test 1", "Subsubsection",
 CellChangeTimes->{{3.767951301785449*^9, 3.767951305624748*^9}, {
  3.7679523314192266`*^9, 3.767952333371022*^9}, {3.7679527627717037`*^9, 
  3.76795277497954*^9}},ExpressionUUID->"a3c6365f-3072-4000-b771-\
11c1992f5914"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", 
      RowBox[{"n1", " ", "\[Gamma]"}]}], ",", 
     RowBox[{"k2", "\[Rule]", 
      RowBox[{"n2", " ", "\[Gamma]"}]}], ",", " ", 
     RowBox[{"k12", "\[Rule]", 
      RowBox[{"n12", " ", "\[Gamma]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z1", "->", 
      SuperscriptBox["10", 
       RowBox[{"-", "4"}]]}], ",", 
     RowBox[{"z2", "\[Rule]", 
      RowBox[{
       RowBox[{"23", "/", "10"}], " ", 
       SuperscriptBox["10", 
        RowBox[{"-", "3"}]]}]}], ",", " ", 
     RowBox[{"k1", "\[Rule]", " ", "1"}], ",", 
     RowBox[{"k2", "\[Rule]", "2"}], ",", 
     RowBox[{"D1", "\[Rule]", "1"}], ",", 
     RowBox[{"D2", "\[Rule]", "2"}], ",", 
     RowBox[{"n1", "\[Rule]", "1"}], ",", 
     RowBox[{"n2", "\[Rule]", "1"}], ",", 
     RowBox[{"n12", "\[Rule]", "1"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}], ",", 
     RowBox[{"dt", "\[Rule]", 
      RowBox[{"3", "/", "10"}]}], ",", 
     RowBox[{"alpha", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalSigmaMatrix", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sigmaMatrix", "/.", "JReImage"}], "/.", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\[Lambda]s", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "/.", "gRule"}], "/.", 
       "kRules"}], "/.", "rules"}], "//", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"evalSigmaMatrixLeadingTerm", "=", 
     RowBox[{
      RowBox[{"evalSigmaMatrix", "/", 
       RowBox[{"(", 
        RowBox[{"M", "*", "dt"}], ")"}]}], "/.", "rules"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2sX", "=", 
   RowBox[{"evalSigmaMatrixLeadingTerm", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lklhPDF", " ", "[", "z_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "z"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"sigma2sX", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", 
            RowBox[{"3", "-", "j"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lklhPDF", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "4"}]]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z1", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "k1"}]}], ")"}], "]"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z2", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "k2"}]}], ")"}], "]"}]}], "/.", "rules"}], 
   ",", "10"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ/a98eulxoTeOd8ItK0H0IyGmmSDa84AKmG6wLtoL
or13bQfTR+79PwSiX+xbegJEr1i86DaIXid25imITr7bwHkCSGt4NfGA6Ek/
pBRB9M87Csog+tjP9eogurqM1RBEzyycaQqiN5n4W4FogebfbiC6onWjN4hO
f6kQB6K5vlyrAovfYGsG0btiGVpAtFlOt8UpIN1+45QliLa2/mkHoj/9T3MA
0VtSREpA9P6uIDBdcOXV3dNAesYS//sgWvuZzwcQ/a4uGEyLqJv/BdFdtbVg
+pRTYNUZIB3lsqcWRPcHyDWB6FXKPr0g2uqO0RIQbfTCG0wDAPu0rM8=
  "],ExpressionUUID->"e9a13f51-bfd5-4e68-b4f8-75313eb8c02c"],

Cell[BoxData["1.48356087370806291944730177858558664568`10."], "Output",
 CellChangeTimes->{{3.7679524827931967`*^9, 3.7679524910759573`*^9}, 
   3.767952675371885*^9, 3.7681343595789003`*^9, 
   3.779453529471981*^9},ExpressionUUID->"c7ed4bdc-ca0b-45c2-a983-\
c9531ba6c847"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two points - test 2", "Subsubsection",
 CellChangeTimes->{{3.767951301785449*^9, 3.767951305624748*^9}, {
  3.7679523314192266`*^9, 3.767952333371022*^9}, {3.7679527627717037`*^9, 
  3.767952772163495*^9}},ExpressionUUID->"6656837d-a284-4ed1-b190-\
cbbe00651f68"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", 
      RowBox[{"n1", " ", "\[Gamma]"}]}], ",", 
     RowBox[{"k2", "\[Rule]", 
      RowBox[{"n2", " ", "\[Gamma]"}]}], ",", " ", 
     RowBox[{"k12", "\[Rule]", 
      RowBox[{"n12", " ", "\[Gamma]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z1", "->", 
      RowBox[{"113", "/", "1000"}]}], ",", 
     RowBox[{"z2", "\[Rule]", 
      RowBox[{"45", "/", "1000"}]}], ",", " ", 
     RowBox[{"freq1", "\[Rule]", " ", "101"}], ",", 
     RowBox[{"freq2", "\[Rule]", "114"}], ",", 
     RowBox[{"D1", "\[Rule]", "1"}], ",", 
     RowBox[{"D2", "\[Rule]", "2"}], ",", 
     RowBox[{"n1", "\[Rule]", "1"}], ",", 
     RowBox[{"n2", "\[Rule]", "1"}], ",", 
     RowBox[{"n12", "\[Rule]", "1"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}], ",", 
     RowBox[{"dt", "\[Rule]", 
      RowBox[{"3", "/", "10"}]}], ",", 
     RowBox[{"alpha", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalSigmaMatrix", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sigmaMatrix", "/.", "JReImage"}], "/.", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\[Lambda]s", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "/.", "gRule"}], "/.", 
       "kRules"}], "/.", "rules"}], "//", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"evalSigmaMatrixLeadingTerm", "=", 
     RowBox[{
      RowBox[{"evalSigmaMatrix", "/", 
       RowBox[{"(", 
        RowBox[{"M", "*", "dt"}], ")"}]}], "/.", "rules"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2sX", "=", 
   RowBox[{"evalSigmaMatrixLeadingTerm", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lklhPDF", " ", "[", "z_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "z"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"sigma2sX", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", 
            RowBox[{"3", "-", "j"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lklhPDF", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "4"}]]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Log", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"lklhPDF", "[", "z1", "]"}], "/.", 
      RowBox[{"k", "\[Rule]", "freq1"}]}], ")"}], "]"}], "+", 
   RowBox[{"Log", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"lklhPDF", "[", "z2", "]"}], "/.", 
      RowBox[{"k", "\[Rule]", "freq2"}]}], ")"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z1", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "freq1"}]}], ")"}], "]"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z2", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "freq2"}]}], ")"}], "]"}]}], "/.", "rules"}], 
   ",", "10"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7679420607333975`*^9, 3.767942089791975*^9}, {
   3.767942344064805*^9, 3.7679423451484723`*^9}, {3.767942635569763*^9, 
   3.767942637741491*^9}, {3.767942679995943*^9, 3.767942725179554*^9}, {
   3.7679428770824776`*^9, 3.7679429583777685`*^9}, {3.7679432440270247`*^9, 
   3.7679432680715523`*^9}, {3.767943432842843*^9, 3.767943449026974*^9}, {
   3.76794348549924*^9, 3.767943560170713*^9}, {3.767943596795117*^9, 
   3.7679436344751825`*^9}, {3.767943735859749*^9, 3.7679437735475426`*^9}, {
   3.7679439210284915`*^9, 3.76794415071729*^9}, {3.7679442162139244`*^9, 
   3.767944224011441*^9}, {3.7679477163569593`*^9, 3.7679477263389316`*^9}, {
   3.7679477677884803`*^9, 3.7679477792187433`*^9}, {3.767948192637293*^9, 
   3.767948194579437*^9}, {3.7679510873384323`*^9, 3.767951098488842*^9}, {
   3.7679512344030967`*^9, 3.7679512346092443`*^9}, {3.7679513377235203`*^9, 
   3.7679513399215746`*^9}, {3.767952338539403*^9, 3.7679523658833437`*^9}, {
   3.767952400947334*^9, 3.7679524903793535`*^9}, {3.767952673589383*^9, 
   3.767952674372094*^9}, {3.7679527817880344`*^9, 3.7679528356923733`*^9}, {
   3.767953662297039*^9, 3.767953686982274*^9}, 3.7679537311666636`*^9, {
   3.767955244017916*^9, 
   3.767955267794057*^9}},ExpressionUUID->"345d45b9-e7ed-4e8e-a908-\
ce436136b12d"],

Cell[BoxData["3.2644676492758205855`10."], "Output",
 CellChangeTimes->{{3.7679524827931967`*^9, 3.7679524910759573`*^9}, 
   3.767952675371885*^9, 3.7679528367986336`*^9, 3.7679536636692743`*^9, 
   3.76795373204105*^9, 3.7679552696542463`*^9, 3.768134399120515*^9, 
   3.7794535296869097`*^9},ExpressionUUID->"9a9c7413-c80d-4244-8ffc-\
a66b67853612"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Define the priors", "Subsection",
 CellChangeTimes->{{3.7794546368886805`*^9, 
  3.7794546484789324`*^9}},ExpressionUUID->"2487ae94-7b62-4b37-9a6e-\
ae80ef696269"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"beta", " ", "=", " ", 
   RowBox[{"5", "/", "10"}]}], ";", 
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"5", "/", "10"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lnDPrior", "[", "d_", "]"}], ":=", 
   RowBox[{
    RowBox[{"a", " ", 
     RowBox[{"Log", "[", "beta", "]"}]}], " ", "-", " ", 
    RowBox[{"LogGamma", "[", "a", "]"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", "1"}], ")"}], " ", 
     RowBox[{"Log", "[", "d", "]"}]}], " ", "-", " ", 
    RowBox[{"beta", "/", "d"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n0", "=", 
   SuperscriptBox["10", "3"]}], ";", " ", 
  RowBox[{"\[Sigma]n", "=", 
   RowBox[{
    RowBox[{"Log", "[", "10", "]"}], "/", "2"}]}], ";", " ", 
  RowBox[{"\[Mu]n", "=", 
   RowBox[{
    RowBox[{"Log", "[", "n0", "]"}], " ", "+", " ", 
    SuperscriptBox["\[Sigma]n", "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lnNPrior", "[", "n_", "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"Log", "[", "n", "]"}]}], "-", 
    RowBox[{
     RowBox[{"1", "/", "2"}], "*", 
     RowBox[{"Log", "[", 
      RowBox[{"2", "*", "\[Pi]", "*", 
       SuperscriptBox["\[Sigma]n", "2"]}], "]"}]}], "-", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Log", "[", "n", "]"}], "-", "\[Mu]n"}], ")"}], "2"], "/", 
      "2"}], "/", 
     SuperscriptBox["\[Sigma]n", "2"]}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lnNLinkPrior", "[", "n_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Log", "[", "a", "]"}], "-", 
   RowBox[{"Log", "[", "n0", "]"}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"a", "+", "1"}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "+", 
      RowBox[{"n", "/", "n0"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7794546517180786`*^9, 3.7794547352305574`*^9}, {
  3.779454773862671*^9, 3.779454775918491*^9}, {3.7794549100227995`*^9, 
  3.779454917438547*^9}, {3.779454964734606*^9, 
  3.7794551519824924`*^9}},ExpressionUUID->"3387d635-84af-465d-b684-\
e40b39958c09"]
}, Open  ]],

Cell[CellGroupData[{

Cell["test_MLE_search", "Subsection",
 CellChangeTimes->{{3.768129458113051*^9, 3.7681294614812984`*^9}, {
  3.768134475589037*^9, 
  3.768134478810557*^9}},ExpressionUUID->"765ab012-8757-4bca-a42a-\
883c34b4f1ec"],

Cell[CellGroupData[{

Cell["Test MLE - test 1", "Subsubsection",
 CellChangeTimes->{{3.767951301785449*^9, 3.767951305624748*^9}, {
  3.7679523314192266`*^9, 3.767952333371022*^9}, {3.7679527627717037`*^9, 
  3.76795277497954*^9}, {3.767954949871122*^9, 
  3.7679549532156973`*^9}},ExpressionUUID->"bae16de2-6afb-422e-bdf4-\
f534989076bd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", 
      RowBox[{"n1", " ", "\[Gamma]"}]}], ",", 
     RowBox[{"k2", "\[Rule]", 
      RowBox[{"n2", " ", "\[Gamma]"}]}], ",", " ", 
     RowBox[{"k12", "\[Rule]", 
      RowBox[{"n12", " ", "\[Gamma]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"z1", "\[Rule]", 
      SuperscriptBox["dt", "2"]}], ",", 
     RowBox[{"z2", "\[Rule]", 
      RowBox[{
       SuperscriptBox["dt", "2"], "*", 
       RowBox[{"95", "/", "100"}]}]}], ",", " ", 
     RowBox[{"freq1", "\[Rule]", " ", "400"}], ",", 
     RowBox[{"freq2", "\[Rule]", "402"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}], ",", 
     RowBox[{"dt", "\[Rule]", 
      RowBox[{"3", "/", "10"}]}], ",", 
     RowBox[{"alpha", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalSigmaMatrix", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"sigmaMatrix", "/.", "JReImage"}], "/.", 
         RowBox[{
          RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\[Lambda]s", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], "/.", "gRule"}], "/.", 
       "kRules"}], "//.", "rules"}], "//", 
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Gamma]", ">", "0"}], "}"}]}]}], "]"}], "&"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"evalSigmaMatrixLeadingTerm", "=", 
     RowBox[{
      RowBox[{"evalSigmaMatrix", "/", 
       RowBox[{"(", 
        RowBox[{"M", "*", "dt"}], ")"}]}], "//.", "rules"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sigma2sX", "=", 
   RowBox[{"evalSigmaMatrixLeadingTerm", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "3"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lklhPDF", " ", "[", "z_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{
          RowBox[{"-", "z"}], "/", 
          RowBox[{"(", 
           RowBox[{"2", "*", 
            RowBox[{"sigma2sX", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], ")"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", "j", "]"}], "]"}], "-", 
          RowBox[{"sigma2sX", "[", 
           RowBox[{"[", 
            RowBox[{"3", "-", "j"}], "]"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], "/", 
    "2"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Plot", "[", 
    RowBox[{
     RowBox[{"lklhPDF", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0", ",", 
       SuperscriptBox["10", 
        RowBox[{"-", "4"}]]}], "}"}], ",", " ", 
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"lnDPrior", "[", "D1", "]"}], "+", 
     RowBox[{"lnDPrior", "[", "D2", "]"}], "+", 
     RowBox[{"lnNPrior", "[", "n1", "]"}], " ", "+", " ", 
     RowBox[{"lnNPrior", "[", "n2", "]"}], "+", 
     RowBox[{"lnNLinkPrior", "[", "n12", "]"}], "+", "\[IndentingNewLine]", 
     " ", 
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z1", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "freq1"}]}], ")"}], "]"}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lklhPDF", "[", "z2", "]"}], "/.", 
        RowBox[{"k", "\[Rule]", "freq2"}]}], ")"}], "]"}]}], "//.", 
    "rules"}]}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7679420607333975`*^9, 3.767942089791975*^9}, {
   3.767942344064805*^9, 3.7679423451484723`*^9}, {3.767942635569763*^9, 
   3.767942637741491*^9}, {3.767942679995943*^9, 3.767942725179554*^9}, {
   3.7679428770824776`*^9, 3.7679429583777685`*^9}, {3.7679432440270247`*^9, 
   3.7679432680715523`*^9}, {3.767943432842843*^9, 3.767943449026974*^9}, {
   3.76794348549924*^9, 3.767943560170713*^9}, {3.767943596795117*^9, 
   3.7679436344751825`*^9}, {3.767943735859749*^9, 3.7679437735475426`*^9}, {
   3.7679439210284915`*^9, 3.76794415071729*^9}, {3.7679442162139244`*^9, 
   3.767944224011441*^9}, {3.7679477163569593`*^9, 3.7679477263389316`*^9}, {
   3.7679477677884803`*^9, 3.7679477792187433`*^9}, {3.767948192637293*^9, 
   3.767948194579437*^9}, {3.7679510873384323`*^9, 3.767951098488842*^9}, {
   3.7679512344030967`*^9, 3.7679512346092443`*^9}, {3.7679513377235203`*^9, 
   3.7679513399215746`*^9}, {3.767952338539403*^9, 3.7679523658833437`*^9}, {
   3.767952400947334*^9, 3.7679524903793535`*^9}, {3.767952673589383*^9, 
   3.767952674372094*^9}, {3.767955115760624*^9, 3.7679551305362387`*^9}, {
   3.767955161761874*^9, 3.767955161944113*^9}, {3.7679552194656944`*^9, 
   3.767955220128473*^9}, {3.76795527595427*^9, 3.7679553076887383`*^9}, {
   3.7679556280502977`*^9, 3.767955631313222*^9}, {3.767955687057118*^9, 
   3.767955736977539*^9}, {3.7794540220312576`*^9, 3.779454032815099*^9}, 
   3.7794540725673447`*^9, {3.77945480004669*^9, 3.779454853662458*^9}, {
   3.7794551627186832`*^9, 3.7794551770379567`*^9}, {3.7794552910941515`*^9, 
   3.779455333133194*^9}},ExpressionUUID->"860faabe-13f1-40b9-952e-\
c5a574ef89e0"],

Cell[BoxData[
 RowBox[{"-", "33.204046013809396`"}]], "Output",
 CellChangeTimes->{
  3.779455334880194*^9},ExpressionUUID->"86c39340-1a7c-4ba9-8d4b-\
802e2aca4de7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"N", "[", 
  RowBox[{
   RowBox[{"f1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"D1", "\[Rule]", "0.25395969151719444"}], ",", " ", 
      RowBox[{"D2", "\[Rule]", "39.37342940276975"}], ",", " ", 
      RowBox[{"n1", "\[Rule]", "163.71320649046308"}], ",", 
      RowBox[{"n2", "->", "164.61658301327387"}], ",", 
      RowBox[{"n12", "->", "547.8939318922991"}]}], "}"}]}], ",", " ", "15"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.7794553640015326`*^9, 
  3.7794554393095756`*^9}},ExpressionUUID->"b2e339de-15c3-446e-a372-\
dce7d3c54ea5"],

Cell[BoxData[
 RowBox[{"-", "33.2037715251153`"}]], "Output",
 CellChangeTimes->{
  3.7794553371059175`*^9, {3.7794554272484655`*^9, 
   3.7794554398702335`*^9}},ExpressionUUID->"ae7d3e07-1e63-447f-88f5-\
6e53fb11e325"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "f1"}], ",", 
     RowBox[{
      RowBox[{"D1", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"D2", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n1", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n2", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n12", ">=", "0"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "D1", ",", " ", "D2", ",", " ", "n1", ",", " ", "n2", ",", "n12"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7794555304536753`*^9, 3.7794555683990326`*^9}, 
   3.779455621142544*^9},ExpressionUUID->"cf96d452-eef1-4287-9f98-\
5105eba7cc17"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{3.7794555332250676`*^9, 3.77945557006006*^9, 
  3.7794556184727325`*^9, 
  3.779535415183381*^9},ExpressionUUID->"377df5e0-b4c4-408c-8486-\
2d0206e8360a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "f1"}], ",", 
     RowBox[{
      RowBox[{"D1", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"D2", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n1", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n2", ">", 
       SuperscriptBox["10", 
        RowBox[{"-", "8"}]]}], "&&", 
      RowBox[{"n12", ">", "0"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "D1", ",", " ", "D2", ",", " ", "n1", ",", " ", "n2", ",", "n12"}], "}"}],
    ",", 
   RowBox[{"WorkingPrecision", "\[Rule]", "50"}], ",", " ", 
   RowBox[{"MaxIterations", "\[Rule]", "300"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7679551669977283`*^9, 3.7679552119203186`*^9}, 
   3.767955325232336*^9, {3.7679553621229105`*^9, 3.7679553769212227`*^9}, {
   3.76795543521782*^9, 3.7679554462645025`*^9}, {3.767957113548869*^9, 
   3.767957146651746*^9}, {3.779454161686954*^9, 3.7794541867266808`*^9}, {
   3.779454877078479*^9, 3.779454896013726*^9}, {3.779455193936299*^9, 
   3.7794551956822777`*^9}, {3.7794552391274033`*^9, 3.779455240887396*^9}, 
   3.7794554855181*^9, 
   3.779455521390565*^9},ExpressionUUID->"3eaec3ad-e05f-4de7-bd76-\
5ebc3435a800"],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0\\\", \\\"2\\\"]]\\) encountered.\"",2,182,41,
   16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552058674407`*^9}},ExpressionUUID->"c24d7286-182f-4d0c-87a1-\
b8fa80aec176"],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \
\\!\\(\\*SuperscriptBox[\\\"\[ExponentialE]\\\", \\\"ComplexInfinity\\\"]\\) \
encountered.\"",2,182,42,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552064761133`*^9}},ExpressionUUID->"936794c9-a4c6-4732-8206-\
05ed7d80cdd2"],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \
\\!\\(\\*SuperscriptBox[\\\"\[ExponentialE]\\\", \\\"ComplexInfinity\\\"]\\) \
encountered.\"",2,182,43,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.779455207062756*^9}},ExpressionUUID->"f0616aef-981b-4196-b957-\
34e628a40c2f"],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0\\\", \\\"2\\\"]]\\) encountered.\"",2,182,44,
   16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552076684103`*^9}},ExpressionUUID->"2b7090f5-1bb1-4274-b4be-\
42eca9de71fa"],

Cell[BoxData[
 TemplateBox[{
  "Infinity","indet",
   "\"Indeterminate expression \
\\!\\(\\*SuperscriptBox[\\\"\[ExponentialE]\\\", \\\"ComplexInfinity\\\"]\\) \
encountered.\"",2,182,45,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552082700653`*^9}},ExpressionUUID->"de2c8052-4821-43ab-99cc-\
77db915df091"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Infinity\\\", \
\\\"::\\\", \\\"indet\\\"}], \\\"MessageName\\\"]\\) will be suppressed \
during this calculation.\"",2,182,46,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552088737197`*^9}},ExpressionUUID->"87290a08-fdb2-4594-b4f8-\
512172c831e0"],

Cell[BoxData[
 TemplateBox[{
  "Power","infy",
   "\"Infinite expression \\!\\(\\*FractionBox[\\\"1\\\", \
SuperscriptBox[\\\"0\\\", \\\"2\\\"]]\\) encountered.\"",2,182,47,
   16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.7794552094713993`*^9}},ExpressionUUID->"37945813-c63d-4b6e-86bf-\
65926075fd4b"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Power\\\", \\\"::\\\", \
\\\"infy\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,182,48,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.77945521005904*^9}},ExpressionUUID->"a2165b45-87cb-4f8b-87c0-\
35f67c8c1f17"],

Cell[BoxData[
 TemplateBox[{
  "NMinimize","nnum",
   "\"The function value \\!\\(\\*RowBox[{\\\"Indeterminate\\\"}]\\) is not a \
number at \\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"D1\\\", \\\",\\\", \\\"D2\\\
\", \\\",\\\", \\\"n1\\\", \\\",\\\", \\\"n12\\\", \\\",\\\", \\\"n2\\\"}], \
\\\"}\\\"}]\\) = \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{\\\"13.\
65878812301486714651377956853068270034411157664320229027711958245579372659071`\
50.\\\", \\\",\\\", \
\\\"0.335229321475498049856211639626867244965236609269784775612289265816415720\
75549`50.\\\", \\\",\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"66\\\", \\\"\
\[RightSkeleton]\\\"}], \\\",\\\", \\\"0\\\", \\\",\\\", \
\\\"149.8747979159355902094329961498230067825948310448883606782914`50.\\\"}], \
\\\"}\\\"}]\\).\"",2,182,49,16602715069919762817,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.779454856828624*^9, 3.7794548981634936`*^9, 3.7794549332900867`*^9, {
   3.779455192051379*^9, 
   3.77945521063171*^9}},ExpressionUUID->"fae46a5b-86d5-4cf5-9a23-\
2bf502da3aac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "29.471267345189985465288866504387225009757140918161711037827055551641412686\
9765`50.", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
     "D1", "\[Rule]", 
      "13.51298511078704770147203479263311496365917101896951662516368587736604\
044241585`50."}], ",", 
     RowBox[{
     "D2", "\[Rule]", 
      "0.294041226964485572774815026195569617439858482183265991532658103589962\
83862879`50."}], ",", 
     RowBox[{
     "n1", "\[Rule]", 
      "213.4182255855148187382450352716218380219245060584265728971103`50."}], 
     ",", 
     RowBox[{
     "n12", "\[Rule]", 
      "5.378417772546396909992885050017215201152621220217717852812510038603736\
03254536`50."}], ",", 
     RowBox[{
     "n2", "\[Rule]", 
      "156.4343668242320998665813234269513522761966275061092319644832`50."}]}]\
, "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7679553420046635`*^9, 3.767955385639931*^9, 3.767955453756248*^9, 
   3.7679556580729456`*^9, 3.767955728792181*^9, 3.767955775087769*^9, {
   3.767957121036441*^9, 3.767957156026602*^9}, 3.768134505804945*^9, 
   3.7794535459925694`*^9, 3.77945414786232*^9, 3.7794541918837223`*^9, 
   3.779454862250994*^9, 3.77945490355748*^9, 3.7794549379983673`*^9, {
   3.779455196824623*^9, 
   3.77945521063471*^9}},ExpressionUUID->"69008c67-e2e1-4c5b-97f5-\
697cc984597a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Minimize", "[", 
  RowBox[{
   RowBox[{"-", "f1"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "D1", ",", " ", "D2", ",", " ", "n1", ",", " ", "n2", ",", "n12"}], 
    "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7679554630088058`*^9, {3.7679554961335287`*^9, 3.767955509369475*^9}, {
   3.767955542409628*^9, 
   3.767955545850282*^9}},ExpressionUUID->"2472f5df-904d-42de-8cd4-\
731844527e57"],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{
  3.7679554636765156`*^9, {3.7679554983398914`*^9, 3.767955546482398*^9}, 
   3.767955675644706*^9, 
   3.779453685335794*^9},ExpressionUUID->"3ec7300a-4b0a-4f9d-aacb-\
d51ace284ef6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["WorkingPrecision"], "Input",
 CellChangeTimes->{{3.767957086401166*^9, 
  3.767957096532175*^9}},ExpressionUUID->"6c225f8f-0f2e-495c-ac70-\
fe7bbd666260"],

Cell[BoxData["$WorkingPrecision"], "Output",
 CellChangeTimes->{{3.767957088167107*^9, 
  3.767957092783848*^9}},ExpressionUUID->"938d0c72-040f-4e29-b93f-\
c04ae1aab39c"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["test_mean (with Custom matrix evaluations)", "Subsection",
 CellChangeTimes->{{3.7681294701212797`*^9, 3.768129473193556*^9}, {
  3.768129971394211*^9, 
  3.7681299807064013`*^9}},ExpressionUUID->"f3b6adad-65a0-41a1-bec3-\
df54449a2bc0"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k1", "\[Rule]", 
      RowBox[{"n1", " ", "\[Gamma]"}]}], ",", 
     RowBox[{"k2", "\[Rule]", 
      RowBox[{"n2", " ", "\[Gamma]"}]}], ",", " ", 
     RowBox[{"k12", "\[Rule]", 
      RowBox[{"n12", " ", "\[Gamma]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"k", "\[Rule]", "173"}], ",", 
     RowBox[{"D1", "\[Rule]", "1.2"}], ",", 
     RowBox[{"D2", "\[Rule]", "3.7"}], ",", 
     RowBox[{"n1", "\[Rule]", "4.3"}], ",", 
     RowBox[{"n2", "\[Rule]", "2.15"}], ",", 
     RowBox[{"n12", "\[Rule]", "2.4"}], ",", 
     RowBox[{"M", "\[Rule]", "999"}], ",", 
     RowBox[{"dt", "\[Rule]", 
      RowBox[{"3", "/", "10"}]}], ",", 
     RowBox[{"alpha", "\[Rule]", "0"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t1", "=", " ", 
   RowBox[{"Eigensystem", "[", 
    RowBox[{
     RowBox[{"A", "/.", "kRules"}], "/.", "rules"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Lambda]sCust", "=", 
   RowBox[{"t1", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Um1Cust", "=", 
   RowBox[{"t1", "[", 
    RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"UCust", "=", 
    RowBox[{"Inverse", "[", "Um1Cust", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"termCust", "=", 
   RowBox[{"UCust", ".", 
    RowBox[{"DiagonalMatrix", "[", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"J", "[", "#", "]"}], "&"}], ",", "\[Lambda]sDummy"}], "]"}], 
     "]"}], ".", "Um1Cust", ".", 
    RowBox[{"b", "[", "i", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m3Cust", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"termCust", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ")"}], "//", 
   "MatrixForm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"m4Cust", "=", 
     RowBox[{"Join", "@@", 
      RowBox[{"Join", "[", 
       RowBox[{"m3Cust", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], ")"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"sigmaMatrixCust", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"Collect", "[", 
         RowBox[{
          RowBox[{"Expand", "[", 
           RowBox[{"m4Cust", "^", "2"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"J", "[", "_", "]"}], "}"}]}], "]"}], "/", "M"}], "/", 
       "dt"}]}], ")"}], "//", "MatrixForm"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalSigmaMatrix", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"sigmaMatrixCust", "/.", 
       RowBox[{
        RowBox[{"\[Lambda]", "[", "i_", "]"}], "\[RuleDelayed]", 
        RowBox[{"\[Lambda]sCust", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}]}], "/.", "JReImage"}], "/.", 
     "kRules"}], "/.", "rules"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"N", "[", "evalSigmaMatrix", "]"}], "//", "MatrixForm"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Mean periodogram: \>\"", ",", 
   RowBox[{"N", "[", 
    RowBox[{
     RowBox[{"2", "*", 
      RowBox[{"Total", "[", 
       RowBox[{"evalSigmaMatrix", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", " ", ";;"}], "]"}], "]"}], "]"}]}], ",", "10"}], 
    "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.76812949823409*^9, 3.7681297472163553`*^9}, {
   3.7681297849308414`*^9, 3.7681297970907674`*^9}, {3.768129830882536*^9, 
   3.768129851434882*^9}, {3.768129881799534*^9, 3.768129929483492*^9}, {
   3.7681299650110598`*^9, 3.768130009610244*^9}, {3.768130055909793*^9, 
   3.7681302255404096`*^9}, {3.768130256733979*^9, 3.7681302595567417`*^9}, {
   3.7681302945727353`*^9, 3.7681303894920254`*^9}, {3.7681304422610645`*^9, 
   3.768130442387829*^9}, 3.768130493967099*^9, {3.768130538228908*^9, 
   3.7681307085402627`*^9}, {3.768130750821249*^9, 3.768130751595811*^9}, {
   3.7681308689494762`*^9, 3.7681309565403695`*^9}, {3.7681328090098987`*^9, 
   3.7681328458959227`*^9}, {3.7681328876654058`*^9, 
   3.7681328963772087`*^9}, {3.768132936154365*^9, 3.7681329387365723`*^9}, {
   3.768134005620514*^9, 
   3.7681340255864286`*^9}},ExpressionUUID->"a324b7c3-59f9-4dd2-8674-\
9ea87129924e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Mean periodogram: \"\>", "\[InvisibleSpace]", 
   "0.09303405279400197`"}],
  SequenceForm["Mean periodogram: ", 0.09303405279400197],
  Editable->False]], "Print",
 CellChangeTimes->{{3.768130694038162*^9, 3.7681307089484816`*^9}, {
   3.768130743790801*^9, 3.768130753795727*^9}, 3.7681308265157294`*^9, {
   3.7681308702076426`*^9, 3.7681309036729927`*^9}, {3.7681309412597165`*^9, 
   3.768130957144249*^9}, 3.768132846257772*^9, {3.768132888516801*^9, 
   3.7681329021854267`*^9}, 3.7681329391877346`*^9, 3.7681336138268247`*^9, 
   3.768134029905411*^9},ExpressionUUID->"cf71ce51-b571-4cca-b760-\
84130f4971b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["b"], "Input",
 CellChangeTimes->{
  3.76813111717317*^9},ExpressionUUID->"42095ca3-5396-485b-9a4c-8d51433f2ab0"],

Cell[BoxData["b"], "Output",
 CellChangeTimes->{
  3.7681311175893755`*^9},ExpressionUUID->"cd33775a-9686-430f-8a84-\
375ba7d03163"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"termCust", "/.", 
   RowBox[{"i", "\[Rule]", "3"}]}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.768131157356073*^9, 
  3.768131169754058*^9}},ExpressionUUID->"f678d231-da11-4eb7-ba59-\
2bf92f3388a4"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox["D2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           FractionBox["1", "2"]}], " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}]}], ")"}]}]},
     {"0"},
     {
      RowBox[{
       SqrtBox["2"], " ", 
       SqrtBox["D2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "1", "]"}], "]"}]}], "+", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          RowBox[{"J", "[", 
           RowBox[{"\[Lambda]", "[", "3", "]"}], "]"}]}]}], ")"}]}]},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.768131162885786*^9, 
  3.7681311703830934`*^9}},ExpressionUUID->"c2789547-561a-4ea4-aa45-\
af4c3eff4415"]
}, Open  ]]
}, Open  ]],

Cell["test_max_search", "Subsection",
 CellChangeTimes->{{3.7794536032857847`*^9, 
  3.779453632327166*^9}},ExpressionUUID->"2cc2fa44-6f2d-432c-a3b2-\
32812d430b27"]
},
WindowSize->{1152, 912},
WindowMargins->{{0, Automatic}, {Automatic, 17}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 200, 4, 38, "Input", "ExpressionUUID" -> \
"9d4c7671-fbf8-45f2-a81d-a207f9da4bd0"],
Cell[CellGroupData[{
Cell[783, 28, 848, 17, 102, "Subsection", "ExpressionUUID" -> \
"c403f3ef-7faf-44f6-a097-94106449419a"],
Cell[CellGroupData[{
Cell[1656, 49, 6781, 184, 734, "Input", "ExpressionUUID" -> \
"692003ab-25d5-464e-ba05-1169df22d6e4"],
Cell[CellGroupData[{
Cell[8462, 237, 2216, 53, 108, "Print", "ExpressionUUID" -> \
"11c0e79f-fcdd-4b4e-943d-26370c219677"],
Cell[10681, 292, 2093, 49, 106, "Print", "ExpressionUUID" -> \
"58e51300-85fa-410a-b0ac-6b41ea24b73d"],
Cell[12777, 343, 2044, 47, 52, "Print", "ExpressionUUID" -> \
"42881934-683d-4c7b-9b03-f9d5c19d4ee3"],
Cell[14824, 392, 1539, 34, 82, "Print", "ExpressionUUID" -> \
"a4c43000-f176-4899-8fcf-c1c8333d162e"]
}, Open  ]]
}, Open  ]],
Cell[16390, 430, 1153, 35, 186, "Input", "ExpressionUUID" -> \
"71c718ee-96ef-494c-91ac-44f102c1bc70"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17580, 470, 876, 22, 110, "Subsection", "ExpressionUUID" -> \
"f4c8ed79-9269-4e49-a95c-28878b3d54c4"],
Cell[18459, 494, 1297, 33, 63, "Input", "ExpressionUUID" -> \
"5d46c902-7327-4d1e-b2b3-ed2651c9438f"],
Cell[CellGroupData[{
Cell[19781, 531, 370, 5, 50, "Subsubsection", "ExpressionUUID" -> \
"084cdd47-c409-4839-bbb5-abd2cb1df41b"],
Cell[20154, 538, 1067, 30, 67, "Input", "ExpressionUUID" -> \
"2c3b6f4c-0123-4b87-bbe1-adb5cb1e7039"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[21270, 574, 375, 10, 59, "Subsection", "ExpressionUUID" -> \
"3378f1e5-df0d-4487-b1d0-556b0fc821c5"],
Cell[CellGroupData[{
Cell[21670, 588, 449, 12, 38, "Input", "ExpressionUUID" -> \
"677a5d97-06b8-47b9-b8da-594df8343036"],
Cell[22122, 602, 3509, 97, 128, "Output", "ExpressionUUID" -> \
"fdc045b9-8964-4494-8b59-f2d23ed40b12"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25668, 704, 1381, 27, 87, "Input", "ExpressionUUID" -> \
"2b6e7235-81f0-4618-8c0f-cbe6f4a104a6"],
Cell[27052, 733, 3872, 100, 150, "Output", "ExpressionUUID" -> \
"105333ff-b11f-46bd-a708-38b784dd6dbb"],
Cell[30927, 835, 2799, 71, 128, "Output", "ExpressionUUID" -> \
"170e65e4-4402-4387-93c1-f39e40f576fb"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[33775, 912, 584, 10, 130, "Subsection", "ExpressionUUID" -> \
"43697787-028c-4222-bb5c-50c288ed15f6"],
Cell[CellGroupData[{
Cell[34384, 926, 5450, 143, 277, "Input", "ExpressionUUID" -> \
"f4e69a56-a35e-4e84-b1b8-7814a6d096db"],
Cell[39837, 1071, 4644, 126, 286, "Output", "ExpressionUUID" -> \
"577e78dc-d37f-40dd-ae8b-838ba14833f3"],
Cell[44484, 1199, 2655, 67, 147, "Output", "ExpressionUUID" -> \
"e0961a23-74fd-4761-9717-d6cc51e2f6a6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47188, 1272, 283, 6, 95, "Subsection", "ExpressionUUID" -> \
"691353b4-c4a9-4981-ad3a-602a17866240"],
Cell[CellGroupData[{
Cell[47496, 1282, 2643, 63, 157, "Input", "ExpressionUUID" -> \
"df0bebfe-d2f0-40e0-8a31-24d75ef7dab7"],
Cell[50142, 1347, 5196, 130, 153, "Output", "ExpressionUUID" -> \
"8e2f5f5c-d5a5-4ec9-8ab2-d490999e24ac"],
Cell[55341, 1479, 4741, 118, 163, "Output", "ExpressionUUID" -> \
"94d4b76a-343a-4c0c-b952-d43a43598282"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60119, 1602, 457, 13, 38, "Input", "ExpressionUUID" -> \
"c6697d6d-08e6-4e2b-8b94-bca2755ffa58"],
Cell[60579, 1617, 4289, 114, 191, "Output", "ExpressionUUID" -> \
"47584cca-78b0-402e-928f-3945c5617167"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64917, 1737, 195, 3, 59, "Subsection", "ExpressionUUID" -> \
"583675a4-f22d-4e8d-af27-c998ecaa074d"],
Cell[CellGroupData[{
Cell[65137, 1744, 1819, 45, 183, "Input", "ExpressionUUID" -> \
"5b6514b2-8315-406d-9c19-a076732aeafe"],
Cell[66959, 1791, 13970, 365, 156, "Output", "ExpressionUUID" -> \
"584104be-1729-44fb-9b87-5ce03f03bd6b"],
Cell[80932, 2158, 2926, 59, 643, "Output", "ExpressionUUID" -> \
"d9e2c25f-651a-40bf-8ba1-0b562bd4cbf4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[83907, 2223, 327, 7, 95, "Subsection", "ExpressionUUID" -> \
"bc5275f8-d656-4d8b-a2e2-ec6b61dbca61"],
Cell[CellGroupData[{
Cell[84259, 2234, 1642, 41, 135, "Input", "ExpressionUUID" -> \
"aa74b585-acbd-4e51-a2ee-bf2fb75518e6"],
Cell[85904, 2277, 2366, 64, 123, "Output", "ExpressionUUID" -> \
"0d3f6174-53f5-4ba0-a8be-5c8beef48bbd"],
Cell[88273, 2343, 1639, 42, 64, "Output", "ExpressionUUID" -> \
"fd72c407-91f2-4490-9d0f-668203192742"],
Cell[89915, 2387, 2869, 80, 245, "Output", "ExpressionUUID" -> \
"dc271ffb-d636-467c-875f-906db90dbc35"],
Cell[92787, 2469, 2617, 68, 90, "Output", "ExpressionUUID" -> \
"4c9b1007-58a1-4710-b2cf-42b6afb0f375"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[95453, 2543, 521, 13, 95, "Subsection", "ExpressionUUID" -> \
"7f40042e-5543-411c-b273-a87570d3d8d9"],
Cell[CellGroupData[{
Cell[95999, 2560, 650, 18, 63, "Input", "ExpressionUUID" -> \
"687a5a78-ca61-45c9-bef6-cc72e1ece1a3"],
Cell[96652, 2580, 1642, 47, 122, "Output", "ExpressionUUID" -> \
"e1c30409-5222-483a-96bf-8b79e22f5ff5"],
Cell[98297, 2629, 1212, 34, 85, "Output", "ExpressionUUID" -> \
"8dfa7541-7f36-4e00-a572-5342cf0c8c91"]
}, Open  ]],
Cell[99524, 2666, 156, 3, 38, "Input", "ExpressionUUID" -> \
"8d3d2fad-a588-47ab-9a6d-593800c666ab"],
Cell[CellGroupData[{
Cell[99705, 2673, 1353, 38, 120, "Input", "ExpressionUUID" -> \
"4fc0d548-7b9b-448c-8569-c640af68b959"],
Cell[101061, 2713, 762, 17, 38, "Output", "ExpressionUUID" -> \
"b1ef236f-1849-4e44-b5be-3fbf910cb11c"],
Cell[101826, 2732, 529, 9, 38, "Output", "ExpressionUUID" -> \
"61e9c9cf-cb17-4e80-9baa-34b2d2d313c9"],
Cell[102358, 2743, 816, 21, 57, "Output", "ExpressionUUID" -> \
"32e01fcc-f08b-4639-acff-cc50c5fa9a20"],
Cell[103177, 2766, 2241, 61, 118, "Output", "ExpressionUUID" -> \
"be4cc521-cebe-4353-97a6-102d09699c00"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105455, 2832, 640, 11, 38, "Input", "ExpressionUUID" -> \
"e954ed95-f3d0-4983-b8bf-7592501d337a"],
Cell[106098, 2845, 1615, 39, 64, "Output", "ExpressionUUID" -> \
"fef2a3f0-41e9-4282-9e6c-340f7c288697"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[107762, 2890, 253, 4, 59, "Subsection", "ExpressionUUID" -> \
"6bd0b9b0-2d90-4b01-bba3-eae716b98a30"],
Cell[CellGroupData[{
Cell[108040, 2898, 2329, 54, 120, "Input", "ExpressionUUID" -> \
"97672346-4e58-4574-a26c-85729cb729ee"],
Cell[110372, 2954, 1960, 45, 304, "Output", "ExpressionUUID" -> \
"8ed174c3-b77b-427b-a698-1d9645e71ac8"]
}, Open  ]],
Cell[112347, 3002, 354, 6, 231, "Input", "ExpressionUUID" -> \
"1f5d47f7-ab88-4325-9a7c-0525787c233d"]
}, Open  ]],
Cell[112716, 3011, 188, 3, 59, "Subsection", "ExpressionUUID" -> \
"9b3c5a6a-8501-44f9-837d-e6c0940acc02"],
Cell[CellGroupData[{
Cell[112929, 3018, 225, 4, 48, "Subsection", "ExpressionUUID" -> \
"2ae4e5da-2433-46fe-acad-bce5cd3d2035"],
Cell[CellGroupData[{
Cell[113179, 3026, 4002, 117, 337, "Input", "ExpressionUUID" -> \
"fad00946-c47e-4fd2-95bf-7f7c5b1ec8a7"],
Cell[117184, 3145, 1021, 16, 38, "Output", "ExpressionUUID" -> \
"eeb087ad-5897-4e7c-8d6e-6361df1e866d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118242, 3166, 268, 4, 50, "Subsubsection", "ExpressionUUID" -> \
"18167c23-9b13-45c2-8edd-c670146c7977"],
Cell[CellGroupData[{
Cell[118535, 3174, 4506, 132, 389, "Input", "ExpressionUUID" -> \
"e9a13f51-bfd5-4e68-b4f8-75313eb8c02c"],
Cell[123044, 3308, 274, 4, 38, "Output", "ExpressionUUID" -> \
"c7ed4bdc-ca0b-45c2-a983-c9531ba6c847"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123367, 3318, 269, 4, 50, "Subsubsection", "ExpressionUUID" -> \
"de1ba4d7-e96a-4f4f-9c37-19132697ab5d"],
Cell[CellGroupData[{
Cell[123661, 3326, 5668, 152, 404, "Input", "ExpressionUUID" -> \
"345d45b9-e7ed-4e8e-a908-ce436136b12d"],
Cell[129332, 3480, 352, 5, 38, "Output", "ExpressionUUID" -> \
"9a9c7413-c80d-4244-8ffc-a66b67853612"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[129745, 3492, 169, 3, 59, "Subsection", "ExpressionUUID" -> \
"66d8ff2c-93a1-4cc8-b8d3-152131f4badf"],
Cell[129917, 3497, 2274, 67, 236, "Input", "ExpressionUUID" -> \
"3387d635-84af-465d-b684-e40b39958c09"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132228, 3569, 214, 4, 59, "Subsection", "ExpressionUUID" -> \
"7b6e3e1b-f4e2-4ae4-81f4-12c4e70c290a"],
Cell[CellGroupData[{
Cell[132467, 3577, 317, 5, 50, "Subsubsection", "ExpressionUUID" -> \
"739b7964-a227-4d5b-b4e4-efd8bc9c856d"],
Cell[CellGroupData[{
Cell[132809, 3586, 5763, 146, 385, "Input", "ExpressionUUID" -> \
"831c409e-0de8-4e33-9a3c-ed9ea94d12c6"],
Cell[138575, 3734, 165, 4, 38, "Output", "ExpressionUUID" -> \
"86c39340-1a7c-4ba9-8d4b-802e2aca4de7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[138777, 3743, 578, 14, 63, "Input", "ExpressionUUID" -> \
"b2e339de-15c3-446e-a372-dce7d3c54ea5"],
Cell[139358, 3759, 219, 5, 38, "Output", "ExpressionUUID" -> \
"ae7d3e07-1e63-447f-88f5-6e53fb11e325"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139614, 3769, 836, 26, 42, "Input", "ExpressionUUID" -> \
"cf96d452-eef1-4287-9f98-5105eba7cc17"],
Cell[140453, 3797, 209, 4, 38, "Output", "ExpressionUUID" -> \
"377df5e0-b4c4-408c-8486-2d0206e8360a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140699, 3806, 1349, 34, 70, "Input", "ExpressionUUID" -> \
"4fac63f3-e076-471a-8d65-589515b28742"],
Cell[142051, 3842, 454, 11, 55, "Message", "ExpressionUUID" -> \
"c24d7286-182f-4d0c-87a1-b8fa80aec176"],
Cell[142508, 3855, 465, 11, 29, "Message", "ExpressionUUID" -> \
"936794c9-a4c6-4732-8206-05ed7d80cdd2"],
Cell[142976, 3868, 463, 11, 29, "Message", "ExpressionUUID" -> \
"f0616aef-981b-4196-b957-34e628a40c2f"],
Cell[143442, 3881, 454, 11, 55, "Message", "ExpressionUUID" -> \
"2b7090f5-1bb1-4274-b4be-42eca9de71fa"],
Cell[143899, 3894, 465, 11, 29, "Message", "ExpressionUUID" -> \
"de2c8052-4821-43ab-99cc-77db915df091"],
Cell[144367, 3907, 507, 11, 29, "Message", "ExpressionUUID" -> \
"87290a08-fdb2-4594-b4f8-512172c831e0"],
Cell[144877, 3920, 454, 11, 55, "Message", "ExpressionUUID" -> \
"37945813-c63d-4b6e-86bf-65926075fd4b"],
Cell[145334, 3933, 500, 11, 29, "Message", "ExpressionUUID" -> \
"a2165b45-87cb-4f8b-87c0-35f67c8c1f17"],
Cell[145837, 3946, 1052, 20, 102, "Message", "ExpressionUUID" -> \
"fae46a5b-86d5-4cf5-9a23-2bf502da3aac"],
Cell[146892, 3968, 1350, 35, 159, "Output", "ExpressionUUID" -> \
"69008c67-e2e1-4c5b-97f5-697cc984597a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148279, 4008, 420, 12, 38, "Input", "ExpressionUUID" -> \
"2472f5df-904d-42de-8cd4-731844527e57"],
Cell[148702, 4022, 239, 5, 38, "Output", "ExpressionUUID" -> \
"3ec7300a-4b0a-4f9d-aacb-d51ace284ef6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148978, 4032, 168, 3, 38, "Input", "ExpressionUUID" -> \
"2bb48ae5-b036-4941-8a65-005bb93cc01b"],
Cell[149149, 4037, 170, 3, 38, "Output", "ExpressionUUID" -> \
"59cee849-ba90-4fef-8119-50e8a4e169f2"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[149380, 4047, 243, 4, 59, "Subsection", "ExpressionUUID" -> \
"96399f42-24a7-4214-8cd1-c60d3d4948ea"],
Cell[CellGroupData[{
Cell[149648, 4055, 4627, 127, 423, "Input", "ExpressionUUID" -> \
"d26d0649-952e-4652-a5be-14790e86e005"],
Cell[154278, 4184, 666, 12, 28, "Print", "ExpressionUUID" -> \
"483fecfd-cb78-4bff-89f5-852b7309208c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154981, 4201, 126, 2, 38, "Input", "ExpressionUUID" -> \
"936c2e03-12a0-4e1e-b999-636db0d9cb26"],
Cell[155110, 4205, 132, 3, 38, "Output", "ExpressionUUID" -> \
"e51a0ea9-8e4a-44ff-ba04-68d05bf0cdc3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[155279, 4213, 246, 6, 38, "Input", "ExpressionUUID" -> \
"499075e7-6653-4788-a24f-8df6e916b028"],
Cell[155528, 4221, 1572, 49, 122, "Output", "ExpressionUUID" -> \
"c6b97be3-1e3a-486d-bf91-3ee91e96a03d"]
}, Open  ]]
}, Open  ]],
Cell[157127, 4274, 165, 3, 59, "Subsection", "ExpressionUUID" -> \
"e6b59577-5e31-431c-9b60-a92c4c3edc87"]
}
]
*)

