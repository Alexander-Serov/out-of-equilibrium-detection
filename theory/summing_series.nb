(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    376788,      11233]
NotebookOptionsPosition[    353498,      10675]
NotebookOutlinePosition[    353845,      10690]
CellTagsIndexPosition[    353802,      10687]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", "\[Lambda]1"}]}], ")"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"n", "-", "m"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k"}], "N0"], 
         "-", 
         RowBox[{"dt", " ", "\[Lambda]2"}]}], ")"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", 
       RowBox[{"n", "+", "1"}], ",", 
       RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"%", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"n", "-", "m"}], ")"}]}], "N0"], "+", 
       RowBox[{"dt", " ", "\[Lambda]1", " ", 
        RowBox[{"(", 
         RowBox[{"N0", "-", "1", "-", "m"}], ")"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r1", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"%", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"k", "\[Element]", "Integers"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"r1", ",", "N0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoefficientList", "[", 
    RowBox[{"%", ",", "N0"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.764408824785906*^9, 3.76440885669695*^9}, {
   3.7644109598486986`*^9, 3.764410968298408*^9}, {3.7644110544585943`*^9, 
   3.764411089882513*^9}, {3.7644111283477163`*^9, 3.7644111539537053`*^9}, {
   3.7644112096756372`*^9, 3.7644112103697443`*^9}, {3.7644129957456923`*^9, 
   3.764413016377674*^9}, {3.7644130526267815`*^9, 3.7644131033547387`*^9}, {
   3.7644132565068417`*^9, 3.764413257041832*^9}, {3.7644138195221467`*^9, 
   3.7644138611980886`*^9}, {3.7644138983479123`*^9, 3.76441390261195*^9}, {
   3.7644143864830623`*^9, 3.76441442996212*^9}, 3.7644175129468417`*^9, {
   3.764417560788733*^9, 3.764417583453906*^9}, {3.764417798390068*^9, 
   3.764417799268071*^9}, {3.764480980663484*^9, 
   3.7644811079818287`*^9}},ExpressionUUID->"dca4d28d-57d5-4894-9514-\
37b4b0fbbe1e"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", "\[Lambda]1"}]}]]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
       "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"dt", " ", "\[Lambda]2"}]]}], ")"}], "2"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", "N0", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}]}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", "N0", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}]}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       RowBox[{"-", "dt"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"dt", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}], "+", 
         RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", "\[Lambda]2"}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"2", " ", "dt", " ", "\[Lambda]1"}], "+", 
       RowBox[{"dt", " ", "\[Lambda]2"}]}]], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", "N0", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}], "+", 
       RowBox[{"2", " ", "dt", " ", "\[Lambda]2"}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]]}], 
     "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
       RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]]}], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "-", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"4", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "+", 
          RowBox[{"N0", " ", "\[Lambda]1"}], "-", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "+", 
          RowBox[{"2", " ", "\[Lambda]2"}], "-", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "+", 
          RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
          RowBox[{"2", " ", "\[Lambda]2"}], "-", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], 
      " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N0"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N0"}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N0"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"2", " ", "dt", " ", "\[Lambda]1"}], "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], 
      " ", "N0"}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], " ", "N0"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"2", " ", "\[Lambda]2"}], "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], " ", "N0"}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.7644811451217957`*^9, 
  3.7650015669469733`*^9},ExpressionUUID->"68816de7-f78f-42e4-a54d-\
95a4fc8c0aa3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"],
           "+", 
          RowBox[{"dt", " ", "\[Lambda]1"}]}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]],
         "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"dt", " ", "\[Lambda]2"}]]}], ")"}], "2"]}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        RowBox[{"-", "dt"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"N0", " ", 
           RowBox[{"(", 
            RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}], "+", 
          RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"2", " ", "dt", " ", "\[Lambda]1"}], "+", 
        RowBox[{"dt", " ", "\[Lambda]2"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", "\[Lambda]2"}], ")"}]}], "+", 
        RowBox[{"2", " ", "dt", " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], 
      "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]]}], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"3", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "-", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "-", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "-", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"2", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"2", " ", "\[Lambda]2"}], "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
           RowBox[{"2", " ", "\[Lambda]2"}], "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], ")"}]}]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"2", " ", "dt", " ", "\[Lambda]1"}], "-", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]]}], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "-", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"2", " ", "\[Lambda]2"}], "-", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]]}], ")"}], " ", 
    "N0"}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", "\[Lambda]1"}]}]]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
       "-", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"dt", " ", "\[Lambda]2"}]]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7644811451217957`*^9, 
  3.7650015671558523`*^9},ExpressionUUID->"07849500-6b1e-407b-a818-\
697541e5f37d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"dt", " ", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
       "+", 
       RowBox[{"dt", " ", "\[Lambda]1"}]}]]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
     "-", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"dt", " ", "\[Lambda]2"}]]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.7644811451217957`*^9, 
  3.7650015675296183`*^9},ExpressionUUID->"580ac88d-dc43-4191-8497-\
bb5ba0046496"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.7644965245011687`*^9},ExpressionUUID->"b2c2c9f0-5102-4903-89c5-\
8dc9a2a53292"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Exp", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
       "n"}], "N0"], "]"}], "n"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", 
     RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7645694808709517`*^9, 
  3.764569540177122*^9}},ExpressionUUID->"339f6084-0a89-4246-82dc-\
cc587b941c77"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
      "+", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]}]], 
    " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}]], "-", 
      "N0", "+", 
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
       " ", "N0"}]}], ")"}]}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], "2"]]}]], "Output",
 CellChangeTimes->{{3.7645695054539227`*^9, 3.764569540830748*^9}, 
   3.765001567742498*^9},ExpressionUUID->"42e6bc26-fc44-41be-b427-\
021fd815472c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], " ",
    "N0"}], 
  RowBox[{"1", "-", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
     "N0"]]}]]], "Output",
 CellChangeTimes->{{3.7645695054539227`*^9, 3.764569540830748*^9}, 
   3.7650015677465143`*^9},ExpressionUUID->"a73310ab-32bd-40c2-887b-\
36f922d88d2a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Sum", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "m"}], "}"}]}], "]"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.7646666916774263`*^9, 3.764666731614582*^9}, {
   3.7646667723582773`*^9, 3.7646667909771614`*^9}, 
   3.7646690831753025`*^9},ExpressionUUID->"fad89883-d920-4daf-8de6-\
fa0a1bce06d7"],

Cell[CellGroupData[{

Cell["Sum for different k and l. The general case.", "Subsection",
 CellChangeTimes->{{3.7650063341651783`*^9, 
  3.765006345557659*^9}},ExpressionUUID->"96fcbbb9-1acf-4ca5-8f8f-\
3b6eafd3a089"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"s", "=", 
     RowBox[{
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l", " ", "m"}], " ", "-", " ", 
              RowBox[{"k", " ", "n"}]}], ")"}]}], "N0"], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[Lambda]1", " ", "dt", 
             RowBox[{"(", 
              RowBox[{"n", "-", "m"}], ")"}]}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"dt", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Lambda]1", " ", "n"}], " ", "+", " ", 
               RowBox[{"\[Lambda]2", " ", "m"}]}], ")"}]}], "]"}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"l", " ", "m"}], " ", "-", " ", 
              RowBox[{"k", " ", "n"}]}], ")"}]}], "N0"], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[Lambda]2", " ", "dt", 
             RowBox[{"(", 
              RowBox[{"m", "-", "n"}], ")"}]}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"dt", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Lambda]1", " ", "n"}], " ", "+", " ", 
               RowBox[{"\[Lambda]2", " ", "m"}]}], ")"}]}], "]"}]}], ")"}]}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"m", ",", 
          RowBox[{"n", "+", "1"}], ",", 
          RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{"s", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Exp", "[", 
         FractionBox[
          RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"l", " ", "m"}], " ", "+", " ", "k"}], ")"}]}], "N0"], 
         "]"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[Lambda]1", " ", "dt", 
            RowBox[{"(", 
             RowBox[{"N0", "-", "1", "-", "m"}], ")"}]}], "]"}], "-", 
          RowBox[{"Exp", "[", 
           RowBox[{"dt", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Lambda]1", " ", 
               RowBox[{"(", 
                RowBox[{"N0", "-", "1"}], ")"}]}], " ", "+", " ", 
              RowBox[{"\[Lambda]2", " ", "m"}]}], ")"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0", ",", 
         RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"r1", "=", 
     RowBox[{"Simplify", "[", 
      RowBox[{"%", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"k", "\[Element]", "Integers"}], ",", 
          RowBox[{"l", "\[Element]", "Integers"}]}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"Collect", "[", 
    RowBox[{"r1", ",", "N0"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"%", ",", "N0", ",", "1"}], "]"}], "N0"}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Limit", "[", 
     RowBox[{"r1", ",", 
      RowBox[{"l", "\[Rule]", "k"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7646658235387206`*^9, 3.764666032414304*^9}, {
   3.764666065517371*^9, 3.764666089685546*^9}, {3.7646661227166696`*^9, 
   3.764666160836913*^9}, {3.764666256500704*^9, 3.7646662647725267`*^9}, {
   3.7646663907419806`*^9, 3.7646663967145643`*^9}, {3.7646665516169634`*^9, 
   3.764666612725584*^9}, 3.7646666895006704`*^9, {3.7646667566932383`*^9, 
   3.7646667581564007`*^9}, 3.76466680288535*^9, {3.7646668772238293`*^9, 
   3.7646668844866753`*^9}, {3.7646669459575577`*^9, 3.7646669565405045`*^9}, 
   3.7646688143180456`*^9, {3.764669085869761*^9, 3.764669086383467*^9}, {
   3.765001782141924*^9, 3.7650017890549717`*^9}, {3.7650066578720493`*^9, 
   3.765006660446591*^9}},ExpressionUUID->"7293cdf8-011a-40fd-a637-\
c49ca2a3fb22"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
      "-", 
      RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{
          RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
          RowBox[{"dt", " ", 
           SuperscriptBox["N0", "2"], " ", "\[Lambda]2"}]}], "N0"]]}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", 
          SuperscriptBox["N0", "2"], " ", "\[Lambda]2"}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "dt", " ", 
          SuperscriptBox["N0", "2"], " ", "\[Lambda]2"}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "dt", " ", 
          SuperscriptBox["N0", "2"], " ", "\[Lambda]2"}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"3", " ", "dt", " ", "\[Lambda]1"}], "+", 
        RowBox[{"2", " ", "dt", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"2", " ", "dt", " ", "\[Lambda]1"}], "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]]}], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"3", " ", "dt", " ", "\[Lambda]1"}], "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", 
          SuperscriptBox["N0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", 
          SuperscriptBox["N0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "N0"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "N0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "N0"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", "N0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", 
          SuperscriptBox["N0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", 
          SuperscriptBox["N0", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "N0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "N0"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"2", " ", "dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
           RowBox[{"dt", " ", "N0", " ", 
            RowBox[{"(", 
             RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
              RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}], ")"}]}], "N0"]],
       "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
            RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
           "\[Lambda]2", "+", 
           RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            "\[Lambda]2", "+", 
            RowBox[{"2", " ", "N0", " ", "\[Lambda]2"}]}], ")"}]}]}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "\[Lambda]1"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Lambda]1"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", "N0"}], ")"}], " ", "\[Lambda]2"}]}], 
           ")"}]}]}], "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", 
            RowBox[{"N0", " ", 
             RowBox[{"(", 
              RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], ")"}]}]}],
         "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", 
            RowBox[{"N0", " ", 
             RowBox[{"(", 
              RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], ")"}]}]}],
         "N0"]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", 
            RowBox[{"N0", " ", 
             RowBox[{"(", 
              RowBox[{"\[Lambda]1", "+", 
               RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], ")"}]}]}], 
        "N0"]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "+", 
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "+", 
         RowBox[{"dt", " ", "N0", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]2", "+", 
            RowBox[{"N0", " ", 
             RowBox[{"(", 
              RowBox[{"\[Lambda]1", "+", 
               RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}], ")"}]}]}], 
        "N0"]]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", "\[Lambda]1"}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", "\[Lambda]1"}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "\[Lambda]2"}]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "\[Lambda]2"}]}]]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.764666117863429*^9, 3.764666129495792*^9}, 
   3.7646662167859116`*^9, 3.7646663386137967`*^9, 3.7646664448850117`*^9, 
   3.7646665664279976`*^9, 3.7646666051689067`*^9, 3.7646666678610477`*^9, 
   3.764666804564391*^9, 3.7646669177906713`*^9, {3.764666957008237*^9, 
   3.764666965775223*^9}, {3.764668468685232*^9, 3.764668469016043*^9}, 
   3.7646688167566504`*^9, 3.7646691119878225`*^9, 3.7650015948299985`*^9, 
   3.7650018062031593`*^9, 
   3.765006676740268*^9},ExpressionUUID->"8c60258a-b0a0-45ad-b192-\
1976e0695e3f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.764666117863429*^9, 3.764666129495792*^9}, 
   3.7646662167859116`*^9, 3.7646663386137967`*^9, 3.7646664448850117`*^9, 
   3.7646665664279976`*^9, 3.7646666051689067`*^9, 3.7646666678610477`*^9, 
   3.764666804564391*^9, 3.7646669177906713`*^9, {3.764666957008237*^9, 
   3.764666965775223*^9}, {3.764668468685232*^9, 3.764668469016043*^9}, 
   3.7646688167566504`*^9, 3.7646691119878225`*^9, 3.7650015948299985`*^9, 
   3.7650018062031593`*^9, 
   3.7650066767912397`*^9},ExpressionUUID->"636154cb-eb42-4ddb-84e0-\
6a661504a7a3"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]],
         "-", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"dt", " ", "\[Lambda]1"}]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"],
           "+", 
          RowBox[{"dt", " ", "\[Lambda]2"}]}]]}], ")"}], "2"]}]], 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]1"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2"}], ")"}]}]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]1"}], "+", 
        RowBox[{"dt", " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "\[Lambda]1"}], "+", 
        RowBox[{"2", " ", "dt", " ", "\[Lambda]2"}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "+", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]1", "+", 
          RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"dt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "\[Lambda]1"}], "+", "\[Lambda]2", "+", 
          RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", "\[Lambda]2"}]}]], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
         "+", 
         RowBox[{"dt", " ", 
          RowBox[{"(", 
           RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]]}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", "N0", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "N0"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", "\[Lambda]2"}], ")"}]}]}]],
       "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", 
           RowBox[{"N0", " ", "\[Lambda]1"}], "+", 
           RowBox[{"2", " ", "\[Lambda]2"}]}], ")"}]}]}]], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]1", "+", "\[Lambda]2", "+", 
           RowBox[{"N0", " ", "\[Lambda]2"}]}], ")"}]}]}]], "-", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"], 
        "+", 
        RowBox[{"dt", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]2", "+", 
           RowBox[{"N0", " ", 
            RowBox[{"(", 
             RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}]}], 
          ")"}]}]}]]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.764666117863429*^9, 3.764666129495792*^9}, 
   3.7646662167859116`*^9, 3.7646663386137967`*^9, 3.7646664448850117`*^9, 
   3.7646665664279976`*^9, 3.7646666051689067`*^9, 3.7646666678610477`*^9, 
   3.764666804564391*^9, 3.7646669177906713`*^9, {3.764666957008237*^9, 
   3.764666965775223*^9}, {3.764668468685232*^9, 3.764668469016043*^9}, 
   3.7646688167566504`*^9, 3.7646691119878225`*^9, 3.7650015948299985`*^9, 
   3.7650018062031593`*^9, 
   3.76500667717502*^9},ExpressionUUID->"53a06714-9d50-4e17-86c9-\
40ac20c5baf5"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check the limit of \[Lambda]1,\[Lambda]2=0", "Subsection",
 CellChangeTimes->{{3.764667653516843*^9, 
  3.7646676599976687`*^9}},ExpressionUUID->"059d54ad-da05-4b41-a580-\
ee7195deb974"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"r1", "/", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}], ",", 
     RowBox[{"\[Lambda]1", "\[Rule]", "0"}]}], "]"}], ",", 
   RowBox[{"\[Lambda]2", "\[Rule]", "0"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     RowBox[{"r1", "/", 
      RowBox[{"(", 
       RowBox[{"\[Lambda]1", "+", "\[Lambda]2"}], ")"}]}], ",", 
     RowBox[{"\[Lambda]2", "\[Rule]", "0"}]}], "]"}], ",", 
   RowBox[{"\[Lambda]1", "\[Rule]", "0"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7646676667128277`*^9, 3.7646677453894053`*^9}, {
  3.7646679388777337`*^9, 
  3.7646679455324326`*^9}},ExpressionUUID->"e438a462-12b6-4fe1-9db2-\
17ee8c5659b3"],

Cell[BoxData[
 FractionBox[
  RowBox[{"dt", " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], " ",
    "N0"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.7646676775806446`*^9, 3.764667748375697*^9, 
  3.7646679459372015`*^9, 3.7646684691709547`*^9, 
  3.7650015963511477`*^9},ExpressionUUID->"afa9b233-eb19-4ae3-9579-\
502ac9e93026"],

Cell[BoxData[
 FractionBox[
  RowBox[{"dt", " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], " ",
    "N0"}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{3.7646676775806446`*^9, 3.764667748375697*^9, 
  3.7646679459372015`*^9, 3.7646684691709547`*^9, 
  3.7650015972446384`*^9},ExpressionUUID->"ec3477ee-d295-4316-87a0-\
707519055e64"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Same for \[Lambda]1=\[Lambda]2=0", "Subsection",
 CellChangeTimes->{{3.7646687192928896`*^9, 
  3.764668724237062*^9}},ExpressionUUID->"5ba8377d-7d6b-47bf-a00a-\
818aaba0c48a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l", " ", "m"}], " ", "-", " ", 
            RowBox[{"k", " ", "n"}]}], ")"}]}], "N0"], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Exp", "[", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"l", " ", "m"}], " ", "-", " ", 
            RowBox[{"k", " ", "n"}]}], ")"}]}], "N0"], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"l", " ", "m"}], " ", "+", " ", "k"}], ")"}]}], "N0"], 
       "]"}], "m"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{"%", ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k", "\[Element]", "Integers"}], ",", 
        RowBox[{"l", "\[Element]", "Integers"}]}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"r1", ",", "N0"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"%", ",", "N0", ",", "1"}], "]"}], "N0"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.764668744252613*^9, 
  3.7646688085583396`*^9}},ExpressionUUID->"2c3659f6-1370-4edd-8612-\
9a3a260bcd3e"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", "N0"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.7646687992856436`*^9, 3.764668809949544*^9}, 
   3.7650015984659667`*^9},ExpressionUUID->"9faaf13f-ad15-4f73-9d45-\
243ebd36cc8a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", "N0"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.7646687992856436`*^9, 3.764668809949544*^9}, 
   3.7650015984699864`*^9},ExpressionUUID->"d0d5057d-5069-4a19-bd73-\
74adfe946680"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              FractionBox[
               RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
               "N0"]], " ", "N0"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
                 "N0"]]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SuperscriptBox["\[ExponentialE]", 
                FractionBox[
                 RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
                 "N0"]]}], ")"}]}]]}], "/.", 
          RowBox[{"\[Pi]", "\[Rule]", 
           RowBox[{"-", "\[Pi]"}]}]}], ")"}], "/.", 
        RowBox[{"k", "\[Rule]", "k1"}]}], ")"}], "/.", 
      RowBox[{"l", "\[Rule]", "k"}]}], ")"}], "/.", 
    RowBox[{"k1", "\[Rule]", "l"}]}], ")"}], "-", 
  RowBox[{"(", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      " ", "N0"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "N0"]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
          "N0"]]}], ")"}]}]]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7646694218456054`*^9, 3.7646694972730255`*^9}, {
  3.764669633813962*^9, 3.7646697042962637`*^9}, {3.7646701287105074`*^9, 
  3.7646701396852303`*^9}},ExpressionUUID->"63858b41-701c-4c48-8ebd-\
19d239851cad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]}]],
      " ", "N0"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "N0"]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
          "N0"]}]]}], ")"}]}]]}], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", "N0"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.764669446828879*^9, 3.76466949778973*^9}, {
   3.7646696401988416`*^9, 3.764669704814967*^9}, 3.764670141760043*^9, 
   3.7650015985529394`*^9},ExpressionUUID->"00c5ec5a-f1c8-45bc-aacb-\
60e986545ce8"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.764669446828879*^9, 3.76466949778973*^9}, {
   3.7646696401988416`*^9, 3.764669704814967*^9}, 3.764670141760043*^9, 
   3.7650015985579357`*^9},ExpressionUUID->"56ff22f3-e156-43b7-b622-\
111c9922e56c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
       " ", "N0"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
           "N0"]]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
           "N0"]]}], ")"}]}]]}], "/.", 
    RowBox[{"\[Pi]", "\[Rule]", 
     RowBox[{"-", "\[Pi]"}]}]}], ")"}], "+", 
  RowBox[{"(", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      " ", "N0"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "N0"]]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
          "N0"]]}], ")"}]}]]}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.76466951209155*^9, 3.7646695364051485`*^9}, {
  3.7646700100203953`*^9, 
  3.7646700223003716`*^9}},ExpressionUUID->"07bb340e-8f35-4136-9711-\
a61c0ba940c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]}]],
      " ", "N0"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "N0"]}]]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], 
          "N0"]}]]}], ")"}]}]]}], "-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", "N0"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.7646695206211767`*^9, 3.7646695368898706`*^9}, 
   3.7646700238964586`*^9, 
   3.765001598591921*^9},ExpressionUUID->"dc62b412-e449-464b-8304-\
3477e9a38b50"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
      "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", "N0"}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "l", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.7646695206211767`*^9, 3.7646695368898706`*^9}, 
   3.7646700238964586`*^9, 
   3.765001598597937*^9},ExpressionUUID->"57220b4c-b0eb-423d-aaf1-\
5ecda0da9c9d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking if necessary to separate the N-1 tem", "Subsection",
 CellChangeTimes->{{3.765015835733922*^9, 
  3.7650158461099854`*^9}},ExpressionUUID->"002ecf63-5fa7-4eec-979e-\
a863db239998"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"cL", "/", "c1"}]}], ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", " ", "ck"}], ")"}], 
          RowBox[{"N0", "-", "1"}]]}], 
        RowBox[{"1", "-", 
         RowBox[{"c1", " ", "ck"}]}]], "-", 
       RowBox[{
        FractionBox["cL", "c1"], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"cL", " ", "ck"}]}]]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", " ", "ck"}], ")"}], 
         RowBox[{"N0", "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", "/", "c1"}], ")"}], "N0"]}], ")"}]}]}], ")"}]}], 
    "+", "\[IndentingNewLine]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"cL", " ", "c2"}]}], ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c2", " ", "cL"}], ")"}], "N0"], "-", "1"}], ")"}], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c1", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"c1", " ", "ck"}]}]]}], "+", 
       RowBox[{"cL", " ", "c2", 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"cL", " ", "ck"}]}]]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cL", " ", "c2"}], ")"}], "N0"], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"ck", "/", "c2"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"ck", "/", "c2"}]}]]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c1", " ", "ck"}], ")"}], 
         RowBox[{"N0", "-", "1"}]], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", " ", "c2"}], ")"}], "N0"]}], ")"}]}]}], ")"}]}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"cL", "/", "c1"}]}], ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", " ", "ck"}], ")"}], 
          RowBox[{"N0", "-", "1"}]]}], 
        RowBox[{"1", "-", 
         RowBox[{"c1", " ", "ck"}]}]], "-", 
       RowBox[{
        FractionBox["cL", "c1"], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"cL", " ", "ck"}]}]]}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"cL", " ", "c2"}]}], ")"}], 
      RowBox[{"-", "1"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c2", " ", "cL"}], ")"}], "N0"], "-", "1"}], ")"}], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c1", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"c1", " ", "ck"}]}]]}], "+", 
       RowBox[{"cL", " ", "c2", 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"cL", " ", "ck"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"cL", " ", "ck"}]}]]}], "-", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"cL", " ", "c2"}], ")"}], "N0"], 
        FractionBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"ck", "/", "c2"}], ")"}], 
           RowBox[{"N0", "-", "1"}]]}], 
         RowBox[{"1", "-", 
          RowBox[{"ck", "/", "c2"}]}]]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f1", "-", "f2"}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7650158513100314`*^9, 3.765016004263888*^9}, {
   3.7650162697900743`*^9, 3.765016564876878*^9}, 
   3.76502067355818*^9},ExpressionUUID->"c1e51659-6b51-48d3-a701-\
676f2b60ef5a"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "ck"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "+", "N0"}]], " ", 
    RowBox[{"(", 
     RowBox[{"cL", "-", 
      RowBox[{"c1", " ", "c2", " ", "cL"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"c2", " ", "cL"}], ")"}], "N0"]}], "-", 
      RowBox[{"cL", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"c2", " ", "cL"}], ")"}], "N0"]}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["cL", "c1"], ")"}], "N0"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"c2", " ", "cL"}]}], ")"}]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", "cL"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c2", " ", "cL"}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.7650165402919445`*^9, 3.7650165677972293`*^9}, 
   3.7650206747335386`*^9},ExpressionUUID->"08940d9a-b853-4502-9f50-\
7d251a185645"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"f1", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7650208063643265`*^9, 
  3.7650208092097473`*^9}},ExpressionUUID->"7d731b1b-9e26-48f8-b931-\
e10e23352560"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Another", "Subsection",
 CellChangeTimes->{{3.765102571938967*^9, 
  3.7651025726824617`*^9}},ExpressionUUID->"c04d8881-cca8-453a-9566-\
331f977a9f0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["ck", "c1"], ")"}], 
     RowBox[{"-", "n"}]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"1", "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ck", "/", "c1"}], ")"}], 
         RowBox[{"n", "+", "1"}]]}], 
       RowBox[{"1", "-", 
        RowBox[{"ck", "/", "c1"}]}]], "+", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", 
        RowBox[{"1", "-", 
         RowBox[{"c2", " ", "ck"}]}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"c2", " ", "ck"}], ")"}], 
             RowBox[{"n", "+", "1"}]]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"c2", " ", "ck"}], ")"}], "N0"], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"c1", " ", "c2"}], ")"}], 
             RowBox[{"-", "n"}]], "-", "1"}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"c2", " ", "ck"}], ")"}], 
             RowBox[{"n", "+", "1", "-", "N0"}]], "-", "1"}], ")"}]}]}], 
        ")"}]}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"s2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sum", "[", 
      RowBox[{"s1", ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "0", ",", 
         RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["ck", 
         RowBox[{"m", "-", "N0", "+", "1"}]], 
        SuperscriptBox["c1", 
         RowBox[{"N0", "-", "1"}]], 
        SuperscriptBox["c2", "m"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["c1", 
            RowBox[{"-", "m"}]], 
           SuperscriptBox["c2", 
            RowBox[{"-", "m"}]]}], "-", "1"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "0", ",", 
         RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", ">", "0"}], ",", 
       RowBox[{"c2", ">", "0"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7651025761007786`*^9, 3.765102676379942*^9}, {
   3.765102713972386*^9, 3.7651028063592043`*^9}, {3.7651028476913157`*^9, 
   3.7651028611467094`*^9}, {3.76510291495852*^9, 3.7651029164664326`*^9}, {
   3.7651029597792654`*^9, 3.765102964379463*^9}, {3.7651030505566072`*^9, 
   3.765103063860999*^9}, 3.765103112747284*^9, {3.7651032072359047`*^9, 
   3.765103209412635*^9}},ExpressionUUID->"efc22d12-53d7-4175-a435-\
d1e27b6b35f1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", "ck"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c2", " ", "ck"}]}], ")"}], "2"]}]], 
  RowBox[{
   SuperscriptBox["c2", 
    RowBox[{"-", "N0"}]], " ", 
   SuperscriptBox["ck", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "N0"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"c1", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c1", " ", "c2", " ", "ck"}], ")"}], "N0"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c2", "2"], " ", 
         SuperscriptBox["ck", "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", "c2", " ", 
      SuperscriptBox["ck", "N0"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"c2", " ", "ck"}], ")"}], "N0"], "+", "N0", "-", 
        RowBox[{"c2", " ", "ck", " ", "N0"}]}], ")"}]}], "-", 
     RowBox[{"c1", " ", 
      SuperscriptBox["ck", "N0"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c2", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "N0"}]}]], " ", "ck", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c1", " ", "ck"}], ")"}], "N0"]}], "+", 
        RowBox[{"c2", " ", "ck", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1", " ", "c2"}], ")"}], "N0"], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c2", " ", "ck"}], ")"}], 
            RowBox[{"2", " ", "N0"}]]}], ")"}]}], "-", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c2", " ", "ck"}], ")"}], 
          RowBox[{"2", "+", "N0"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "N0"}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"c2", " ", "ck"}], ")"}], "N0"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c2", " ", "ck"}], ")"}], "N0"], "+", "N0"}], ")"}]}]}], 
       ")"}]}], "+", 
     RowBox[{"ck", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["c1", "N0"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"c2", " ", "ck"}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["ck", "N0"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "-", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c1", " ", "c2"}], ")"}], "N0"], "+", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"c2", " ", "ck"}], ")"}], "N0"], "+", 
           RowBox[{"c2", " ", "ck", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"c1", " ", "c2"}], ")"}], "N0"], "-", "N0"}], ")"}]}],
            "+", "N0"}], ")"}]}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7651028386227207`*^9, 3.765102900956502*^9, 
  3.7651029310007153`*^9, 3.7651030082679334`*^9, 3.76510308046653*^9, 
  3.765103116030896*^9, 
  3.7651032149306703`*^9},ExpressionUUID->"62b98cc6-1200-4c93-b9fd-\
3552f13f681e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"s2", ",", "N0", ",", "1"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{"s2", ",", "N0", ",", "1"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c1", ">", "0"}], ",", 
        RowBox[{"c2", ">", "0"}]}], "}"}]}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7651029715946064`*^9, 3.7651030290192356`*^9}, {
  3.765103085176852*^9, 3.765103088465687*^9}, {3.765103130034903*^9, 
  3.7651031832665434`*^9}},ExpressionUUID->"8eeab739-11df-47b8-bb5a-\
32521bc4421d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["c2", 
    RowBox[{"-", "N0"}]], " ", 
   SuperscriptBox["ck", 
    RowBox[{"1", "-", 
     RowBox[{"2", " ", "N0"}]}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "c1"}], " ", 
      SuperscriptBox["ck", "N0"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "+", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", "c2", " ", 
      SuperscriptBox["ck", "N0"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "+", 
     RowBox[{
      SuperscriptBox["ck", 
       RowBox[{"1", "+", "N0"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "-", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", 
      SuperscriptBox["c2", "2"], " ", 
      SuperscriptBox["ck", 
       RowBox[{"1", "+", "N0"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "-", 
     RowBox[{"c2", " ", 
      SuperscriptBox["ck", 
       RowBox[{"2", "+", "N0"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}], "+", 
     RowBox[{"c1", " ", 
      SuperscriptBox["c2", "2"], " ", 
      SuperscriptBox["ck", 
       RowBox[{"2", "+", "N0"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"c2", " ", "ck"}], ")"}], "N0"]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", "ck"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c2", " ", "ck"}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{{3.7651030088887835`*^9, 3.7651030296258383`*^9}, 
   3.7651030889293966`*^9, {3.765103121726637*^9, 3.765103139428638*^9}, {
   3.76510317456308*^9, 3.7651031836002474`*^9}, 
   3.7651032150124965`*^9},ExpressionUUID->"bc5914ae-20df-429a-94eb-\
a81b543527bc"],

Cell[BoxData[
 RowBox[{
  FractionBox["c1", 
   RowBox[{
    RowBox[{"-", "c1"}], "+", "ck"}]], "+", 
  FractionBox["1", 
   RowBox[{"1", "-", 
    RowBox[{"c2", " ", "ck"}]}]]}]], "Output",
 CellChangeTimes->{{3.7651030088887835`*^9, 3.7651030296258383`*^9}, 
   3.7651030889293966`*^9, {3.765103121726637*^9, 3.765103139428638*^9}, {
   3.76510317456308*^9, 3.7651031836002474`*^9}, 
   3.7651032150344563`*^9},ExpressionUUID->"11255539-35cb-4186-bc8f-\
486a7600c0d0"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Another", "Subsection",
 CellChangeTimes->{{3.7651093774697857`*^9, 
  3.7651093781503716`*^9}},ExpressionUUID->"27386490-dec5-419b-a3a4-\
915e7cf48c79"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", "m"], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", "m"], " ", "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["ck", 
       RowBox[{"-", "n"}]], "s1"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox["ck", 
       RowBox[{"m", "-", "N0", "+", "1"}]], "m"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "0", ",", 
       RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7651093810840287`*^9, 
  3.7651094810760345`*^9}},ExpressionUUID->"39d7dd12-ff30-42dc-9157-\
54e0b806a3ad"],

Cell[BoxData[
 FractionBox[
  RowBox[{"ck", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "ck", "-", 
     SuperscriptBox["ck", 
      RowBox[{"1", "-", "N0"}]], "+", 
     SuperscriptBox["ck", "N0"], "+", 
     RowBox[{"2", " ", "N0"}], "-", 
     RowBox[{"2", " ", "ck", " ", "N0"}]}], ")"}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "ck"}], ")"}], "3"]]], "Output",
 CellChangeTimes->{
  3.7651094287087736`*^9, {3.7651094738452187`*^9, 
   3.7651094815535407`*^9}},ExpressionUUID->"d9c865d7-bf48-42cf-8135-\
e95246b57750"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking the equal distribution across Cos and Sin", "Subsection",
 CellChangeTimes->{{3.7651093774697857`*^9, 3.7651093781503716`*^9}, {
  3.765776763813505*^9, 
  3.7657767762936273`*^9}},ExpressionUUID->"dcb988cd-052c-4900-85e1-\
e5feb38158f6"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", 
        RowBox[{"n", "+", "m"}]], 
       SuperscriptBox["c1", 
        RowBox[{"n", "-", "m"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", 
        RowBox[{"n", "+", "m"}]], 
       SuperscriptBox["c1", 
        RowBox[{"m", "-", "n"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", 
        RowBox[{"m", "+", "N0", "-", "1"}]], 
       SuperscriptBox["c1", 
        RowBox[{"N0", "-", "1", "-", "m"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"ck", " ", "c1"}], ")"}], 
       RowBox[{"m", "+", "n"}]], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"q1a", "=", 
  RowBox[{
   RowBox[{"q1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SuperscriptBox["ck", "N0"], "\[Rule]", "1"}], ",", 
      RowBox[{
       SuperscriptBox["ck", 
        RowBox[{"2", "N0"}]], "\[Rule]", "1"}], ",", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"c1", " ", "ck"}], ")"}], "N0"], "\[Rule]", 
       SuperscriptBox["c1", "N0"]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7651093810840287`*^9, 3.7651094810760345`*^9}, {
  3.765776786140362*^9, 3.765776817269658*^9}, {3.765776880980058*^9, 
  3.765776907085331*^9}, {3.765777107212866*^9, 3.765777112804885*^9}, {
  3.765777197093479*^9, 3.765777307149233*^9}, {3.7657776836355495`*^9, 
  3.7657776974990387`*^9}, {3.7657799996198273`*^9, 
  3.765780011636924*^9}},ExpressionUUID->"e352ca28-5c0e-4878-8a82-\
502661224b96"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"c1", " ", "ck"}], ")"}], "N0"]}], ")"}], "2"]}], "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", "ck"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"c1", "-", "ck", "+", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{"c1", "-", "ck"}], ")"}], " ", "ck"}], "-", 
       RowBox[{
        SuperscriptBox["ck", 
         RowBox[{"2", " ", "N0"}]], " ", 
        RowBox[{"(", 
         RowBox[{"c1", "+", "ck"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"c1", " ", "ck"}]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["c1", 
         RowBox[{"1", "+", "N0"}]], " ", 
        SuperscriptBox["ck", "N0"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["ck", "2"]}], ")"}]}]}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"c1", "-", "ck"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["ck", "2"]}], ")"}]}]]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", "ck"}]}], ")"}], "2"]]], "Output",
 CellChangeTimes->{
  3.7651094287087736`*^9, {3.7651094738452187`*^9, 3.7651094815535407`*^9}, 
   3.7657769122604637`*^9, 3.765777113593444*^9, {3.765777242821871*^9, 
   3.765777269800993*^9}, 3.7657773092576256`*^9, {3.765777685685796*^9, 
   3.7657776989071045`*^9}, {3.765780006897133*^9, 
   3.765780012848592*^9}},ExpressionUUID->"bf4f956d-2b28-4e3b-96f3-\
78ca2b6d3e20"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["c1", "N0"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"c1", "+", 
      SuperscriptBox["c1", 
       RowBox[{"1", "+", "N0"}]], "+", "ck", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "2"], " ", "ck"}], "-", 
      RowBox[{
       SuperscriptBox["c1", "N0"], " ", "ck"}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", "ck"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", "ck"}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.7651094287087736`*^9, {3.7651094738452187`*^9, 3.7651094815535407`*^9}, 
   3.7657769122604637`*^9, 3.765777113593444*^9, {3.765777242821871*^9, 
   3.765777269800993*^9}, 3.7657773092576256`*^9, {3.765777685685796*^9, 
   3.7657776989071045`*^9}, {3.765780006897133*^9, 
   3.7657800128735447`*^9}},ExpressionUUID->"9a9135fe-b387-4f43-a818-\
d477df32f99d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Limit", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["dt", "2"], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], " ", "\[Lambda]"}], ")"}]}], " ", "*", "q1a"}], "/.", 
    RowBox[{"c1", "\[Rule]", 
     RowBox[{"Exp", "[", 
      RowBox[{"\[Lambda]", " ", "dt"}], "]"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7657800187971363`*^9, 
  3.765780085692486*^9}},ExpressionUUID->"17c2fad9-29ea-4b4a-9f0d-\
369de33e7513"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["dt", "3"], " ", "N0"}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "ck"}], ")"}], "2"]]], "Output",
 CellChangeTimes->{{3.7657800450226326`*^9, 
  3.765780086308755*^9}},ExpressionUUID->"78c7e16f-ac07-4786-9c70-\
a640f22dd517"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Next", "Subsection",
 CellChangeTimes->{{3.7657783273960075`*^9, 
  3.765778329411697*^9}},ExpressionUUID->"81292241-0483-4951-8112-\
678031abad0a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"q2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"1", "/", "ck"}]}], ")"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"c1", "/", "ck"}], "-", "1"}], ")"}], "2"], 
    RowBox[{"(", 
     RowBox[{"c1", "+", 
      SuperscriptBox["c1", 
       RowBox[{"N0", "+", "1"}]], "+", "ck", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "2"], "ck"}], "-", 
      RowBox[{
       SuperscriptBox["c1", "N0"], "ck"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q2", "//", "Expand"}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7657783347485433`*^9, 3.7657783796843023`*^9}, {
  3.765778477509206*^9, 3.765778503265098*^9}, {3.765779993955862*^9, 
  3.7657799951232586`*^9}},ExpressionUUID->"5c0a501f-5a51-4933-842e-\
39e5cc98aaca"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", "ck"}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", "ck"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "c1"}], "-", 
      SuperscriptBox["c1", 
       RowBox[{"1", "+", "N0"}]], "-", "ck", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "2"], " ", "ck"}], "+", 
      RowBox[{
       SuperscriptBox["c1", "N0"], " ", "ck"}]}], ")"}]}], 
   SuperscriptBox["ck", "3"]]}]], "Output",
 CellChangeTimes->{
  3.765778380513562*^9, {3.7657784811375084`*^9, 3.7657785037336655`*^9}, 
   3.765779995703904*^9},ExpressionUUID->"edbd7e3a-cf73-4fc9-91b8-\
337e6395a039"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Checking the equal distribution across Cos and Sin for \[Lambda] = 0", \
"Subsection",
 CellChangeTimes->{{3.7651093774697857`*^9, 3.7651093781503716`*^9}, {
  3.765776763813505*^9, 3.7657767762936273`*^9}, {3.7662091267151456`*^9, 
  3.7662091299234896`*^9}},ExpressionUUID->"756ddf52-da39-4d6d-b33c-\
606528c6759e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "n"}], ")"}]}], "N0"], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "n"}], ")"}]}], "N0"], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{"m", "+", "N0", "-", "1"}], ")"}]}], "N0"], "]"}], "m"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7651093810840287`*^9, 3.7651094810760345`*^9}, {
  3.765776786140362*^9, 3.765776817269658*^9}, {3.765776880980058*^9, 
  3.765776907085331*^9}, {3.765777107212866*^9, 3.765777112804885*^9}, {
  3.765777197093479*^9, 3.765777307149233*^9}, {3.7657776836355495`*^9, 
  3.7657776974990387`*^9}, {3.7657799996198273`*^9, 3.765780011636924*^9}, {
  3.7662091380231814`*^9, 3.7662092010610037`*^9}, {3.766209252164196*^9, 
  3.766209317323762*^9}, {3.766209364332292*^9, 
  3.7662093871089363`*^9}},ExpressionUUID->"3d4649be-7cb4-44d4-9c60-\
c151150b9a2f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  RowBox[{"Csc", "[", 
   FractionBox[
    RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "-", 
            FractionBox["3", "N0"]}], ")"}]}]}], ")"}], " ", "\[Pi]"}], 
      "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"2", "+", 
         FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}]}], "-", 
    RowBox[{"Sin", "[", 
     RowBox[{"k", " ", 
      RowBox[{"(", 
       RowBox[{"4", "+", 
        FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}], "+", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{"4", "+", 
         FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"4", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{
  3.7651094287087736`*^9, {3.7651094738452187`*^9, 3.7651094815535407`*^9}, 
   3.7657769122604637`*^9, 3.765777113593444*^9, {3.765777242821871*^9, 
   3.765777269800993*^9}, 3.7657773092576256`*^9, {3.765777685685796*^9, 
   3.7657776989071045`*^9}, {3.765780006897133*^9, 3.765780012848592*^9}, 
   3.766209214697983*^9, {3.766209272441688*^9, 3.766209292777027*^9}, 
   3.7662093239613886`*^9, {3.7662093665580015`*^9, 
   3.766209387792899*^9}},ExpressionUUID->"783c4a31-5152-4a1c-a3d8-\
ddf881dbfa11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", "N0", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    SuperscriptBox[
     RowBox[{"Cot", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7651094287087736`*^9, {3.7651094738452187`*^9, 3.7651094815535407`*^9}, 
   3.7657769122604637`*^9, 3.765777113593444*^9, {3.765777242821871*^9, 
   3.765777269800993*^9}, 3.7657773092576256`*^9, {3.765777685685796*^9, 
   3.7657776989071045`*^9}, {3.765780006897133*^9, 3.765780012848592*^9}, 
   3.766209214697983*^9, {3.766209272441688*^9, 3.766209292777027*^9}, 
   3.7662093239613886`*^9, {3.7662093665580015`*^9, 
   3.766209388606887*^9}},ExpressionUUID->"0df3ce67-9e79-4245-b4bc-\
c37d016eb04a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"m", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7662148771502223`*^9, 
  3.7662149127554474`*^9}},ExpressionUUID->"86fb176f-5d39-42ae-bd1f-\
9f3ca67d62e0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], "-", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "m"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], ")"}],
   " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], "-", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.7662149133655295`*^9},ExpressionUUID->"1177da32-ca3f-4266-a083-\
a696eeeb63c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"n", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"m", "+", "1"}], ")"}]}], "N0"], "]"}], "-", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"2", " ", "\[Pi]", " ", "k"}], "N0"], "]"}]}], ")"}]}]}], "//",
   "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7662150071198597`*^9, 
  3.7662150207513695`*^9}},ExpressionUUID->"97ea8bbf-f829-4a55-841e-\
1dcd8de75423"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  RowBox[{"Cos", "[", 
   FractionBox[
    RowBox[{"k", " ", 
     RowBox[{"(", 
      RowBox[{"4", "+", "m", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], 
  " ", 
  RowBox[{"Sin", "[", 
   FractionBox[
    RowBox[{"k", " ", "m", " ", "\[Pi]"}], "N0"], "]"}], " ", 
  RowBox[{"Sin", "[", 
   FractionBox[
    RowBox[{"k", " ", "n", " ", "\[Pi]"}], "N0"], "]"}]}]], "Output",
 CellChangeTimes->{
  3.7662150242042704`*^9},ExpressionUUID->"4f8c40f3-d2b4-47a5-9b99-\
1fa1750f9449"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Rechecking the equal distribution across Cos and Sin for \[Lambda] = 0\
\>", "Subsection",
 CellChangeTimes->{{3.7651093774697857`*^9, 3.7651093781503716`*^9}, {
  3.765776763813505*^9, 3.7657767762936273`*^9}, {3.7662091267151456`*^9, 
  3.7662091299234896`*^9}, {3.766215370032013*^9, 
  3.766215371480485*^9}},ExpressionUUID->"3329dc86-f0d2-4b4f-86df-\
b5c7e5b866c3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "m", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "m", " ", "\[Pi]"}], "N0"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "n", " ", "\[Pi]"}], "N0"], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "m", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "m", " ", "\[Pi]"}], "N0"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "n", " ", "\[Pi]"}], "N0"], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "+", "m", "+", "N0", "-", "1"}], ")"}], " ", 
          "\[Pi]"}], "N0"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "m", " ", "\[Pi]"}], "N0"], "]"}], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"k", " ", "n", " ", "\[Pi]"}], "N0"], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7651093810840287`*^9, 3.7651094810760345`*^9}, {
  3.765776786140362*^9, 3.765776817269658*^9}, {3.765776880980058*^9, 
  3.765776907085331*^9}, {3.765777107212866*^9, 3.765777112804885*^9}, {
  3.765777197093479*^9, 3.765777307149233*^9}, {3.7657776836355495`*^9, 
  3.7657776974990387`*^9}, {3.7657799996198273`*^9, 3.765780011636924*^9}, {
  3.7662091380231814`*^9, 3.7662092010610037`*^9}, {3.766209252164196*^9, 
  3.766209317323762*^9}, {3.766209364332292*^9, 3.7662093871089363`*^9}, {
  3.766215396915529*^9, 
  3.7662154100811453`*^9}},ExpressionUUID->"53cd55e9-35bc-43ba-871c-\
0673287d2c7f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "96"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "8"}], " ", "N0", " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", 
       RowBox[{"3", " ", "N0"}], "+", 
       SuperscriptBox["N0", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"4", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "N0", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"3", "-", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
         "]"}]}], "-", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "N0", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], 
         "]"}]}], "+", 
       RowBox[{
        RowBox[{"Csc", "[", 
         FractionBox[
          RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"4", " ", "k", " ", "\[Pi]"}], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "N0"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"6", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "3"}], "+", "n", "-", 
                RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"2", " ", "k", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], 
           " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"2", " ", "k", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], 
           " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"5", "-", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], 
             "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"5", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], 
             "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", "n", "+", 
                RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"7", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Cos", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Sec", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"4", " ", "k", " ", "\[Pi]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "N0", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["N0", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"2", "+", 
               FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             FractionBox[
              RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"4", "+", 
               FractionBox["1", "N0"]}], ")"}], " ", "\[Pi]"}], "]"}]}], "-", 
          RowBox[{"12", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"5", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"8", " ", "N0", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"5", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             FractionBox[
              RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"7", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "-", 
          RowBox[{
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Csc", "[", 
            FractionBox[
             RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"8", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
          RowBox[{"4", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"4", "-", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], 
             "N0"], "]"}]}], "-", 
          RowBox[{"4", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"4", "+", "n", "+", "N0"}], ")"}], " ", "\[Pi]"}], 
             "N0"], "]"}]}], "-", 
          RowBox[{"4", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "+", 
          RowBox[{"6", " ", "N0", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["N0", "2"], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "-", 
          RowBox[{"3", " ", 
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             FractionBox[
              RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "-", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Csc", "[", 
             FractionBox[
              RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"5", "+", 
                RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "-", 
          RowBox[{"4", " ", "N0", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", "n", "+", 
                RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}], "+", 
          RowBox[{"4", " ", "N0", " ", 
           RowBox[{"Sin", "[", 
            FractionBox[
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"2", "+", "n", "+", 
                RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
            "]"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7662156220007105`*^9},ExpressionUUID->"a2ec97a6-2ad6-4dda-81fd-\
fb29d61b80f2"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "96"], " ", "N0", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", "N0"}], ")"}], " ", "N0"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "11"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"9", "-", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "N0"}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"4", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "2"}], "+", "N0"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"6", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "N0", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", "1"}], ")"}], 
         RowBox[{"1", "+", "k"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "5"}], "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
           "]"}], "-", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
           "]"}], "+", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], 
          "-", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
         ")"}]}]}], ")"}]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"-", "1"}], ")"}], "k"], " ", "N0", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "5"}], "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "]"}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
         "]"}]}], "+", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], 
        "]"}], "-", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"k", " ", 
           RowBox[{"(", 
            RowBox[{"3", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
       "-", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"5", "+", "n"}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
      ")"}]}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.7662157977175198`*^9},ExpressionUUID->"c416b5a7-7b42-40f5-85db-\
7e90eaa97196"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], "^", 
    "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", 
     RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Sum", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", " ", "\[Pi]", " ", "k", " ", "n"}], "N0"], "]"}], "^", 
    "2"}], ",", 
   RowBox[{"{", 
    RowBox[{"n", ",", "0", ",", 
     RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7663838326002426`*^9, 3.7663838564678307`*^9}, {
  3.7663839804120407`*^9, 3.7663839842442837`*^9}, {3.7664011316486945`*^9, 
  3.7664011371207485`*^9}},ExpressionUUID->"4c1c39cc-0503-445d-8e89-\
559c2c2dcb14"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"2", " ", "M"}], "+", 
    RowBox[{
     RowBox[{"Csc", "[", 
      FractionBox[
       RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], " ", "\[Pi]"}], "+", 
          RowBox[{"2", " ", "k", " ", "M", " ", "\[Pi]"}]}], ")"}]}], "M"], 
      "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.766383857165327*^9, 3.766383984973461*^9, 
  3.7663934431056476`*^9, 
  3.7664011409863977`*^9},ExpressionUUID->"cae0ebf5-9052-43bd-ab6f-\
054429d08a79"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "N0"}], "-", 
    RowBox[{
     RowBox[{"Csc", "[", 
      FractionBox[
       RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "k"}], " ", "\[Pi]"}], "+", 
          RowBox[{"2", " ", "k", " ", "N0", " ", "\[Pi]"}]}], ")"}]}], "N0"], 
      "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.766383857165327*^9, 3.766383984973461*^9, 
  3.7663934431056476`*^9, 
  3.766401140991888*^9},ExpressionUUID->"9d621c4b-8557-4b15-b023-\
3e2421073b65"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "-", "n"}], ")"}]}], "N0"], "]"}], "+", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "n"}], ")"}]}], "N0"], "]"}]}], ")"}], "m"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "-", "n"}], ")"}]}], "N0"], "]"}], "+", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "n"}], ")"}]}], "N0"], "]"}]}], ")"}], "n"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "-", "N0", "+", "1"}], ")"}]}], "N0"], "]"}], "+", 
         RowBox[{"Exp", "[", 
          FractionBox[
           RowBox[{"2", " ", "\[Pi]", " ", "\[ImaginaryI]", " ", "k", " ", 
            RowBox[{"(", 
             RowBox[{"m", "+", "N0", "-", "1"}], ")"}]}], "N0"], "]"}]}], 
        ")"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.76638881105721*^9, 
  3.7663888743437414`*^9}},ExpressionUUID->"bfeb89b9-adf9-4791-ac07-\
d4a0e531514a"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "N0"]]}], ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      ")"}]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}],
      "-", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
     "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"]], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"]], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"]]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
             "N0"]], ")"}], "N0"]}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "N0"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"3", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "N0"}], ")"}]}], "-", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"6", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}]], " ", 
      "N0"}], "+", 
     RowBox[{
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "N0"}], ")"}], " ", "\[Pi]"}], "N0"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           SuperscriptBox["\[ExponentialE]", 
            FractionBox[
             RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
             "N0"]], ")"}], "N0"]}], "+", 
        RowBox[{"2", " ", "N0"}]}], ")"}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7663888846029253`*^9},ExpressionUUID->"47190b7d-e080-4eae-8993-\
daf000cb699b"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"-", "N0"}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", "N0"}], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
           "N0"]], ")"}], "N0"]}], "+", 
      RowBox[{"3", " ", "N0"}]}], ")"}]}]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "N0"]]}], 
    ")"}], "3"]]], "Output",
 CellChangeTimes->{
  3.7663888849947205`*^9},ExpressionUUID->"0e8b9dda-6eff-4f1c-8890-\
7ad36b9db0ae"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.766391728597086*^9},ExpressionUUID->"daf4978f-a533-4a01-bab2-\
204ffbb94f2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
      RowBox[{"(", 
       RowBox[{"n", "-", "m"}], ")"}]}], "N0"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"N0", "-", "1"}], ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.766391751055826*^9, 3.766391807037505*^9}, {
  3.7663941911801033`*^9, 
  3.766394204308071*^9}},ExpressionUUID->"09f24211-e7c7-4531-a99d-\
e3e599456dae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"2", " ", "N0"}], "+", 
    RowBox[{
     RowBox[{"Csc", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}]}],
    ")"}]}]], "Output",
 CellChangeTimes->{
  3.7663918085871997`*^9, {3.766394192763096*^9, 
   3.766394205215833*^9}},ExpressionUUID->"2e617ad9-3b1c-4d60-aa60-\
979d957fef58"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "N0", " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.7663918085871997`*^9, {3.766394192763096*^9, 
   3.766394205274724*^9}},ExpressionUUID->"6cdabb43-6b64-4222-9fff-\
d03fec06ba04"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", "1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"N0", "-", "1"}], ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.766391859797949*^9},ExpressionUUID->"9db94fdc-72e6-43bd-b35a-\
a26cf0a8b6a6"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", "N0", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"3", " ", "N0"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["N0", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.766391860339302*^9},ExpressionUUID->"fe282476-6149-4dd4-acc4-\
87b36c122d34"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "6"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", "N0", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "N0"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7663918603427944`*^9},ExpressionUUID->"67a8897f-3c3f-4abb-b405-\
b029071a730c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"Cos", "[", 
    FractionBox[
     RowBox[{"2", " ", "\[Pi]", " ", "k", " ", 
      RowBox[{"(", 
       RowBox[{"n", "+", "m", "-", "1"}], ")"}]}], "N0"], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"q1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"N0", "-", "2"}]}], "}"}]}], "]"}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"N0", "-", "1"}], ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"N0", "-", "1"}]}], "}"}]}], "]"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.766391977838028*^9, 
  3.7663919801507645`*^9}},ExpressionUUID->"a4a8a99e-f5e8-43e9-8e49-\
32f5665cee93"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "8"]}], " ", 
  RowBox[{"Csc", "[", 
   FractionBox[
    RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"2", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "N0"}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{"4", "-", 
            FractionBox["5", "N0"]}], ")"}]}]}], ")"}], " ", "\[Pi]"}], 
      "]"}]}], "-", 
    RowBox[{"Sin", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        FractionBox[
         RowBox[{"3", " ", "k"}], "N0"]}], ")"}], " ", "\[Pi]"}], "]"}], "+", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"4", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], "-", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "7"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"3", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "-", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}], "+", 
    RowBox[{"N0", " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], "]"}]}], 
    "+", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"k", "+", "N0", "-", 
         RowBox[{"2", " ", "k", " ", "N0"}]}], ")"}], " ", "\[Pi]"}], "N0"], 
     "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7663919827904177`*^9},ExpressionUUID->"7dada667-679b-46b3-a291-\
f31add99234a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "4"]}], " ", "N0", " ", 
  RowBox[{"Cos", "[", 
   FractionBox[
    RowBox[{"4", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.766391984644993*^9},ExpressionUUID->"ce25af2a-ce1a-419e-babf-\
b9e39c27d75d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "N0", " ", 
    SuperscriptBox[
     RowBox[{"Csc", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "4"]}], " ", "N0", " ", 
     RowBox[{"Cos", "[", 
      FractionBox[
       RowBox[{"4", " ", "k", " ", "\[Pi]"}], "N0"], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Csc", "[", 
       FractionBox[
        RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}], ")"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.766395258555028*^9, 
  3.7663952674352446`*^9}},ExpressionUUID->"4722cfba-344b-4dee-aa5a-\
a7c509b2cb96"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", "N0", " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"4", " ", "k", " ", "\[Pi]"}], "N0"], "]"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "N0"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.7663952620641007`*^9, 
  3.7663952682025003`*^9}},ExpressionUUID->"59a13655-2424-4ced-b101-\
a39360276b34"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["New Fourier transform definitions below", "Subsection",
 CellChangeTimes->{{3.7664029841657467`*^9, 
  3.766402991189371*^9}},ExpressionUUID->"f65c35e7-a3ae-422d-b138-\
f0e3398a5f2c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "n"}], "-", "1"}], ")"}]}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", "m"}], "-", "1"}], ")"}]}], "M"], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "n"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "n"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"n", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "m"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"q1", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.766403014238882*^9, 3.7664030723745193`*^9}, {
  3.7664042266068344`*^9, 3.7664042342776318`*^9}, {3.7664050384540462`*^9, 
  3.766405041957359*^9}, {3.766463243424223*^9, 
  3.766463243830946*^9}},ExpressionUUID->"df1421ae-fa30-474c-989f-\
2426bd118585"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "8"], " ", "M", " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], ")"}], " ", 
  SuperscriptBox[
   RowBox[{"Csc", "[", 
    FractionBox[
     RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.766403191093269*^9, {3.766404230230156*^9, 3.7664042433022127`*^9}, 
   3.766404311481866*^9, 3.766405047054776*^9, 
   3.7664632521927137`*^9},ExpressionUUID->"32e1e4d8-e3a3-4d6d-9972-\
6692ca5056a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"\[Pi]", " ", "k", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "n"}], "-", "1"}], ")"}]}], "M"], "]"}], "n"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "0", ",", 
      RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7664032385285945`*^9, 3.7664032785032635`*^9}, {
   3.7664033662308083`*^9, 3.7664033680448675`*^9}, {3.7664035239907093`*^9, 
   3.7664035617022696`*^9}, 
   3.766405205885317*^9},ExpressionUUID->"6447099b-8c61-42cd-963e-\
cc3a859392ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "M", " ", 
  RowBox[{"Cos", "[", 
   FractionBox[
    RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], " ", 
  RowBox[{"Csc", "[", 
   FractionBox[
    RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}]}]], "Output",
 CellChangeTimes->{{3.7664033214229794`*^9, 3.7664033214654007`*^9}, {
   3.76640336270794*^9, 3.7664033688130016`*^9}, {3.766403547044527*^9, 
   3.766403562922064*^9}, 
   3.766405206843459*^9},ExpressionUUID->"be540654-3cc9-4f5b-a7f1-\
056a1018941e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"2", " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "k"}], "M"], "]"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", "\[Pi]", " ", "k"}], "M"], "]"}], "+", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"6", "\[Pi]", " ", "k"}], "M"], "]"}]}], ")"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"\[Pi]", " ", "k"}], "M"], "]"}]}], "-", 
   RowBox[{"2", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"4", "\[Pi]", " ", "k"}], "M"], "]"}]}], "+", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k"}], "M"], "]"}], "^", "2"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7664037179167643`*^9, 
  3.7664037873044567`*^9}},ExpressionUUID->"3bde9613-6eab-41c0-8bed-\
79f80cc77045"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "+", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"6", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "-", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.766403804669077*^9},ExpressionUUID->"e4fbbcaa-0488-4b96-a504-\
d6e3b37940ff"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.766405354611086*^9},ExpressionUUID->"cebe65c4-7876-44d8-82f2-\
260f1b9bf828"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Cot", "[", 
       FractionBox[
        RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "-", 
      RowBox[{"Sin", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], ")"}], "*", "4",
     " ", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"k", " ", "/", "M"}]}], "]"}], "^", "2"}]}], "-", 
   RowBox[{"M", " ", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Pi]", " ", 
       RowBox[{"k", "/", "M"}]}], "]"}], "^", "2"}]}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7664053617243986`*^9, 
  3.7664054172763877`*^9}},ExpressionUUID->"09afb2c6-05ab-4426-b0f6-\
c29aa10f8a37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox["1", "2"]}], " ", "M", " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "-", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7664054176997924`*^9},ExpressionUUID->"3fb5312b-a920-4814-a3ce-\
cb05b90966c3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Three terms of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Re", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d566aff0-27d8-4497-9d12-e47fa1fe69f7"],
 " Jk(\[Lambda]) mean"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 
  3.7664694158113227`*^9}},ExpressionUUID->"5b1ff323-bd3e-4136-9ff3-\
c1c81d684fa3"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", "1"}], ")"}], "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 
  3.7664689310028715`*^9}},ExpressionUUID->"1e081e19-9877-410d-a2b3-\
04f87bdd91ec"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["c1", "M"]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7664683604246893`*^9, 3.766469009465231*^9, 
  3.781852522147352*^9},ExpressionUUID->"8c707a80-1e43-47f6-8e30-\
5f0d01d59fd5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
  3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
  3.7664687009977393`*^9}, {3.7664687598114276`*^9, 
  3.76646876023464*^9}},ExpressionUUID->"fa70b2c0-7791-4534-94c6-\
9dbe65dff9a0"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "M"}], "+", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "6"}], "+", 
        RowBox[{"6", " ", 
         SuperscriptBox["c1", "M"]}], "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", "M"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["c1", "M"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              SuperscriptBox["c1", "2"]}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["c1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "M"}], ")"}]}], "+", "M"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "M"]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7664687063662586`*^9, 3.766468775820693*^9, 
  3.781852544631542*^9},ExpressionUUID->"423d4cb0-717a-4327-aa99-\
6a4b625404fa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", "m"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r3", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 
  3.7664688248104224`*^9}},ExpressionUUID->"56fd9fe8-c623-4c5a-b55b-\
aea1661e83e4"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["c1", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["c1", "2"]}], ")"}]}], "+", "M", "-", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"2", "+", "M"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"3", "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["c1", "2"]}], ")"}]}], "-", "M", "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", "M"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "M"], "+", 
           SuperscriptBox["c1", 
            RowBox[{"2", "+", "M"}]], "+", "M", "-", 
           RowBox[{
            SuperscriptBox["c1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "M"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.766468856839649*^9, 
  3.7818525689686236`*^9},ExpressionUUID->"2966bd86-1766-4b9a-ab5c-\
15da634d376a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"848d2997-c087-43e5-8cdd-\
da2333e0b36b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rSum", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"r1", "+", "r2", "+", "r3"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "\[Element]", "Integers"}], ",", 
       RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"rSum", ",", "M"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"M", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}},ExpressionUUID->"8c5851f1-6380-488e-be4f-\
3d13a7b41354"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
      SuperscriptBox["c1", 
       RowBox[{"2", " ", "M"}]]}], "+", 
     RowBox[{
      SuperscriptBox["c1", "M"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", "c1", "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["c1", "2"]}]}], ")"}]}], "+", "M", "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"3", " ", "c1"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"2", "+", 
           RowBox[{"c1", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "c1"}], ")"}]}]}], ")"}], " ", "M"}]}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "3"]}], "+", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
         SuperscriptBox["c1", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "M"}]}]]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
         SuperscriptBox["c1", "M"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "c1"}], ")"}], "2"]}], "+", "M", "+", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"c1", " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", "c1"}], ")"}]}]}], ")"}], " ", "M"}]}], ")"}], 
      " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
      SuperscriptBox["c1", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["c1", "M"]}], ")"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "-", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
         SuperscriptBox["c1", "M"]}], "-", "M", "-", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "M"}], ")"}]}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.78185258394876*^9},ExpressionUUID->"c4cf3e8d-bede-4c58-98d1-9fdc4f5b39cb"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ",
     "M", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"2", " ", "c1"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "2"]}], "+", 
      SuperscriptBox["c1", "3"], "-", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "-", 
      RowBox[{"3", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", "3"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"c1", "-", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"c1", " ", 
         SuperscriptBox["\[ExponentialE]", 
          FractionBox[
           RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
           "M"]]}]}], ")"}], "2"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"2", " ", "c1"}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["c1", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "M"]}], "-", 
      SuperscriptBox["c1", 
       RowBox[{"2", " ", "M"}]], "+", 
      SuperscriptBox["c1", 
       RowBox[{"1", "+", "M"}]], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["c1", 
        RowBox[{"2", "+", "M"}]]}], "+", 
      SuperscriptBox["c1", 
       RowBox[{"1", "+", 
        RowBox[{"2", " ", "M"}]}]], "+", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "3"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "M"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"1", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"2", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"3", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", "2"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["c1", "3"], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"2", "+", "M"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"3", "+", "M"}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "-", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "+", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], "-", 
      RowBox[{"c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"1", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"2", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.7818525839617505`*^9},ExpressionUUID->"5986a067-16a5-4e8f-81e6-\
d8ffa9f9a48c"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "2"]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", "M"}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.781852584083704*^9},ExpressionUUID->"a9b7a18a-c3fd-4281-9fd3-\
4d6f3d99eec6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Three terms of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["Im", "2"], TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "a0075829-e99e-4dfd-aca2-26185634c20e"],
 " Jk(\[Lambda]) mean"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.7664734002723317`*^9, 3.766473402577483*^9}, {3.7664734953686557`*^9, 
  3.766473497761706*^9}, {3.766480155562739*^9, 
  3.7664801614268165`*^9}},ExpressionUUID->"fe27b432-e75e-4d05-92cf-\
88a71be32a6f"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", "1"}], ")"}], "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.7664734127123837`*^9, 
  3.7664734158322773`*^9}},ExpressionUUID->"9c7f084d-0e4a-48e4-9b96-\
a549eccb173b"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], "2"], " ", 
    SuperscriptBox["c1", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c1", "M"]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7664683604246893`*^9, 3.766469009465231*^9, 
  3.7664734995214343`*^9},ExpressionUUID->"f3498640-df28-4784-aad1-\
959c3ef51248"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
  3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
  3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
  3.766473428672137*^9, 
  3.7664734325619097`*^9}},ExpressionUUID->"d3a36320-245e-4ff1-846c-\
f8730cbcabe7"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "M"}], "+", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "M"]}], "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", "M"}]}], ")"}]}], "-", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c1", "2"]}], ")"}], " ", "M", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["c1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c1", "M"]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.7664687063662586`*^9, 3.766468775820693*^9, 
  3.766473524429653*^9},ExpressionUUID->"003fdb5e-cb24-4bc1-ad68-\
ab1ca9c66e63"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{"2", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", "m"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r3", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, {
  3.766473436018482*^9, 
  3.766473437089491*^9}},ExpressionUUID->"33b5c385-40c7-4360-9d3b-\
be455b1b0e65"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SuperscriptBox["c1", "4"]}], ")"}]}], " ", "M", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["c1", "2"]}], ")"}]}], "-", "M", "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "M"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "M"], "+", 
           SuperscriptBox["c1", 
            RowBox[{"2", "+", "M"}]], "+", 
           RowBox[{
            SuperscriptBox["c1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "M"}], ")"}]}], "-", "M"}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
    ")"}]}], 
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.766468856839649*^9, 
  3.766473552197014*^9},ExpressionUUID->"386d8fbc-ea0b-43d6-a3a1-\
445b770b4838"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"d07223d0-e465-4ee2-948a-\
e8ef8ed2f587"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rSum", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"r1", "+", "r2", "+", "r3"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "\[Element]", "Integers"}], ",", 
       RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"rSum", ",", "M"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"M", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}},ExpressionUUID->"0528cada-105b-4d52-a413-\
7e7bf9a5cc2f"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{"2", " ", "c1", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], 
     "2"]}]], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "M"}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
         SuperscriptBox["c1", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "M"}]}]]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "2"]}], ")"}]}], "+", 
        RowBox[{"4", " ", "M"}], "+", 
        RowBox[{"c1", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "c1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", "c1"}], ")"}], " ", "M"}]}], ")"}]}]}], 
       ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "c1"}], ")"}], "3"], " ", "M", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "c1", "+", 
        SuperscriptBox["c1", "2"], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
         SuperscriptBox["c1", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", "M"}]}]]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "2"]}], ")"}]}], "-", 
        RowBox[{"2", " ", "M"}], "-", 
        RowBox[{"2", " ", "c1", " ", "M"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.766473560995161*^9},ExpressionUUID->"0212f0b5-ff8a-4425-a8c4-\
60942c095a6a"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"4", " ", "c1"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["c1", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "3"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"6", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "3"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{"2", " ", "c1", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], 
     "2"]}]], "+", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        SuperscriptBox["c1", "2"], "-", 
        RowBox[{"2", " ", "c1", " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], 
      "2"]}]], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "c1"}], "+", 
      SuperscriptBox["c1", "2"], "+", 
      SuperscriptBox["c1", "3"], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"1", "+", "M"}]]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"3", "+", "M"}]]}], "-", 
      SuperscriptBox["c1", 
       RowBox[{"2", "+", 
        RowBox[{"2", " ", "M"}]}]], "+", 
      SuperscriptBox["c1", 
       RowBox[{"3", "+", 
        RowBox[{"2", " ", "M"}]}]], "+", 
      RowBox[{"2", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", "2"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", "3"], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"1", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["c1", 
        RowBox[{"3", "+", "M"}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"2", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["c1", 
        RowBox[{"3", "+", 
         RowBox[{"2", " ", "M"}]}]], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.766473561006661*^9},ExpressionUUID->"f707613f-ac7c-4df2-bfd0-\
59dc4bd96ee9"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "2"]}], ")"}], " ", "M", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{"1", "+", 
   SuperscriptBox["c1", "2"], "-", 
   RowBox[{"2", " ", "c1", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}]]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 
  3.7664735610969706`*^9},ExpressionUUID->"b1feab5f-d47e-40e4-baf1-\
d71d67df1ed3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Three terms of the cross-term Re Jk(\[Lambda]) * Im Jk(\[Lambda]) \
mean", "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.7664798563633103`*^9, 
  3.7664798739713526`*^9}},ExpressionUUID->"a8dc7a84-6d9e-4749-8653-\
c9fb2e55ec9a"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.766479881726857*^9, 
  3.766479883179278*^9}},ExpressionUUID->"9a83004c-1916-4a61-a0be-\
1f5c0aaa56c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", "1"}], ")"}], "2"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r1", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.766480111452197*^9, 
  3.766480111827483*^9}},ExpressionUUID->"938d407b-b32c-41d4-b685-\
ba23c546aa32"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], "2"], " ", "c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["c1", "M"]}], ")"}], "2"], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.7664683604246893`*^9, 3.766469009465231*^9, 
  3.7664801923982415`*^9},ExpressionUUID->"a84f8e02-839c-4a0d-992a-\
c27ffff23cd2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{
     RowBox[{"-", "2"}], "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r2", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
   3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
   3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
   3.766480117348274*^9, 3.7664801178757954`*^9}, 
   3.7664809497632318`*^9},ExpressionUUID->"e04a62fd-8173-4bee-a33e-\
ee88170f9b1f"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "c1", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "M"]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.7664687063662586`*^9, 3.766468775820693*^9, 
  3.7664802167539587`*^9},ExpressionUUID->"4748cd63-05e3-42ba-84b3-\
7095a8582d59"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", "m"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r3a", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, {
   3.766480121652254*^9, 3.7664801220764647`*^9}, 3.7664809987310667`*^9, 
   3.7664810307631435`*^9},ExpressionUUID->"21cc719c-e1c4-4cb2-994b-\
d40e5d3e15ad"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{"M", "-", 
     RowBox[{
      SuperscriptBox["c1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["c1", "M"]}], "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", "M"}]}], ")"}]}], "+", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SuperscriptBox["c1", "M"], "+", 
        SuperscriptBox["c1", 
         RowBox[{"2", "+", "M"}]], "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "M"}], ")"}]}], "-", "M"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", "-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{3.766468856839649*^9, 3.766480242545453*^9, 
  3.766481072516061*^9},ExpressionUUID->"93e1e77d-0659-43c0-8713-\
91503c4db0d3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", 
     RowBox[{"m", "+", "n"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox["c1", 
    RowBox[{"1", "-", 
     RowBox[{"2", "n"}]}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"q1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"r3b", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"q1", ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.7664810003144484`*^9, {3.7664810481952696`*^9, 
   3.766481073008146*^9}},ExpressionUUID->"9f675534-9758-4c34-886e-\
0d01b960a44b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]], 
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{
         SuperscriptBox["c1", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "5"}], "+", 
           SuperscriptBox["c1", "4"], "+", 
           SuperscriptBox["c1", "M"], "+", 
           SuperscriptBox["c1", 
            RowBox[{"2", "+", "M"}]], "-", 
           RowBox[{
            SuperscriptBox["c1", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "M"}], ")"}]}], "+", "M"}], ")"}]}]}], 
       ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
     RowBox[{"c1", " ", 
      RowBox[{"(", 
       RowBox[{"6", "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["c1", "M"], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           SuperscriptBox["c1", "4"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["c1", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "M"}], ")"}]}], "-", "M", "-", 
        RowBox[{"4", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "4"]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
        RowBox[{"2", " ", "c1", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SuperscriptBox["c1", "2"]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          FractionBox[
           RowBox[{"6", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
    ")"}], " ", 
   RowBox[{"Sin", "[", 
    FractionBox[
     RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}]], "Output",
 CellChangeTimes->{
  3.766481104859928*^9},ExpressionUUID->"2508e4fa-ba6e-4825-a627-\
8d587fb046aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"r3a", "-", "r3b"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7664810825154657`*^9, 
  3.7664810887843127`*^9}},ExpressionUUID->"c6b1a4ad-c9d3-4ce8-a299-\
3782d21ea79f"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["c1", "2"]}], ")"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     FractionBox[
      RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", 
         SuperscriptBox["c1", "4"], "+", 
         RowBox[{
          SuperscriptBox["c1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"5", "-", 
            RowBox[{"2", " ", "M"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
      RowBox[{"c1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         SuperscriptBox["c1", "M"], "-", 
         SuperscriptBox["c1", 
          RowBox[{"2", "+", "M"}]], "+", 
         RowBox[{
          SuperscriptBox["c1", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "M"}], ")"}]}], "+", "M", "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["c1", "2"]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
         RowBox[{"c1", " ", 
          RowBox[{"Cos", "[", 
           FractionBox[
            RowBox[{"6", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}],
      ")"}], " ", 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", "-", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"c1", " ", 
        SuperscriptBox["\[ExponentialE]", 
         FractionBox[
          RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
          "M"]]}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.766481110335251*^9},ExpressionUUID->"0275806e-796b-4350-8c72-\
31e9e63bc4e6"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"2d96e7a3-2a81-4944-9cf6-\
0fff7bdb5b80"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"rSum", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k", "\[Element]", "Integers"}], ",", 
       RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"rSum", ",", "M"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"M", " ", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.766481115732094*^9, 
  3.766481117163458*^9}},ExpressionUUID->"063cc706-b388-44d2-92f4-\
340b696b216c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{"2", " ", "c1", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], 
     "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", "c1", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "c1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
        SuperscriptBox["c1", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "M"}]}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
        SuperscriptBox["c1", "M"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "c1"}], ")"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "c1", "+", 
       RowBox[{
        SuperscriptBox["c1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"3", " ", "c1"}], "+", 
          SuperscriptBox["c1", "3"], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
           SuperscriptBox["c1", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "M"}]}]]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["c1", "M"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["c1", "2"]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
    RowBox[{"c1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["c1", "4"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"6", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["c1", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"8", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 3.766480245025821*^9, 
  3.766481137331239*^9},ExpressionUUID->"167768ac-af26-47a8-bd1f-\
7ac8f8027a68"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"2", " ", "c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{"2", " ", "c1", " ", 
        RowBox[{"Cos", "[", 
         FractionBox[
          RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], 
     "2"]}]], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", "c1", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", "c1", "+", 
       SuperscriptBox["c1", "2"], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
        SuperscriptBox["c1", 
         RowBox[{"1", "+", 
          RowBox[{"2", " ", "M"}]}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
        SuperscriptBox["c1", "M"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "c1"}], ")"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "c1", "+", 
       RowBox[{
        SuperscriptBox["c1", "2"], " ", 
        RowBox[{"(", 
         RowBox[{"6", "+", 
          RowBox[{"3", " ", "c1"}], "+", 
          SuperscriptBox["c1", "3"], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "c1"}], ")"}], " ", 
           SuperscriptBox["c1", 
            RowBox[{"1", "+", 
             RowBox[{"2", " ", "M"}]}]]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["c1", "M"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             SuperscriptBox["c1", "2"]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"4", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
    RowBox[{"c1", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["c1", "4"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"6", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}], "+", 
       RowBox[{"c1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SuperscriptBox["c1", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"8", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 3.766480245025821*^9, 
  3.7664811373446846`*^9},ExpressionUUID->"7477d12c-f8eb-47f7-935c-\
3e28f06688cb"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.766468863887048*^9, 3.7664690298892984`*^9, 
  3.766469062400839*^9, 3.766469270239795*^9, 3.7664693162365713`*^9, 
  3.766469519921857*^9, 3.766480245025821*^9, 
  3.7664811373471794`*^9},ExpressionUUID->"de448bf8-3963-4894-a2e8-\
32c5e7b2e106"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7664697134439893`*^9, 
  3.7664697341625495`*^9}},ExpressionUUID->"0ec120d5-3a18-4e1e-a35f-\
4dd26aece6da"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Correlations of ",
 Cell[BoxData[
  FormBox["Re", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "20a4878a-218e-4024-8c6e-1d99cecb7f52"],
 " Jk(\[Lambda]1) ",
 Cell[BoxData[
  FormBox["Re", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "25bd70c4-58d3-408a-a275-b3a7d7fc4cf5"],
 " Jk(\[Lambda]2) for different \[Lambda]"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 
  3.7664824286501465`*^9}},ExpressionUUID->"fa13d576-3bd9-4722-a7f1-\
b2c9e31131c2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}},ExpressionUUID->"4d0ddf83-04a4-42b9-a8bf-\
2d1b238d6839"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
  3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
  3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
  3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
  3.76648269757901*^9}},ExpressionUUID->"ca785982-65b0-4278-b49a-\
5842f9b88517"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 
   3.7664827191523604`*^9}},ExpressionUUID->"a97e2445-9d36-45be-a5cd-\
77a3c4e5f2af"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 
   3.7664827273795996`*^9}},ExpressionUUID->"8f8af71c-b95e-4298-a941-\
251ecb218cc2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"b4998b25-2f84-4bcc-a38c-\
2ac71b7c83cc"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 
  3.7664838408731704`*^9}},ExpressionUUID->"86bce02d-f1d7-4786-b3d3-\
6681e1a2b62a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", "c2"}]}], ")"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   "M", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"c1", " ", "c2"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c1", "+", "c2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c2"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9},ExpressionUUID->"5da33615-2117-45c3-8ea7-\
97ded4271d8c"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", "c2"}]}], ")"}], " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"c1", " ", "c2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c1", "+", "c2"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c1", "2"], "-", 
      RowBox[{"2", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c2", "2"], "-", 
      RowBox[{"2", " ", "c2", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.766483847361272*^9},ExpressionUUID->"46df8b02-f7d5-4b18-ba9f-\
86cf6c66fab6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"a1", "/.", 
    RowBox[{"c2", "\[Rule]", "c1"}]}], "]"}], "*", 
  FractionBox[
   SuperscriptBox["dt", "2"], 
   RowBox[{"2", "\[Lambda]1"}]]}]], "Input",
 CellChangeTimes->{{3.766483844666259*^9, 
  3.7664838744729595`*^9}},ExpressionUUID->"ae5b048b-e3a7-4670-9e8a-\
9e16c3c5c10d"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "2"]}], ")"}], " ", 
   SuperscriptBox["dt", "2"], " ", "M", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{"\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["c1", "2"], "-", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.766483851571238*^9, 
  3.766483875824229*^9}},ExpressionUUID->"e1f8f5c0-ee47-4a95-854b-\
45a321ff3d2d"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Correlations of ",
 Cell[BoxData[
  FormBox["Im", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "68da84bc-15ae-4b11-b7b2-7de97b87d42b"],
 " Jk(\[Lambda]1) ",
 Cell[BoxData[
  FormBox["Im", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "d64720fc-33ec-43eb-8bf7-e955c8a4c2a8"],
 " Jk(\[Lambda]2) for different \[Lambda]"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 3.7664824286501465`*^9}, {3.7664842757537704`*^9, 
  3.7664842800347753`*^9}, {3.766484324131431*^9, 
  3.7664843264496436`*^9}},ExpressionUUID->"9f988df6-87cc-45d2-9f04-\
8e1af2498198"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";", "56"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}, {3.766484282314014*^9, 3.766484286714978*^9}, {
  3.7664844257375526`*^9, 
  3.766484425952176*^9}},ExpressionUUID->"b59f2b12-78eb-4674-b308-\
707760322427"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
  3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
  3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
  3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
  3.76648269757901*^9}, {3.766484291434763*^9, 
  3.76648429295444*^9}},ExpressionUUID->"faa9fa9c-064b-48d8-baac-\
3971aa1d003c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 3.7664827191523604`*^9}, {3.766484297819396*^9, 
   3.7664842988664503`*^9}},ExpressionUUID->"509baeef-347d-4f50-894e-\
6e9c27f10351"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 3.7664827273795996`*^9}, {
   3.7664843019786863`*^9, 
   3.7664843032503*^9}},ExpressionUUID->"02497914-3c6b-4165-bb3d-\
1524f2dafce6"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"355da3b0-4188-4731-b9c9-\
0f0ba002e4c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 
  3.7664838408731704`*^9}},ExpressionUUID->"7b319940-5c66-4e21-8505-\
ec492da6c5c8"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", "c2"}]}], ")"}], " ", 
   SuperscriptBox["\[ExponentialE]", 
    FractionBox[
     RowBox[{"4", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]], " ", 
   "M", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     RowBox[{"c1", " ", "c2"}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"c1", "+", "c2"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c1"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "c2"}], "+", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
    ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c1", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"c2", " ", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
        "M"]]}]}], ")"}]}]]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.76648452409721*^9, 
   3.766484659808832*^9},ExpressionUUID->"0ff27624-0c67-4b7b-826d-\
658e3a31e6d7"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", "c2"}]}], ")"}], " ", "M", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "-", 
      RowBox[{"c1", " ", "c2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"c1", "+", "c2"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c1", "2"], "-", 
      RowBox[{"2", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c2", "2"], "-", 
      RowBox[{"2", " ", "c2", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.76648452409721*^9, 
   3.766484661588026*^9},ExpressionUUID->"f5daf607-ccf0-46f2-abae-\
856a6002a738"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"a1", "/.", 
    RowBox[{"c2", "\[Rule]", "c1"}]}], "]"}], "*", 
  FractionBox[
   SuperscriptBox["dt", "2"], 
   RowBox[{"2", "\[Lambda]1"}]]}]], "Input",
 CellChangeTimes->{{3.766483844666259*^9, 
  3.7664838744729595`*^9}},ExpressionUUID->"abdb93d5-526d-4270-98cf-\
ae9214969aa9"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "2"]}], ")"}], " ", 
   SuperscriptBox["dt", "2"], " ", "M", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{"\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["c1", "2"], "-", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.766483851571238*^9, 3.766483875824229*^9}, 
   3.766484646912385*^9},ExpressionUUID->"93c51aab-b014-4eab-acdb-\
94538892ff06"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Checking the cross-term Re Jk(\[Lambda]1) ",
 Cell[BoxData[
  FormBox["Im", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "f17f9aa9-5beb-4880-914f-94561bb63b7c"],
 " Jk(\[Lambda]2) for different \[Lambda]"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 3.7664824286501465`*^9}, {3.7664842757537704`*^9, 
  3.7664842800347753`*^9}, {3.766484324131431*^9, 3.7664843264496436`*^9}, {
  3.7664865524552107`*^9, 
  3.7664865639352355`*^9}},ExpressionUUID->"38cde4d3-4276-45c8-90e8-\
ffcd9f8d2488"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}, {3.766484282314014*^9, 3.766484286714978*^9}, {
  3.7664844257375526`*^9, 3.766484425952176*^9}, {3.7664865699759502`*^9, 
  3.7664865729836493`*^9}},ExpressionUUID->"4ae73b52-ec70-4b4d-b098-\
1671662a3bc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
  3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
  3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
  3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
  3.76648269757901*^9}, {3.766484291434763*^9, 3.76648429295444*^9}, {
  3.7664865789919863`*^9, 
  3.766486579391266*^9}},ExpressionUUID->"105566bb-301b-4088-8891-\
dff7a1951bb0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 3.7664827191523604`*^9}, {3.766484297819396*^9, 
   3.7664842988664503`*^9}, {3.7664865825678387`*^9, 
   3.7664865829356546`*^9}},ExpressionUUID->"bc3da9eb-6e82-41b4-a2b2-\
f8d38a590c5d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 3.7664827273795996`*^9}, {
   3.7664843019786863`*^9, 3.7664843032503*^9}, {3.766486585976033*^9, 
   3.7664865863358345`*^9}},ExpressionUUID->"78cb6ff4-de9e-4feb-8e7e-\
a6a9d2d0c2e0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"6557a614-e567-43c4-bde3-\
6e83d7eee14c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a1", "+", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"a1", "/.", 
       RowBox[{"c2", "\[Rule]", "c3"}]}], "/.", 
      RowBox[{"c1", "\[Rule]", "c2"}]}], "/.", 
     RowBox[{"c3", "\[Rule]", "c1"}]}], ")"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 3.7664838408731704`*^9}, {3.766486874975713*^9, 
  3.7664868755511513`*^9}, {3.76648695139177*^9, 3.766486979502854*^9}, {
  3.7664871831518145`*^9, 
  3.766487220190033*^9}},ExpressionUUID->"197d7d14-3387-494f-96c3-\
f1288cdef83e"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{"c1", "-", "c2"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", "c2"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}],
       ")"}], "3"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], " ", "M"}], 
   RowBox[{"4", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "c1"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "c2"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], "M"]]}], 
     ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c1", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"c2", " ", 
       SuperscriptBox["\[ExponentialE]", 
        FractionBox[
         RowBox[{"2", " ", "\[ImaginaryI]", " ", "k", " ", "\[Pi]"}], 
         "M"]]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.76648452409721*^9, 3.766484659808832*^9, 
   3.7664868418703165`*^9, 3.766486879732378*^9, {3.7664869558594003`*^9, 
   3.7664869834744925`*^9}, {3.766487207684943*^9, 
   3.7664872241436834`*^9}},ExpressionUUID->"1d2948aa-ce70-4862-94d2-\
795571541ffc"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"16", " ", "c1", " ", "c2", " ", "M", " ", 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", 
      FractionBox[
       RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "3"], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "-", 
        RowBox[{"Log", "[", "c2", "]"}]}], ")"}]}], "]"}], " ", 
    RowBox[{"Sinh", "[", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "+", 
        RowBox[{"Log", "[", "c2", "]"}]}], ")"}]}], "]"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c1", "2"], "-", 
      RowBox[{"2", " ", "c1", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      SuperscriptBox["c2", "2"], "-", 
      RowBox[{"2", " ", "c2", " ", 
       RowBox[{"Cos", "[", 
        FractionBox[
         RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.76648452409721*^9, 3.766484659808832*^9, 
   3.7664868418703165`*^9, 3.766486879732378*^9, {3.7664869558594003`*^9, 
   3.7664869834744925`*^9}, {3.766487207684943*^9, 
   3.766487225608979*^9}},ExpressionUUID->"4ff300b9-eb1b-4a3b-aca8-\
565093139d2b"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.76648452409721*^9, 3.766484659808832*^9, 
   3.7664868418703165`*^9, 3.766486879732378*^9, {3.7664869558594003`*^9, 
   3.7664869834744925`*^9}, {3.766487207684943*^9, 
   3.7664872256134725`*^9}},ExpressionUUID->"b820dc20-69a4-45db-9750-\
debbebae71e4"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Correlations of ",
 Cell[BoxData[
  FormBox["Re", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "cf1767c6-0c9e-4abf-a2fb-970feccd143e"],
 " Jk(\[Lambda]1) ",
 Cell[BoxData[
  FormBox["Re", TraditionalForm]],
  FormatType->"TraditionalForm",ExpressionUUID->
  "e117a8d8-6e9d-4b89-a75a-691ab5ab74d2"],
 " Jl(\[Lambda]2) for different \[Lambda] and different frequencies!"
}], "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 3.7664824286501465`*^9}, {3.7664877075822225`*^9, 
  3.7664877156061163`*^9}},ExpressionUUID->"b0d7152a-45e2-4106-9d90-\
efdedcdf1d8d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}, {3.76648771991111*^9, 
  3.766487721486635*^9}},ExpressionUUID->"35a2721d-b707-4a65-8687-\
b75da19a43a7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
   3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
   3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
   3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
   3.76648269757901*^9}, 
   3.766487728262836*^9},ExpressionUUID->"05db5e84-253a-4ee1-b3d2-\
24fb4241f195"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 3.7664827191523604`*^9}, 
   3.7664877339427767`*^9},ExpressionUUID->"64038d67-5fa4-43bf-add6-\
38ea6b0915c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 3.7664827273795996`*^9}, 
   3.7664877367266235`*^9},ExpressionUUID->"6e14a879-efaa-4ba8-9f52-\
da65dd49e18f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"3b02575c-ed8a-47d0-9a17-\
0e818cdf0f63"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 
  3.7664838408731704`*^9}},ExpressionUUID->"71e0a5b1-cf9b-4dfc-9ccd-\
cf43e98bca5f"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 
   3.7664880175797663`*^9},ExpressionUUID->"31b68582-2af4-4683-a40c-\
87c1fd0482fa"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 
   3.7664880175837584`*^9},ExpressionUUID->"01a4c05d-b970-426d-8f56-\
fc6895ab5eba"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{"a1", "/.", 
    RowBox[{"c2", "\[Rule]", "c1"}]}], "]"}], "*", 
  FractionBox[
   SuperscriptBox["dt", "2"], 
   RowBox[{"2", "\[Lambda]1"}]]}]], "Input",
 CellChangeTimes->{{3.766483844666259*^9, 
  3.7664838744729595`*^9}},ExpressionUUID->"b3a27caa-d440-4166-8ec3-\
e5472a8f09cb"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     SuperscriptBox["c1", "2"]}], ")"}], " ", 
   SuperscriptBox["dt", "2"], " ", "M", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"k", " ", "\[Pi]"}], "M"], "]"}], "2"]}], 
  RowBox[{"\[Lambda]1", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     SuperscriptBox["c1", "2"], "-", 
     RowBox[{"2", " ", "c1", " ", 
      RowBox[{"Cos", "[", 
       FractionBox[
        RowBox[{"2", " ", "k", " ", "\[Pi]"}], "M"], "]"}]}]}], 
    ")"}]}]]], "Output",
 CellChangeTimes->{{3.766483851571238*^9, 
  3.766483875824229*^9}},ExpressionUUID->"9a8debf6-c49d-441e-90dc-\
7c7be6788384"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Correlations of Im Jk(\[Lambda]1) Im Jl(\[Lambda]2) for different \[Lambda] \
and different frequencies!\
\>", "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 3.7664824286501465`*^9}, {3.7664877075822225`*^9, 
  3.7664877156061163`*^9}, {3.7664887133507223`*^9, 
  3.766488719020859*^9}},ExpressionUUID->"fc9afbfe-3a44-4bcb-820d-\
e9ac7f67d9be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}, {3.76648771991111*^9, 3.766487721486635*^9}, {
  3.7664887233982058`*^9, 
  3.7664887279030333`*^9}},ExpressionUUID->"cc9c5425-0663-455c-b7d9-\
5c97610f4968"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
   3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
   3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
   3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
   3.76648269757901*^9}, 3.766487728262836*^9, {3.766488730014603*^9, 
   3.7664887310146823`*^9}},ExpressionUUID->"2dbeb19f-21ca-4f5f-8e54-\
d73de35c4d9b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 3.7664827191523604`*^9}, 3.7664877339427767`*^9, {
   3.7664887352866383`*^9, 
   3.766488736526335*^9}},ExpressionUUID->"4786f861-b8da-473a-a3bc-\
be463cafc04a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 3.7664827273795996`*^9}, 
   3.7664877367266235`*^9, {3.7664887409998555`*^9, 
   3.7664887421587014`*^9}},ExpressionUUID->"3c30bb7f-37ba-406c-91ae-\
554160285964"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"5f7033a5-d0d6-4b1a-988d-\
06919f4f89e9"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 
  3.7664838408731704`*^9}},ExpressionUUID->"6e37866c-644d-4285-8f00-\
3b81f5a0bd50"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.7664880175797663`*^9, 
   3.7664889784501977`*^9},ExpressionUUID->"3bdf2416-c64b-4296-aace-\
ca0a2b819b6d"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.7664880175797663`*^9, 
   3.7664889784541903`*^9},ExpressionUUID->"a6163722-5f46-448a-869e-\
bb4a7188a4d3"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Checking the cross-term of Re Jk(\[Lambda]1) Im Jl(\[Lambda]2) for different \
\[Lambda] and different frequencies!\
\>", "Subsection",
 CellChangeTimes->{{3.766469392457639*^9, 3.7664694158113227`*^9}, {
  3.766482396258108*^9, 3.7664824286501465`*^9}, {3.7664877075822225`*^9, 
  3.7664877156061163`*^9}, {3.7664887133507223`*^9, 3.766488719020859*^9}, {
  3.7664888078055305`*^9, 
  3.7664888154772687`*^9}},ExpressionUUID->"ceb57294-8aab-41f1-88fb-\
ba45cc01bb60"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c1"}], ")"}], 
    RowBox[{"(", 
     RowBox[{"1", "-", "c2"}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r1", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.76646807071599*^9, 3.766468088611476*^9}, {
  3.766468127075493*^9, 3.766468127196268*^9}, {3.766468200421815*^9, 
  3.766468312843487*^9}, {3.766468903080077*^9, 3.7664689310028715`*^9}, {
  3.76648243984177*^9, 3.766482454995144*^9}, {3.7664827041385016`*^9, 
  3.7664827088759966`*^9}, {3.76648771991111*^9, 3.766487721486635*^9}, {
  3.7664887233982058`*^9, 3.7664887279030333`*^9}, {3.7664888194618826`*^9, 
  3.766488819765798*^9}},ExpressionUUID->"8ba65266-f50d-491e-9f6a-\
e385f3c238dc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "m"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"c1", " ", "c2"}], ")"}], 
    RowBox[{"-", "n"}]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r2", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r2", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7664684396440134`*^9, 3.766468482757122*^9}, {
   3.7664685166353455`*^9, 3.7664685575231*^9}, {3.7664686893736725`*^9, 
   3.7664687009977393`*^9}, {3.7664687598114276`*^9, 3.76646876023464*^9}, {
   3.7664824817480154`*^9, 3.7664825191774373`*^9}, {3.7664826842272797`*^9, 
   3.76648269757901*^9}, 3.766487728262836*^9, {3.766488730014603*^9, 
   3.7664887310146823`*^9}, {3.766488823286273*^9, 
   3.76648882371795*^9}},ExpressionUUID->"02458eb6-dc0f-455b-9b0e-\
61ef5480e156"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "+", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", "m"}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c1", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"n", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3a", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3a", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, {3.7664825455294514`*^9, 3.7664825841301985`*^9}, {
   3.766482712641816*^9, 3.7664827191523604`*^9}, 3.7664877339427767`*^9, {
   3.7664887352866383`*^9, 3.766488736526335*^9}, {3.7664888289103203`*^9, 
   3.7664888292940855`*^9}},ExpressionUUID->"ca6df228-e769-4888-bc51-\
addfcf848629"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"n_", ",", "m_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cos", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "k", " ", "n"}], "M"], "]"}], 
    RowBox[{"Sin", "[", 
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", "l", " ", "m"}], "M"], "]"}], 
    SuperscriptBox["c1", "n"], 
    SuperscriptBox["c2", "m"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mChangePoint", " ", "=", " ", 
   RowBox[{"n", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"beforeChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{"m", "+", "1"}], ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"afterChangePoint", "=", 
   RowBox[{"c2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"c1", " ", "c2"}], ")"}], 
     RowBox[{"-", 
      RowBox[{"(", "n", ")"}]}]]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s1", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "beforeChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", "mChangePoint"}], "}"}]}], "]"}], "+", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{"n", ",", "m"}], "]"}], "afterChangePoint"}], ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", 
        RowBox[{"mChangePoint", "+", "1"}], ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r3b", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{"s1", ",", 
      RowBox[{"{", 
       RowBox[{"n", ",", "0", ",", 
        RowBox[{"M", "-", "2"}]}], "}"}]}], "]"}], "+", "\[IndentingNewLine]", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"f", "[", 
        RowBox[{
         RowBox[{"M", "-", "1"}], ",", "m"}], "]"}], "beforeChangePoint"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"m", ",", "0", ",", 
        RowBox[{"M", "-", "1"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"r3b", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"q1", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"k", "\[Element]", "Integers"}], "}"}]}]}], "]"}]}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.766468768658502*^9, 3.7664688248104224`*^9}, 
   3.766482483620036*^9, 3.7664825473056273`*^9, {3.766482585057979*^9, 
   3.766482653785191*^9}, {3.7664827233534927`*^9, 3.7664827273795996`*^9}, 
   3.7664877367266235`*^9, {3.7664887409998555`*^9, 3.7664887421587014`*^9}, {
   3.7664888327177415`*^9, 
   3.7664888331174994`*^9}},ExpressionUUID->"9dd0abc3-4c62-4a8f-9d2f-\
3e4edc6f1ab9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Extract main term", "Subsection",
 CellChangeTimes->{{3.7664692430823*^9, 
  3.766469245810182*^9}},ExpressionUUID->"33e185e7-fb30-4eb6-a713-\
5ddfbc10b340"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rSum", "=", 
   RowBox[{"r1", "+", "r2", "+", "r3a", "+", "r3b"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{"rSum", ",", "M"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"M", " ", 
    RowBox[{"Coefficient", "[", 
     RowBox[{"rSum", ",", "M", ",", "1"}], "]"}]}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"k", "\[Element]", "Integers"}], ",", 
      RowBox[{"M", "\[Element]", "Integers"}]}], "}"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"a1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{"c1", "\[Rule]", 
        RowBox[{"Exp", "[", 
         RowBox[{"\[Lambda]1", " ", "dt"}], "]"}]}]}], "/.", 
      RowBox[{"c2", "\[Rule]", 
       RowBox[{"Exp", "[", 
        RowBox[{"\[Lambda]2", " ", "dt"}], "]"}]}]}], "]"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Lambda]1", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c1", "]"}], "/", "dt"}]}], ",", 
      RowBox[{"\[Lambda]2", "\[Rule]", 
       RowBox[{
        RowBox[{"Log", "[", "c2", "]"}], "/", "dt"}]}]}], "}"}]}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.7664688344183064`*^9, 3.766468839243338*^9}, {
  3.766468999571623*^9, 3.7664690382032194`*^9}, {3.766469189362796*^9, 
  3.7664691909947405`*^9}, {3.766469225338373*^9, 3.766469238874016*^9}, {
  3.766469287594565*^9, 3.7664692927222567`*^9}, {3.7664694939706078`*^9, 
  3.7664694954658318`*^9}, {3.7664827312104993`*^9, 3.766482733538083*^9}, {
  3.76648337279521*^9, 3.766483393504566*^9}, {3.7664834314663067`*^9, 
  3.7664834412645936`*^9}, {3.766483589888839*^9, 3.7664837202247725`*^9}, {
  3.766483840633638*^9, 
  3.7664838408731704`*^9}},ExpressionUUID->"621ce744-9075-4412-be9d-\
2477603f1a9c"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.7664880175797663`*^9, 
   3.766489279685959*^9},ExpressionUUID->"851db36b-f746-4c51-8cb6-\
8c4fff1f0546"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.766468863887048*^9, 3.7664690298892984`*^9, 3.766469062400839*^9, 
   3.766469270239795*^9, 3.7664693162365713`*^9, 3.766469519921857*^9, 
   3.766483369715125*^9, {3.766483433242885*^9, 3.7664834452503567`*^9}, 
   3.7664836156060333`*^9, {3.7664836699342537`*^9, 3.7664837246974745`*^9}, 
   3.7664838456090326`*^9, 3.7664880175797663`*^9, 
   3.7664892796889544`*^9},ExpressionUUID->"16164efa-dd54-412a-8474-\
81da3947e63c"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1247, 886},
WindowMargins->{{-1321, Automatic}, {Automatic, 54}},
FrontEndVersion->"11.1 for Microsoft Windows (64-bit) (March 13, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2984, 80, 193, "Input", "ExpressionUUID" -> \
"dca4d28d-57d5-4894-9514-37b4b0fbbe1e"],
Cell[3567, 104, 10854, 300, 354, "Output", "ExpressionUUID" -> \
"68816de7-f78f-42e4-a54d-95a4fc8c0aa3"],
Cell[14424, 406, 12502, 340, 428, "Output", "ExpressionUUID" -> \
"07849500-6b1e-407b-a818-697541e5f37d"],
Cell[26929, 748, 1101, 33, 105, "Output", "ExpressionUUID" -> \
"580ac88d-dc43-4191-8497-bb5ba0046496"]
}, Open  ]],
Cell[28045, 784, 131, 3, 38, "Input", "ExpressionUUID" -> \
"b2c2c9f0-5102-4903-89c5-8dc9a2a53292"],
Cell[CellGroupData[{
Cell[28201, 791, 662, 19, 91, "Input", "ExpressionUUID" -> \
"339f6084-0a89-4246-82dc-cc587b941c77"],
Cell[28866, 812, 1091, 32, 117, "Output", "ExpressionUUID" -> \
"42e6bc26-fc44-41be-b427-021fd815472c"],
Cell[29960, 846, 508, 14, 86, "Output", "ExpressionUUID" -> \
"a73310ab-32bd-40c2-887b-36f922d88d2a"]
}, Open  ]],
Cell[30483, 863, 413, 10, 63, "Input", "ExpressionUUID" -> \
"fad89883-d920-4daf-8de6-fa0a1bce06d7"],
Cell[CellGroupData[{
Cell[30921, 877, 194, 3, 59, "Subsection", "ExpressionUUID" -> \
"96fcbbb9-1acf-4ca5-8f8f-3b6eafd3a089"],
Cell[CellGroupData[{
Cell[31140, 884, 4757, 127, 292, "Input", "ExpressionUUID" -> \
"7293cdf8-011a-40fd-a637-c49ca2a3fb22"],
Cell[35900, 1013, 28627, 705, 660, "Output", "ExpressionUUID" -> \
"8c60258a-b0a0-45ad-b192-1976e0695e3f"],
Cell[64530, 1720, 581, 9, 38, "Output", "ExpressionUUID" -> \
"636154cb-eb42-4ddb-84e0-6a661504a7a3"],
Cell[65114, 1731, 6017, 160, 240, "Output", "ExpressionUUID" -> \
"53a06714-9d50-4e17-86c9-40ac20c5baf5"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71180, 1897, 192, 3, 59, "Subsection", "ExpressionUUID" -> \
"059d54ad-da05-4b41-a580-ee7195deb974"],
Cell[CellGroupData[{
Cell[71397, 1904, 824, 22, 63, "Input", "ExpressionUUID" -> \
"e438a462-12b6-4fe1-9db2-17ee8c5659b3"],
Cell[72224, 1928, 848, 25, 103, "Output", "ExpressionUUID" -> \
"afa9b233-eb19-4ae3-9579-502ac9e93026"],
Cell[73075, 1955, 848, 25, 103, "Output", "ExpressionUUID" -> \
"ec3477ee-d295-4316-87a0-707519055e64"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[73972, 1986, 182, 3, 59, "Subsection", "ExpressionUUID" -> \
"5ba8377d-7d6b-47bf-a00a-818aaba0c48a"],
Cell[CellGroupData[{
Cell[74179, 1993, 2323, 72, 243, "Input", "ExpressionUUID" -> \
"2c3659f6-1370-4edd-8612-9a3a260bcd3e"],
Cell[76505, 2067, 827, 25, 103, "Output", "ExpressionUUID" -> \
"9faaf13f-ad15-4f73-9d45-243ebd36cc8a"],
Cell[77335, 2094, 827, 25, 103, "Output", "ExpressionUUID" -> \
"d0d5057d-5069-4a19-bd73-74adfe946680"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78199, 2124, 2300, 64, 155, "Input", "ExpressionUUID" -> \
"63858b41-701c-4c48-8ebd-19d239851cad"],
Cell[80502, 2190, 1655, 51, 103, "Output", "ExpressionUUID" -> \
"00c5ec5a-f1c8-45bc-aacb-60e986545ce8"],
Cell[82160, 2243, 252, 4, 38, "Output", "ExpressionUUID" -> \
"56ff22f3-e156-43b7-b622-111c9922e56c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82449, 2252, 1834, 55, 155, "Input", "ExpressionUUID" -> \
"07bb340e-8f35-4136-9711-a61c0ba940c0"],
Cell[84286, 2309, 1612, 51, 103, "Output", "ExpressionUUID" -> \
"dc62b412-e449-464b-8304-3477e9a38b50"],
Cell[85901, 2362, 1054, 32, 116, "Output", "ExpressionUUID" -> \
"57220b4c-b0eb-423d-aaf1-5ecda0da9c9d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87004, 2400, 195, 3, 59, "Subsection", "ExpressionUUID" -> \
"002ecf63-5fa7-4eec-979e-a863db239998"],
Cell[CellGroupData[{
Cell[87224, 2407, 5298, 174, 278, "Input", "ExpressionUUID" -> \
"c1e51659-6b51-48d3-a701-676f2b60ef5a"],
Cell[92525, 2583, 1155, 37, 71, "Output", "ExpressionUUID" -> \
"08940d9a-b853-4502-9f50-7d251a185645"]
}, Open  ]],
Cell[93695, 2623, 192, 4, 38, "Input", "ExpressionUUID" -> \
"7d731b1b-9e26-48f8-b931-e10e23352560"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93924, 2632, 157, 3, 59, "Subsection", "ExpressionUUID" -> \
"c04d8881-cca8-453a-9566-331f977a9f0e"],
Cell[CellGroupData[{
Cell[94106, 2639, 2938, 87, 184, "Input", "ExpressionUUID" -> \
"efc22d12-53d7-4175-a435-d1e27b6b35f1"],
Cell[97047, 2728, 3964, 121, 118, "Output", "ExpressionUUID" -> \
"62b98cc6-1200-4c93-b9fd-3552f13f681e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101048, 2854, 708, 17, 87, "Input", "ExpressionUUID" -> \
"8eeab739-11df-47b8-bb5a-32521bc4421d"],
Cell[101759, 2873, 2001, 62, 90, "Output", "ExpressionUUID" -> \
"bc5914ae-20df-429a-94eb-a81b543527bc"],
Cell[103763, 2937, 470, 12, 56, "Output", "ExpressionUUID" -> \
"11255539-35cb-4186-bc8f-486a7600c0d0"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104282, 2955, 159, 3, 59, "Subsection", "ExpressionUUID" -> \
"27386490-dec5-419b-a3a4-915e7cf48c79"],
Cell[CellGroupData[{
Cell[104466, 2962, 1188, 40, 70, "Input", "ExpressionUUID" -> \
"39d7dd12-ff30-42dc-9157-54e0b806a3ad"],
Cell[105657, 3004, 586, 18, 66, "Output", "ExpressionUUID" -> \
"d9c865d7-bf48-42cf-8135-e95246b57750"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[106292, 3028, 253, 4, 59, "Subsection", "ExpressionUUID" -> \
"dcb988cd-052c-4900-85e1-e5feb38158f6"],
Cell[CellGroupData[{
Cell[106570, 3036, 2609, 80, 151, "Input", "ExpressionUUID" -> \
"e352ca28-5c0e-4878-8a82-502661224b96"],
Cell[109182, 3118, 1849, 57, 84, "Output", "ExpressionUUID" -> \
"bf4f956d-2b28-4e3b-96f3-78ca2b6d3e20"],
Cell[111034, 3177, 1052, 30, 66, "Output", "ExpressionUUID" -> \
"9a9135fe-b387-4f43-a818-d477df32f99d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112123, 3212, 547, 16, 42, "Input", "ExpressionUUID" -> \
"17c2fad9-29ea-4b4a-9f0d-369de33e7513"],
Cell[112673, 3230, 321, 10, 64, "Output", "ExpressionUUID" -> \
"78c7e16f-ac07-4786-9c70-a640f22dd517"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113043, 3246, 154, 3, 59, "Subsection", "ExpressionUUID" -> \
"81292241-0483-4951-8112-678031abad0a"],
Cell[CellGroupData[{
Cell[113222, 3253, 859, 25, 67, "Input", "ExpressionUUID" -> \
"5c0a501f-5a51-4933-842e-39e5cc98aaca"],
Cell[114084, 3280, 777, 24, 63, "Output", "ExpressionUUID" -> \
"edbd7e3a-cf73-4fc9-91b8-337e6395a039"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114910, 3310, 323, 5, 59, "Subsection", "ExpressionUUID" -> \
"756ddf52-da39-4d6d-b33c-606528c6759e"],
Cell[CellGroupData[{
Cell[115258, 3319, 2268, 63, 190, "Input", "ExpressionUUID" -> \
"3d4649be-7cb4-44d4-9c60-c151150b9a2f"],
Cell[117529, 3384, 3361, 106, 144, "Output", "ExpressionUUID" -> \
"783c4a31-5152-4a1c-a3d8-ddf881dbfa11"],
Cell[120893, 3492, 813, 19, 56, "Output", "ExpressionUUID" -> \
"0df3ce67-9e79-4245-b4bc-c37d016eb04a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121743, 3516, 852, 26, 64, "Input", "ExpressionUUID" -> \
"86fb176f-5d39-42ae-bd1f-9f3ca67d62e0"],
Cell[122598, 3544, 781, 26, 57, "Output", "ExpressionUUID" -> \
"1177da32-ca3f-4266-a083-a696eeeb63c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123416, 3575, 1575, 48, 117, "Input", "ExpressionUUID" -> \
"97ea8bbf-f829-4a55-841e-1dcd8de75423"],
Cell[124994, 3625, 534, 17, 56, "Output", "ExpressionUUID" -> \
"4f8c40f3-d2b4-47a5-9b99-1fa1750f9449"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[125577, 3648, 380, 7, 59, "Subsection", "ExpressionUUID" -> \
"3329dc86-f0d2-4b4f-86df-b5c7e5b866c3"],
Cell[CellGroupData[{
Cell[125982, 3659, 3043, 84, 241, "Input", "ExpressionUUID" -> \
"53cd55e9-35bc-43ba-871c-0673287d2c7f"],
Cell[129028, 3745, 10559, 287, 409, "Output", "ExpressionUUID" -> \
"a2ec97a6-2ad6-4dda-81fd-fb29d61b80f2"],
Cell[139590, 4034, 3922, 125, 145, "Output", "ExpressionUUID" -> \
"c416b5a7-7b42-40f5-85db-7e90eaa97196"]
}, Open  ]],
Cell[CellGroupData[{
Cell[143549, 4164, 838, 24, 113, "Input", "ExpressionUUID" -> \
"4c1c39cc-0503-445d-8e89-559c2c2dcb14"],
Cell[144390, 4190, 722, 22, 57, "Output", "ExpressionUUID" -> \
"cae0ebf5-9052-43bd-ab6f-054429d08a79"],
Cell[145115, 4214, 744, 23, 57, "Output", "ExpressionUUID" -> \
"9d621c4b-8557-4b15-b023-3e2421073b65"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145896, 4242, 2725, 79, 224, "Input", "ExpressionUUID" -> \
"bfeb89b9-adf9-4791-ac07-d4a0e531514a"],
Cell[148624, 4323, 3875, 109, 204, "Output", "ExpressionUUID" -> \
"47190b7d-e080-4eae-8993-daf000cb699b"],
Cell[152502, 4434, 1112, 35, 118, "Output", "ExpressionUUID" -> \
"0e8b9dda-6eff-4f1c-8890-7ad36b9db0ae"]
}, Open  ]],
Cell[153629, 4472, 147, 3, 63, "Input", "ExpressionUUID" -> \
"daf4978f-a533-4a01-bab2-204ffbb94f2c"],
Cell[CellGroupData[{
Cell[153801, 4479, 1792, 58, 162, "Input", "ExpressionUUID" -> \
"09f24211-e7c7-4531-a99d-e3e599456dae"],
Cell[155596, 4539, 784, 26, 56, "Output", "ExpressionUUID" -> \
"2e617ad9-3b1c-4d60-aa60-979d957fef58"],
Cell[156383, 4567, 345, 10, 56, "Output", "ExpressionUUID" -> \
"6cdabb43-6b64-4222-9fff-d03fec06ba04"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156765, 4582, 1557, 52, 135, "Input", "ExpressionUUID" -> \
"9db94fdc-72e6-43bd-b35a-a26cf0a8b6a6"],
Cell[158325, 4636, 320, 10, 55, "Output", "ExpressionUUID" -> \
"fe282476-6149-4dd4-acc4-87b36c122d34"],
Cell[158648, 4648, 357, 12, 55, "Output", "ExpressionUUID" -> \
"67a8897f-3c3f-4abb-b405-b029071a730c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159042, 4665, 1753, 57, 162, "Input", "ExpressionUUID" -> \
"a4a8a99e-f5e8-43e9-8e49-32f5665cee93"],
Cell[160798, 4724, 3603, 123, 188, "Output", "ExpressionUUID" -> \
"7dada667-679b-46b3-a291-f31add99234a"],
Cell[164404, 4849, 414, 13, 56, "Output", "ExpressionUUID" -> \
"ce25af2a-ce1a-419e-babf-b9e39c27d75d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164855, 4867, 728, 23, 63, "Input", "ExpressionUUID" -> \
"4722cfba-344b-4dee-aa5a-a7c509b2cb96"],
Cell[165586, 4892, 476, 14, 56, "Output", "ExpressionUUID" -> \
"59a13655-2424-4ced-b101-a39360276b34"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[166111, 4912, 189, 3, 59, "Subsection", "ExpressionUUID" -> \
"f65c35e7-a3ae-422d-b138-f0e3398a5f2c"],
Cell[CellGroupData[{
Cell[166325, 4919, 2087, 66, 162, "Input", "ExpressionUUID" -> \
"df1421ae-fa30-474c-989f-2426bd118585"],
Cell[168415, 4987, 569, 16, 56, "Output", "ExpressionUUID" -> \
"32e1e4d8-e3a3-4d6d-9972-6692ca5056a4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169021, 5008, 860, 24, 90, "Input", "ExpressionUUID" -> \
"6447099b-8c61-42cd-963e-cc3a859392ae"],
Cell[169884, 5034, 536, 14, 56, "Output", "ExpressionUUID" -> \
"be540654-3cc9-4f5b-a7f1-056a1018941e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[170457, 5053, 1006, 32, 64, "Input", "ExpressionUUID" -> \
"3bde9613-6eab-41c0-8bed-79f80cc77045"],
Cell[171466, 5087, 694, 22, 57, "Output", "ExpressionUUID" -> \
"e4fbbcaa-0488-4b96-a504-d6e3b37940ff"]
}, Open  ]],
Cell[172175, 5112, 147, 3, 63, "Input", "ExpressionUUID" -> \
"cebe65c4-7876-44d8-82f2-260f1b9bf828"],
Cell[CellGroupData[{
Cell[172347, 5119, 819, 26, 64, "Input", "ExpressionUUID" -> \
"09afb2c6-05ab-4426-b0f6-c29aa10f8a37"],
Cell[173169, 5147, 455, 14, 57, "Output", "ExpressionUUID" -> \
"3fb5312b-a920-4814-a3ce-cb05b90966c3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[173673, 5167, 375, 11, 59, "Subsection", "ExpressionUUID" -> \
"5b1ff323-bd3e-4136-9ff3-c1c81d684fa3"],
Cell[CellGroupData[{
Cell[174073, 5182, 2426, 72, 234, "Input", "ExpressionUUID" -> \
"1e081e19-9877-410d-a2b3-04f87bdd91ec"],
Cell[176502, 5256, 1407, 44, 118, "Output", "ExpressionUUID" -> \
"8c707a80-1e43-47f6-8e30-5f0d01d59fd5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177946, 5305, 2506, 76, 234, "Input", "ExpressionUUID" -> \
"fa70b2c0-7791-4534-94c6-9dbe65dff9a0"],
Cell[180455, 5383, 2138, 65, 109, "Output", "ExpressionUUID" -> \
"423d4cb0-717a-4327-aa99-6a4b625404fa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182630, 5453, 2426, 76, 235, "Input", "ExpressionUUID" -> \
"56fd9fe8-c623-4c5a-b55b-aea1661e83e4"],
Cell[185059, 5531, 2427, 74, 141, "Output", "ExpressionUUID" -> \
"2966bd86-1766-4b9a-ab5c-15da634d376a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[187535, 5611, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"848d2997-c087-43e5-8cdd-da2333e0b36b"],
Cell[CellGroupData[{
Cell[187723, 5618, 971, 22, 87, "Input", "ExpressionUUID" -> \
"8c5851f1-6380-488e-be4f-3d13a7b41354"],
Cell[188697, 5642, 3781, 117, 185, "Output", "ExpressionUUID" -> \
"c4cf3e8d-bede-4c58-98d1-9fdc4f5b39cb"],
Cell[192481, 5761, 7386, 218, 381, "Output", "ExpressionUUID" -> \
"5986a067-16a5-4e8f-81e6-d8ffa9f9a48c"],
Cell[199870, 5981, 1138, 35, 117, "Output", "ExpressionUUID" -> \
"a9b7a18a-c3fd-4281-9fd3-4d6f3d99eec6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[201057, 6022, 525, 13, 59, "Subsection", "ExpressionUUID" -> \
"fe27b432-e75e-4d05-92cf-88a71be32a6f"],
Cell[CellGroupData[{
Cell[201607, 6039, 2479, 73, 234, "Input", "ExpressionUUID" -> \
"9c7f084d-0e4a-48e4-9b96-a549eccb173b"],
Cell[204089, 6114, 1305, 41, 118, "Output", "ExpressionUUID" -> \
"f3498640-df28-4784-aad1-959c3ef51248"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205431, 6160, 2557, 77, 234, "Input", "ExpressionUUID" -> \
"d3a36320-245e-4ff1-846c-f8730cbcabe7"],
Cell[207991, 6239, 1768, 54, 109, "Output", "ExpressionUUID" -> \
"003fdb5e-cb24-4bc1-ad68-ab1ca9c66e63"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209796, 6298, 2475, 77, 235, "Input", "ExpressionUUID" -> \
"33b5c385-40c7-4360-9d3b-be455b1b0e65"],
Cell[212274, 6377, 2073, 64, 109, "Output", "ExpressionUUID" -> \
"386d8fbc-ea0b-43d6-a3a1-445b770b4838"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[214396, 6447, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"d07223d0-e465-4ee2-948a-e8ef8ed2f587"],
Cell[CellGroupData[{
Cell[214584, 6454, 971, 22, 87, "Input", "ExpressionUUID" -> \
"0528cada-105b-4d52-a413-7e7bf9a5cc2f"],
Cell[215558, 6478, 2603, 80, 159, "Output", "ExpressionUUID" -> \
"0212f0b5-ff8a-4425-a8c4-60942c095a6a"],
Cell[218164, 6560, 4326, 130, 229, "Output", "ExpressionUUID" -> \
"f707613f-ac7c-4df2-bfd0-59dc4bd96ee9"],
Cell[222493, 6692, 738, 21, 78, "Output", "ExpressionUUID" -> \
"b1feab5f-d47e-40e4-baf1-d71d67df1ed3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223280, 6719, 275, 5, 59, "Subsection", "ExpressionUUID" -> \
"a8dc7a84-6d9e-4749-8653-c9fb2e55ec9a"],
Cell[223558, 6726, 152, 3, 38, "Input", "ExpressionUUID" -> \
"9a83004c-1916-4a61-a0be-1f5c0aaa56c7"],
Cell[CellGroupData[{
Cell[223735, 6733, 2475, 73, 234, "Input", "ExpressionUUID" -> \
"938d407b-b32c-41d4-b685-ba23c546aa32"],
Cell[226213, 6808, 1475, 45, 109, "Output", "ExpressionUUID" -> \
"a84f8e02-839c-4a0d-992a-c27ffff23cd2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227725, 6858, 2585, 77, 234, "Input", "ExpressionUUID" -> \
"e04a62fd-8173-4bee-a33e-ee88170f9b1f"],
Cell[230313, 6937, 1025, 32, 116, "Output", "ExpressionUUID" -> \
"4748cd63-05e3-42ba-84b3-7095a8582d59"]
}, Open  ]],
Cell[CellGroupData[{
Cell[231375, 6974, 2523, 77, 235, "Input", "ExpressionUUID" -> \
"21cc719c-e1c4-4cb2-994b-d40e5d3e15ad"],
Cell[233901, 7053, 1791, 54, 109, "Output", "ExpressionUUID" -> \
"93e1e77d-0659-43c0-8713-91503c4db0d3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235729, 7112, 2450, 77, 235, "Input", "ExpressionUUID" -> \
"9f675534-9758-4c34-886e-0d01b960a44b"],
Cell[238182, 7191, 2730, 83, 141, "Output", "ExpressionUUID" -> \
"2508e4fa-ba6e-4825-a627-8d587fb046aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[240949, 7279, 218, 5, 38, "Input", "ExpressionUUID" -> \
"c6b1a4ad-c9d3-4ce8-a299-3782d21ea79f"],
Cell[241170, 7286, 2333, 71, 165, "Output", "ExpressionUUID" -> \
"0275806e-796b-4350-8c72-31e9e63bc4e6"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[243552, 7363, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"2d96e7a3-2a81-4944-9cf6-0fff7bdb5b80"],
Cell[CellGroupData[{
Cell[243740, 7370, 1033, 23, 87, "Input", "ExpressionUUID" -> \
"063cc706-b388-44d2-92f4-340b696b216c"],
Cell[244776, 7395, 3077, 94, 160, "Output", "ExpressionUUID" -> \
"167768ac-af26-47a8-bd1f-7ac8f8027a68"],
Cell[247856, 7491, 3079, 94, 160, "Output", "ExpressionUUID" -> \
"7477d12c-f8eb-47f7-935c-3e28f06688cb"],
Cell[250938, 7587, 296, 5, 38, "Output", "ExpressionUUID" -> \
"de448bf8-3963-4894-a2e8-32c5e7b2e106"]
}, Open  ]],
Cell[251249, 7595, 156, 3, 38, "Input", "ExpressionUUID" -> \
"0ec120d5-3a18-4e1e-a35f-4dd26aece6da"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251442, 7603, 581, 16, 59, "Subsection", "ExpressionUUID" -> \
"fa13d576-3bd9-4722-a7f1-b2c9e31131c2"],
Cell[252026, 7621, 2612, 77, 234, "Input", "ExpressionUUID" -> \
"4d0ddf83-04a4-42b9-a8bf-2d1b238d6839"],
Cell[254641, 7700, 2727, 82, 234, "Input", "ExpressionUUID" -> \
"ca785982-65b0-4278-b49a-5842f9b88517"],
Cell[257371, 7784, 2721, 85, 235, "Input", "ExpressionUUID" -> \
"a97e2445-9d36-45be-a5cd-77a3c4e5f2af"],
Cell[260095, 7871, 2770, 86, 236, "Input", "ExpressionUUID" -> \
"8f8af71c-b95e-4298-a941-251ecb218cc2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262902, 7962, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"b4998b25-2f84-4bcc-a38c-2ac71b7c83cc"],
Cell[CellGroupData[{
Cell[263090, 7969, 1924, 49, 111, "Input", "ExpressionUUID" -> \
"86bce02d-f1d7-4786-b3d3-6681e1a2b62a"],
Cell[265017, 8020, 2055, 61, 108, "Output", "ExpressionUUID" -> \
"5da33615-2117-45c3-8ea7-97ded4271d8c"],
Cell[267075, 8083, 1538, 44, 78, "Output", "ExpressionUUID" -> \
"46df8b02-f7d5-4b18-ba9f-86cf6c66fab6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268650, 8132, 346, 10, 67, "Input", "ExpressionUUID" -> \
"ae5b048b-e3a7-4670-9e8a-9e16c3c5c10d"],
Cell[268999, 8144, 717, 23, 78, "Output", "ExpressionUUID" -> \
"e1f8f5c0-ee47-4a95-854b-45a321ff3d2d"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[269765, 8173, 682, 17, 59, "Subsection", "ExpressionUUID" -> \
"9f988df6-87cc-45d2-9f04-8e1af2498198"],
Cell[270450, 8192, 2718, 79, 234, "Input", "ExpressionUUID" -> \
"b59f2b12-78eb-4674-b308-707760322427"],
Cell[273171, 8273, 2775, 83, 234, "Input", "ExpressionUUID" -> \
"faa9fa9c-064b-48d8-baac-3971aa1d003c"],
Cell[275949, 8358, 2769, 85, 235, "Input", "ExpressionUUID" -> \
"509baeef-347d-4f50-894e-6e9c27f10351"],
Cell[278721, 8445, 2820, 87, 236, "Input", "ExpressionUUID" -> \
"02497914-3c6b-4165-bb3d-1524f2dafce6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281578, 8537, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"355da3b0-4188-4731-b9c9-0f0ba002e4c7"],
Cell[CellGroupData[{
Cell[281766, 8544, 1924, 49, 111, "Input", "ExpressionUUID" -> \
"7b319940-5c66-4e21-8505-ec492da6c5c8"],
Cell[283693, 8595, 2102, 62, 108, "Output", "ExpressionUUID" -> \
"0ff27624-0c67-4b7b-826d-658e3a31e6d7"],
Cell[285798, 8659, 1587, 45, 78, "Output", "ExpressionUUID" -> \
"f5daf607-ccf0-46f2-abae-856a6002a738"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287422, 8709, 346, 10, 67, "Input", "ExpressionUUID" -> \
"abdb93d5-526d-4270-98cf-ae9214969aa9"],
Cell[287771, 8721, 740, 23, 78, "Output", "ExpressionUUID" -> \
"93c51aab-b014-4eab-acdb-94538892ff06"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[288560, 8750, 598, 13, 59, "Subsection", "ExpressionUUID" -> \
"38cde4d3-4276-45c8-90e8-ffcd9f8d2488"],
Cell[289161, 8765, 2762, 79, 234, "Input", "ExpressionUUID" -> \
"4ae73b52-ec70-4b4d-b098-1671662a3bc9"],
Cell[291926, 8846, 2826, 84, 234, "Input", "ExpressionUUID" -> \
"105566bb-301b-4088-8891-dff7a1951bb0"],
Cell[294755, 8932, 2823, 86, 235, "Input", "ExpressionUUID" -> \
"bc3da9eb-6e82-41b4-a2b2-f8d38a590c5d"],
Cell[297581, 9020, 2868, 87, 236, "Input", "ExpressionUUID" -> \
"78cb6ff4-de9e-4feb-8e7e-a6a9d2d0c2e0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[300486, 9112, 163, 3, 59, "Subsection", "ExpressionUUID" -> \
"6557a614-e567-43c4-bde3-6e83d7eee14c"],
Cell[CellGroupData[{
Cell[300674, 9119, 2364, 60, 135, "Input", "ExpressionUUID" -> \
"197d7d14-3387-494f-96c3-f1288cdef83e"],
Cell[303041, 9181, 2305, 64, 117, "Output", "ExpressionUUID" -> \
"1d2948aa-ce70-4862-94d2-795571541ffc"],
Cell[305349, 9247, 1877, 50, 78, "Output", "ExpressionUUID" -> \
"4ff300b9-eb1b-4a3b-aca8-565093139d2b"],
Cell[307229, 9299, 627, 10, 38, "Output", "ExpressionUUID" -> \
"b820dc20-69a4-45db-9750-debbebae71e4"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[307905, 9315, 658, 16, 59, "Subsection", "ExpressionUUID" -> \
"b0d7152a-45e2-4106-9d90-efdedcdf1d8d"],
Cell[308566, 9333, 2660, 78, 234, "Input", "ExpressionUUID" -> \
"35a2721d-b707-4a65-8687-b75da19a43a7"],
Cell[311229, 9413, 2757, 83, 234, "Input", "ExpressionUUID" -> \
"05db5e84-253a-4ee1-b3d2-24fb4241f195"],
Cell[313989, 9498, 2745, 85, 235, "Input", "ExpressionUUID" -> \
"64038d67-5fa4-43bf-add6-38ea6b0915c1"],
Cell[316737, 9585, 2794, 86, 236, "Input", "ExpressionUUID" -> \
"6e14a879-efaa-4ba8-9f52-da65dd49e18f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319568, 9676, 163, 3, 53, "Subsection", "ExpressionUUID" -> \
"3b02575c-ed8a-47d0-9a17-0e818cdf0f63"],
Cell[CellGroupData[{
Cell[319756, 9683, 1924, 49, 111, "Input", "ExpressionUUID" -> \
"71e0a5b1-cf9b-4dfc-9ccd-cf43e98bca5f"],
Cell[321683, 9734, 456, 8, 38, "Output", "ExpressionUUID" -> \
"31b68582-2af4-4683-a40c-87c1fd0482fa"],
Cell[322142, 9744, 456, 8, 38, "Output", "ExpressionUUID" -> \
"01a4c05d-b970-426d-8f56-fc6895ab5eba"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322635, 9757, 346, 10, 67, "Input", "ExpressionUUID" -> \
"b3a27caa-d440-4166-8ec3-e5472a8f09cb"],
Cell[322984, 9769, 717, 23, 78, "Output", "ExpressionUUID" -> \
"9a8debf6-c49d-441e-90dc-7c7be6788384"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[323750, 9798, 414, 8, 53, "Subsection", "ExpressionUUID" -> \
"fc9afbfe-3a44-4bcb-820d-e9ac7f67d9be"],
Cell[324167, 9808, 2713, 79, 234, "Input", "ExpressionUUID" -> \
"cc9c5425-0663-455c-b7d9-5c97610f4968"],
Cell[326883, 9889, 2805, 83, 234, "Input", "ExpressionUUID" -> \
"2dbeb19f-21ca-4f5f-8e54-d73de35c4d9b"],
Cell[329691, 9974, 2797, 86, 235, "Input", "ExpressionUUID" -> \
"4786f861-b8da-473a-a3bc-be463cafc04a"],
Cell[332491, 10062, 2848, 87, 236, "Input", "ExpressionUUID" -> \
"3c30bb7f-37ba-406c-91ae-554160285964"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335376, 10154, 163, 3, 53, "Subsection", "ExpressionUUID" -> \
"5f7033a5-d0d6-4b1a-988d-06919f4f89e9"],
Cell[CellGroupData[{
Cell[335564, 10161, 1924, 49, 111, "Input", "ExpressionUUID" -> \
"6e37866c-644d-4285-8f00-3b81f5a0bd50"],
Cell[337491, 10212, 480, 8, 38, "Output", "ExpressionUUID" -> \
"3bdf2416-c64b-4296-aace-ca0a2b819b6d"],
Cell[337974, 10222, 480, 8, 38, "Output", "ExpressionUUID" -> \
"a6163722-5f46-448a-869e-bb4a7188a4d3"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[338503, 10236, 478, 9, 53, "Subsection", "ExpressionUUID" -> \
"ceb57294-8aab-41f1-88fb-ba45cc01bb60"],
Cell[338984, 10247, 2761, 79, 234, "Input", "ExpressionUUID" -> \
"8ba65266-f50d-491e-9f6a-e385f3c238dc"],
Cell[341748, 10328, 2854, 84, 234, "Input", "ExpressionUUID" -> \
"02458eb6-dc0f-455b-9b0e-61ef5480e156"],
Cell[344605, 10414, 2847, 86, 235, "Input", "ExpressionUUID" -> \
"ca6df228-e769-4888-bc51-addfcf848629"],
Cell[347455, 10502, 2902, 88, 236, "Input", "ExpressionUUID" -> \
"9dd0abc3-4c62-4a8f-9d2f-3e4edc6f1ab9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[350394, 10595, 163, 3, 53, "Subsection", "ExpressionUUID" -> \
"33e185e7-fb30-4eb6-a713-5ddfbc10b340"],
Cell[CellGroupData[{
Cell[350582, 10602, 1924, 49, 111, "Input", "ExpressionUUID" -> \
"621ce744-9075-4412-be9d-2477603f1a9c"],
Cell[352509, 10653, 478, 8, 38, "Output", "ExpressionUUID" -> \
"851db36b-f746-4c51-8cb6-8c4fff1f0546"],
Cell[352990, 10663, 480, 8, 38, "Output", "ExpressionUUID" -> \
"16164efa-dd54-412a-8474-81da3947e63c"]
}, Open  ]]
}, Open  ]]
}
]
*)

